{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var ctxPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",ctxPath);\n\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/hr/emp/empOut/empOut\");","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"80","frame":"true","style":"border-width:0px","layout":"fit","border":"false","itemId":"queryForm"},"children":[{"configs":{"title":"{#xip_hr_emp_empOut_queryConditions#}","style":"padding-top:8px","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"userName","fieldLabel":"{#xip_hr_emp_empOut_loginAccount#}"},"events":{"specialkey":"app.userNameUpper.setValue(app.userName.getValue().toUpperCase());\napp.Grid.store.load( {  params:{userNameUpper:app.userName.getValue().toUpperCase()}} );"},"children":[],"expanded":true,"type":"text"},{"configs":{"labelWidth":"100","hidden":"true","width":"250","labelAlign":"right","itemId":"userNameUpper","fieldLabel":"{#xip_hr_emp_empOut_userName#}"},"children":[],"expanded":true,"type":"text"},{"configs":{"text":"{#xip_hr_emp_empOut_query#}","itemId":"quertBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.userNameUpper.setValue(app.userName.getValue().toUpperCase());\napp.Grid.store.load( {  params:{userNameUpper:app.userName.getValue().toUpperCase()}} );"},"children":[],"expanded":true,"type":"button"},{"configs":{"text":"{#xip_hr_emp_empOut_reset#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"app.queryForm.getForm().reset();\napp.Grid.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"false","selType":"rowmodel","border":"true","itemId":"Grid"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_hr_emp_empOut_pass#}","itemId":"spBtn","iconCls":"last_icon"},"events":{"click":"var rows = app.Grid.getSelectionModel().getSelection();\nif(rows.length===0){\n  Ext.Msg.alert('{#xip_hr_emp_empOut_prompt#}','{#xip_hr_emp_empOut_qxzczdjl#}');//'提示','请选择操作的记录!'\n  return;\n}\n\nvar userId = rows[0].data.USER_ID;\nvar userName = rows[0].data.USER_NAME;\nvar email = rows[0].data.EMAIL;\nvar status = rows[0].data.STATUS;\nif(status=='B'){\n   Ext.Msg.alert('{#xip_hr_emp_empOut_prompt#}','{#xip_hr_emp_empOut_yhysp#}');//'提示','用户已审批!'\n   return;\n}\n\nvar json = { USER_ID :userId};\n//Ext.Msg.alert(u);\n\n//==============执行发送邮件请求操作=================\n\nvar msg = Ext.MessageBox.show({\n                title :\t'{#xip_hr_emp_empOut_qdd#}',//请等待\n                msg   :  '{#xip_hr_emp_empOut_zztjqq#}',//正在提交请求.......\n                width :  240,\n                wait  : true,\n                progress : true,\n                closable : false\n              });\nExt.Ajax.request({ \n\t\t\turl:'{#contextPath#}'+'/platformAction.do?method=sendUserMail',\n           params: {userName:userName,\n           userId:userId,\n           email:email   },\n   timeout: 3600*360*24,\n\t\t\tmethod: 'POST',\n           \n\t\t\t\n\t\t\tsuccess: function(response, options) { // 回调函数有2个参数\n               msg.hide();\n               var res=Ext.JSON.decode(response.responseText);\n              if(res.flag==1){\n              Ext.Msg.alert('{#xip_hr_emp_empOut_prompt#}', '{#xip_hr_emp_empOut_spsbqxpzyjfwq#}' );//'提示', '审批失败,请先配置邮件服务器！' \n\n              \n              }else{\n              Ext.Msg.alert('{#xip_hr_emp_empOut_prompt#}', '{#xip_hr_emp_empOut_spcg#}' );//'提示', '审批成功'\n              Wb.request({url: 'm?xwl=xip/hr/emp/empOut/data/updateStatus', params: json, success: function(response){\n                 app.userNameUpper.setValue(app.userName.getValue().toUpperCase());\n                 app.Grid.store.load( {  params:{userNameUpper:app.userName.getValue().toUpperCase()}} );\n                }});\n              }   \n              \n              \n\t\t\t},\n\t\t\tfailure: function(response, options) {\n\t\t\tExt.Msg.alert('{#xip_hr_emp_empOut_prompt#}', '{#xip_hr_emp_empOut_zcsb#}' );//'提示', '注册失败' \n\t\t\t}\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_hr_emp_empOut_serialNumber#}","xtype":"rownumberer","align":"center","itemId":"Row_num"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"用户id","hidden":"true","xtype":"rownumberer","dataIndex":"USER_ID","itemId":"COLUMN_USER_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_hr_emp_empOut_loginAccount#}","width":"120","dataIndex":"USER_NAME","itemId":"COLUMN_USER_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"员工id","hidden":"true","width":"200","dataIndex":"EMP_ID","itemId":"COLUMN_EMP_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_hr_emp_empOut_applyTime#}","width":"220","dataIndex":"START_DATE","itemId":"COLUMN_START_DATE"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#xip_hr_emp_empOut_endTime#}","hidden":"true","width":"200","dataIndex":"END_DATE","itemId":"COLUMN_END_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_hr_emp_empOut_name#}","dataIndex":"EMP_NAME","itemId":"COLUMN_EMP_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_hr_emp_empOut_email#}","width":"300","dataIndex":"EMAIL","itemId":"COLUMN_EMAIL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_hr_emp_empOut_status#}","dataIndex":"STATUS","itemId":"COLUMN_STATUS","renderer":"if(value === \"A\"){\n  return \"{#xip_hr_emp_empOut_statusA#}\";\n}else if(value === \"B\"){\n  return \"{#xip_hr_emp_empOut_statusB#}\";\n}else{\n  return value;\n}"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/hr/emp/empOut/data/SelectGrid"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}