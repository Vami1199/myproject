{"inframe":false,"title":"值集管理","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var paramsValue = request.getSession().getAttribute(\"XzSessionVars\");\nvar ctxPath = request.getContextPath();\nvar sysMode = paramsValue.get(\"godMode\");\nrequest.setAttribute(\"contextPath\",ctxPath);\nrequest.setAttribute(\"SYS_MODE\",sysMode);\n//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/base/dict/dict\");\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","loginRequired":"false","itemId":"module"},"events":{"finalize":"//判断Array的值重复问题\nfunction judgeDuplicate(array){\n  var tmp = array;\n  tmp = Ext.Array.unique(tmp);\n  if(tmp.length !== array.length){\n    return true;\n  }else{\n    return false;\n  }\n}","initialize":"function getuuid() {\n var s = [];\n var hexDigits = \"0123456789abcdef\";\n for (var i = 0; i < 36; i++) {\n s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n }\n s[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n s[8] = s[13] = s[18] = s[23] = \"-\";\n\nvar uuid = s.join(\"\");\n return uuid;\n}\n"},"children":[{"configs":{"itemId":"Winbtns"},"children":[{"configs":{"text":"{#save#}","itemId":"saveWin","iconCls":"save_icon"},"events":{"click":"if(app.dictform.getForm().isValid()===false){\n  Ext.Msg.alert('{#alert#}','{#notNull#}');\n  return;\n}\nvar _isVcode = true;\nvar _isVname = true;\napp.gridedit.store.each(function(item){\n  if(Ext.isEmpty(item.data.VAL_CODE)){\n    _isVcode = false;\n    return false;\n  }\n   if(Ext.isEmpty(item.data.VAL_NAME)){\n    _isVname = false;\n    return false;\n  }\n  });\nif(_isVcode === false){\n  Wb.warn('{#codeIsNotNull#}');\n  return false; \n}\nif(_isVname === false){\n  Wb.warn('{#nameIsNotNull#}');\n  return false; \n}\nvar records = [];\nvar nameRecords = [];\nfor(var k=0;k<app.gridedit.store.getCount();k++){\n  records.push(app.gridedit.store.getAt(k).data.VAL_CODE);\n  nameRecords.push(app.gridedit.store.getAt(k).data.VAL_NAME);\n}\nif(judgeDuplicate(records)){\n  Ext.Msg.alert('{#alert#}','{#codeIsNotCopy#}');\n  return ;\n}\nif(judgeDuplicate(nameRecords)){\n  Ext.Msg.alert('{#alert#}','{#nameIsNotCopy#}');\n  return ;\n}\n\nvar VAL_SET_ID = app.VAL_SET_ID.getValue();\nvar json = {\n  VAL_SET_ID:'',\n  VAL_SET_CODE:app.VAL_SET_CODE.getValue(),\n  VAL_SET_NAME:app.VAL_SET_NAME.getValue(),\n  VAL_SET_DESC:app.VAL_SET_DESC.getValue(),\n  VAL_SET_TYPE:app.VAL_SET_TYPE.getValue(),\n  ENABLE_FLAG:app.ENABLE_FLAG.getValue()\n};\n\n//新增操作\nif(app.operateFlag.getValue()==='ADD'){\n  json.VAL_SET_ID = getuuid();\n\n app.VAL_SET_ID.setValue(json.VAL_SET_ID);\n  \nWb.request({\n    url: 'm?xwl=xip/base/dict/data/insertgrid',\n    params: json,\n    success: function(response) {\n      //保存子表 判断更新还是插入\n      var recs = app.gridedit.store.getCount();\n      for(var i=0;i<recs;i++){\n                var rec =  app.gridedit.store.getAt(i);\n                if(rec.data.VAL_SET_DTL_ID ===''||rec.data.VAL_SET_DTL_ID === null){\n                 //插入子表\n                 var json_l={\n                           VAL_SET_DTL_ID  : getuuid(),\n                           VAL_SET_CODE    :rec.data.VAL_SET_CODE,\n                           VAL_CODE        : rec.data.VAL_CODE,\n                           VAL_NAME        : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/create', \n           params: Wb.apply({\n                array: [json_l]\n           }),\n           success: function() {\n             app.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});\n           }\n        });\n        }else{\n          //更新子表\n         var json_l_up={\n                           VAL_SET_DTL_ID : rec.data.VAL_SET_DTL_ID,\n                           VAL_SET_CODE:rec.data.VAL_SET_CODE,\n                           VAL_CODE    : rec.data.VAL_CODE,\n                           VAL_NAME   : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/update', \n           params: Wb.apply({\n                array: [json_l_up]\n           }),\n           success: function() {\n              app.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});\n           }\n        });\n        }\n        }\n      \n      \n    //设置编辑状态\n    app.operateFlag.setValue(\"EDIT\");\n    app.win.setTitle('{#editTitle#}');\n    app.dictgrid.store.reload();\n    Ext.Msg.alert('{#alert#}','{#success#}'); \n     \n     }\n});\n}//更新操作\nelse{\n  json.VAL_SET_ID = VAL_SET_ID;\n  Wb.request({\n    url: 'm?xwl=xip/base/dict/data/updategrid',\n    params: json,\n    success: function(response) {\n        //保存子表 判断更新还是插入\n      var recs = app.gridedit.store.getCount();\n      for(var i=0;i<recs;i++){\n                var rec =  app.gridedit.store.getAt(i);\n                if(rec.data.VAL_SET_DTL_ID ===''||rec.data.VAL_SET_DTL_ID === null){\n                 //插入子表\n                 var json_l={\n                           VAL_SET_DTL_ID  : getuuid(),\n                           VAL_SET_CODE    :rec.data.VAL_SET_CODE,\n                           VAL_CODE        : rec.data.VAL_CODE,\n                           VAL_NAME        : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/create', \n           params: Wb.apply({\n                array: [json_l]\n           }),\n           success: function() {\n            app.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});  \n           }\n        });\n        }else{\n          //更新子表\n         var json_l_up={\n                           VAL_SET_DTL_ID : rec.data.VAL_SET_DTL_ID,\n                           VAL_SET_CODE:rec.data.VAL_SET_CODE,\n                           VAL_CODE    : rec.data.VAL_CODE,\n                           VAL_NAME   : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/update', \n           params: Wb.apply({\n                array: [json_l_up]\n           }),\n           success: function() {\n             app.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});\n           }\n        });\n        }\n        }\n    //设置编辑状态\n    app.operateFlag.setValue(\"EDIT\");\n    app.win.setTitle('{#editTitle#}');\n    app.dictgrid.store.reload();\n    Ext.Msg.alert('{#alert#}','{#success#}'); \n     \n     }\n});\n  \n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#saveNext#}","itemId":"savenextWin"},"events":{"click":"if(app.dictform.getForm().isValid()===false){\n  Ext.Msg.alert('{#alert#}','{#notNull#}');\n  return;\n}\nvar _isVcode = true;\nvar _isVname = true;\napp.gridedit.store.each(function(item){\n  if(Ext.isEmpty(item.data.VAL_CODE)){\n    _isVcode = false;\n    return false;\n  }\n   if(Ext.isEmpty(item.data.VAL_NAME)){\n    _isVname = false;\n    return false;\n  }\n  });\nif(_isVcode === false){\n  Wb.warn('{#codeIsNotNull#}');\n  return false; \n}\nif(_isVname === false){\n  Wb.warn('{#nameIsNotNull#}');\n  return false; \n}\nvar records = [];\nvar nameRecords = [];\nfor(var k=0;k<app.gridedit.store.getCount();k++){\n  records.push(app.gridedit.store.getAt(k).data.VAL_CODE);\n  nameRecords.push(app.gridedit.store.getAt(k).data.VAL_NAME);\n}\nif(judgeDuplicate(records)){\n  Ext.Msg.alert('{#alert#}','{#codeIsNotCopy#}');\n  return ;\n}\nif(judgeDuplicate(nameRecords)){\n  Ext.Msg.alert('{#alert#}','{#nameIsNotCopy#}');\n  return ;\n}\n\n\nvar VAL_SET_ID = app.VAL_SET_ID.getValue();\n  var json = {\n  VAL_SET_ID:'',\n  VAL_SET_CODE:app.VAL_SET_CODE.getValue(),\n  VAL_SET_NAME:app.VAL_SET_NAME.getValue(),\n  VAL_SET_DESC:app.VAL_SET_DESC.getValue(),\n  VAL_SET_TYPE:app.VAL_SET_TYPE.getValue(),\n  ENABLE_FLAG:app.ENABLE_FLAG.getValue()\n};\n//保存并继续添加的新增操作\nif(app.operateFlag.getValue()==='ADD'){\n\n  \n  json.VAL_SET_ID = getuuid();\n  \n  app.VAL_SET_ID.setValue(json.VAL_SET_ID);\n  //保存并继续添加的Ajax\n  Wb.request({\n    url: 'm?xwl=xip/base/dict/data/insertgrid',\n    params: json,\n    success: function(response) {\n      //保存子表 判断更新还是插入\n      var recs = app.gridedit.store.getCount();\n      for(var i=0;i<recs;i++){\n                var rec =  app.gridedit.store.getAt(i);\n                if(rec.data.VAL_SET_DTL_ID ===''||rec.data.VAL_SET_DTL_ID === null){\n                 //插入子表\n                 var json_l={\n                           VAL_SET_DTL_ID  : getuuid(),\n                           VAL_SET_CODE    :rec.data.VAL_SET_CODE,\n                           VAL_CODE        : rec.data.VAL_CODE,\n                           VAL_NAME        : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/create', \n           params: Wb.apply({\n                array: [json_l]\n           }),\n           success: function() {\n             app.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});\n           }\n        });\n        }else{\n          //更新子表\n         var json_l_up={\n                           VAL_SET_DTL_ID : rec.data.VAL_SET_DTL_ID,\n                           VAL_SET_CODE:rec.data.VAL_SET_CODE,\n                           VAL_CODE    : rec.data.VAL_CODE,\n                           VAL_NAME   : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/update', \n           params: Wb.apply({\n                array: [json_l_up]\n           }),\n           success: function() {\n             \n             \n             \n             \n           }\n        });\n        }\n        }\n      \n      \n    //设置编辑状态\n     \n     app.dictform.getForm().reset();\napp.win.setTitle('{#addTitle#}');\napp.operateFlag.setValue(\"ADD\");\n app.VAL_SET_TYPE.setValue('U');\napp.VAL_SET_CODE.setReadOnly(false);\napp.dictgrid.store.reload();\napp.gridedit.store.load({params:{VAL_SET_CODE : '-1'}});      \n Ext.Msg.alert('','{#success#}');\n     }\n});\n}else{\n  \n  json.VAL_SET_ID = VAL_SET_ID;\n   Wb.request({\n    url: 'm?xwl=xip/base/dict/data/updategrid',\n    params: json,\n    success: function(response) {\n      //保存子表 判断更新还是插入\n      var recs = app.gridedit.store.getCount();\n      for(var i=0;i<recs;i++){\n                var rec =  app.gridedit.store.getAt(i);\n                if(rec.data.VAL_SET_DTL_ID ===''||rec.data.VAL_SET_DTL_ID === null){\n                 //插入子表\n                 var json_l={\n                           VAL_SET_DTL_ID  : getuuid(),\n                           VAL_SET_CODE    :rec.data.VAL_SET_CODE,\n                           VAL_CODE        : rec.data.VAL_CODE,\n                           VAL_NAME        : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/create', \n           params: Wb.apply({\n                array: [json_l]\n           }),\n           success: function() {\n             app.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});\n           }\n        });\n        }else{\n          //更新子表\n         var json_l_up={\n                           VAL_SET_DTL_ID : rec.data.VAL_SET_DTL_ID,\n                           VAL_SET_CODE:rec.data.VAL_SET_CODE,\n                           VAL_CODE    : rec.data.VAL_CODE,\n                           VAL_NAME   : rec.data.VAL_NAME,\n                           DESCRIPTION     : rec.data.DESCRIPTION,\n                           ENABLE_FLAG     : rec.data.ENABLE_FLAG\n                          };\n         Wb.request({\n           url: 'm?xwl=xip/base/dict/data/update', \n           params: Wb.apply({\n                array: [json_l_up]\n           }),\n           success: function() {\n             \n            \n             \n             \n           }\n        });\n        }\n        }\n      \n      \n    //设置编辑状态\n    \n     app.dictform.getForm().reset();\napp.win.setTitle('{#addTitle#}');\napp.operateFlag.setValue(\"ADD\");\napp.VAL_SET_TYPE.setValue('U');\napp.VAL_SET_CODE.setReadOnly(false);\napp.dictgrid.store.reload();\napp.gridedit.store.load({params:{VAL_SET_CODE : '-1'}});\n Ext.Msg.alert('','{#success#}');\n     }\n});\n}\n// app.VAL_SET_TYPE.setValue('U');\n// app.ENABLE_FLAG.setValue('Y');\n// \n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#close#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.win.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"height":"500","width":"700","layout":"border","closeAction":"hide","buttons":"app.Winbtns","buttonAlign":"center","dialog":"false","itemId":"win","modal":"true"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","border":"false","itemId":"dictform"},"children":[{"configs":{"itemId":"operateFlag"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"hidden":"true","itemId":"VAL_SET_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","columnWidth":".5","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"80","allowBlank":"false","width":"300","labelAlign":"right","itemId":"VAL_SET_CODE","fieldLabel":"<font color='red'>*<\/font>{#dictCode#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","allowBlank":"false","width":"300","labelAlign":"right","itemId":"VAL_SET_NAME","fieldLabel":"<font color='red'>*<\/font>{#dictName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px ;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","columnWidth":".5","border":"false","itemId":"panel2"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","width":"300","labelAlign":"right","pickList":"[['S','{#system#}'],['U','{#user#}']]","itemId":"VAL_SET_TYPE","fieldLabel":"{#dictType#}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"80","width":"300","value":"Y","labelAlign":"right","pickList":"[['Y','{#yes#}'],['N','{#no#}']]","itemId":"ENABLE_FLAG","fieldLabel":"{#enable#}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px;padding-bottom:6px","layout":"column","columnWidth":".5","border":"false","itemId":"panel3"},"children":[{"configs":{"labelWidth":"80","width":"600","labelAlign":"right","itemId":"VAL_SET_DESC","fieldLabel":"{#dictDesc#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"form"},{"configs":{"region":"center","pagingBar":"false","multiSelect":"true","selType":"checkboxmodel","itemId":"gridedit","simpleSelect":"true","editable":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/base/dict/data/read"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#addRow#}","itemId":"addrow","iconCls":"application_add_icon"},"events":{"click":"var _code=app.VAL_SET_CODE.getValue();\n\nif(_code=== null || _code===''){\n  Ext.Msg.alert('{#alert#}','{#dictIsNotNull#}') ;\n  return false ;\n}else{\n   var e=app.gridedit.plugins[0],index=app.gridedit.store.getCount()===0?0:app.gridedit.store.getCount();\n   e.completeEdit();\n  \n // Wb.addEdit(app.gridedit);\n // var newKey = getuuid();\n  var valSetCode = app.VAL_SET_CODE.getValue();\n  app.gridedit.store.insert(index,{});\n// app.gridedit.store.getAt(index).set('VAL_SET_DTL_ID',newKey);\n app.gridedit.store.getAt(index).set('VAL_SET_CODE',valSetCode);\n app.gridedit.store.getAt(index).set('ENABLE_FLAG','Y');\n   e.startEditByPosition({row:index,column:2});\n}\n\n\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#deleteRow#}","itemId":"deleterow","iconCls":"application_delete_icon"},"events":{"click":"var recs = app.gridedit.getSelection();\nif (!recs.length) {\n  Wb.warn('{#selRecord#}');\n  return;\n}\nvar type=app.VAL_SET_TYPE.getValue();\nvar vid =recs[0].data.VAL_SET_DTL_ID;\n\nif(type=='S'){\n  if('{#SYS_MODE#}'== 'Y' ){\n    Wb.del(app.gridedit, {\n      url: 'm?xwl=xip/base/dict/data/destroy',\n      titleField: 'VAL_NAME',\n      success: function(){\n        Ext.Msg.alert('{#alert#}','{#delSuc#}');\n      }\n    });\n  }else{\n    for(var i=0;i<recs.length;i++){\n      if(!Ext.isEmpty(recs[i].data.VAL_SET_DTL_ID)){\n        Ext.Msg.alert('{#alert#}','{#sysDel#}');\n        return;\n      }\n    }\n     Wb.remove(app.gridedit,recs);\n   \n  }\n}else{\n  Wb.del(app.gridedit, {\n    url: 'm?xwl=xip/base/dict/data/destroy',\n    titleField: 'VAL_NAME',\n    success: function(){\n      Ext.Msg.alert('{#alert#}','{#delSuc#}');\n    }\n  });\n\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"id","hidden":"true","dataIndex":"VAL_SET_DTL_ID","itemId":"COLUMN_VAL_SET_DTL_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#dictCode#}","hidden":"true","dataIndex":"VAL_SET_CODE","itemId":"COLUMN_VAL_SET_CODE"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#valueCode#}","width":"100","dataIndex":"VAL_CODE","itemId":"COLUMN_VAL_CODE"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#valueName#}","width":"180","dataIndex":"VAL_NAME","itemId":"COLUMN_VAL_NAME"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#valueDesc#}","width":"180","dataIndex":"DESCRIPTION","itemId":"COLUMN_DESCRIPTION"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#enable#}","align":"center","dataIndex":"ENABLE_FLAG","itemId":"COLUMN_ENABLE_FLAG1","renderer":"if(value=='Y'){\n\treturn '{#yes#}';\n}else{\n\t\n   return '<font color=\"red\">{#no#}<\/font>';\n}","flex":"1"},"children":[{"configs":{"pickList":"[['Y','{#yes#}'],['N','{#no#}']]","itemId":"editor"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"80","frame":"true","style":"border-width:0px","layout":"fit","itemId":"queryform","border":"false"},"children":[{"configs":{"title":"{#conditionQuery#}","style":"padding-top:8px","collapsible":"true","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"120","width":"250","labelAlign":"right","itemId":"zjbm","fieldLabel":"{#dictCodeName#}"},"events":{"specialkey":"app.dictgrid.store.load( {  params:{valCodeName:app.zjbm.getValue() }} );"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#query#}","itemId":"queryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.dictgrid.store.load( {  params:{valCodeName:app.zjbm.getValue() }} );"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#reset#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"app.queryform.getForm().reset();\napp.dictgrid.store.load();"},"children":[],"expanded":true,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"dictgrid"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xip/base/dict/data/selelctsets"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#add#}","itemId":"addBtn","iconCls":"application_add_icon"},"events":{"click":"var win = new Ext.window.Window(app._win);\napp.gridedit.store.load();\nwin.show();\n\napp.win.setTitle('{#addTitle#}');\napp.VAL_SET_TYPE.setValue('U');\n\napp.VAL_SET_CODE.setReadOnly(false);\n//VAL_SET_CODE.setFieldStyle(\"background-color:white;background-image:none\");\napp.ENABLE_FLAG.setReadOnly(false);\n//设置窗口的编辑属性\napp.operateFlag.setValue('ADD');\nif('{#SYS_MODE#}' === 'godMode'){\n  app.VAL_SET_TYPE.setReadOnly(false);\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#edit#}","itemId":"editBtn","iconCls":"table_edit_icon"},"events":{"click":"//var win = new Ext.window.Window(app._win);\nWb.edit(app.dictgrid,app.win);\napp.win.setTitle('{#editTitle#}');\n\napp.gridedit.store.load({params:{VAL_SET_CODE : app.VAL_SET_CODE.getValue()}});\napp.VAL_SET_CODE.setReadOnly(true);\nvar type =app.VAL_SET_TYPE.getValue();\nif(type == 'S'){\napp.ENABLE_FLAG.setReadOnly(true);\n} else {\napp.ENABLE_FLAG.setReadOnly(false);\n}\napp.operateFlag.setValue(\"EDIT\");\nif('{#SYS_MODE#}' === 'Y'){\n  app.VAL_SET_TYPE.setReadOnly(false);\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#delete#}","itemId":"deleteBtn","iconCls":"application_delete_icon"},"events":{"click":"var recs = app.dictgrid.getSelection();\nif (!recs.length) {\n  Wb.warn('{#selRecord#}');\n  return false ;\n}\nrecord= recs[0];\nvar type = record.get('VAL_SET_TYPE');\nif(type == 'S'){\n   Ext.Msg.alert('{#alert#}','{#sysDel#}');\n  return false ;\n}\nExt.Msg.confirm('{#alert#}','{#confirm#}',function(a){\n      if(a=='yes'){\n      var idList = \"\";\n       var codeList = \"\";\n       \n      Ext.each(recs,function(r){\n        var id = \"'\" + r.data.VAL_SET_ID + \"'\";\n        if(idList === \"\"){\n          idList = id ;\n        }else{\n          idList = idList+\",\"+id ;\n        }\n         \n      });\n        Ext.each(recs,function(r){\n        var code = \"'\" + r.data.VAL_SET_CODE + \"'\";\n        if(codeList === \"\"){\n          codeList = code ;\n        }else{\n          codeList = codeList+\",\"+code;\n        }\n         });\n      var json = {'ids' : idList ,\n                  'codes':codeList\n                 } ;\n        Wb.request({\n         url : 'm?xwl=xip/base/dict/data/deleteall',\n         params : json,\n         success :function(response){\n          Ext.Msg.alert('{#alert#}','{#delSuc#}');\n           app.dictgrid.store.load();\n           \n         }\n      });\n     \n    }else{\n      return false ;\n    }\n  });\n\n\n//  Wb.del(app.dictgrid, {\n//   url: 'm?xwl=xip/base/dict/data/deletesongrid',\n//   titleField: 'VAL_SET_NAME',\n//   success: function() {\n//     Wb.request({\n//     url: 'm?xwl=xip/base/dict/data/deletegrid', \n//     params: Wb.apply({\n//       destroy: Wb.getData(recs)\n//     }),\n//        success: function() {\n//      Ext.Msg.alert('{#alert#}','{#delSuc#}');\n//     }\n//   });\n//  }\n// });"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"id","hidden":"true","dataIndex":"VAL_SET_ID","itemId":"COLUMN_VAL_SET_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#dictCode#}","width":"150","dataIndex":"VAL_SET_CODE","itemId":"COLUMN_VAL_SET_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#dictName#}","width":"220","dataIndex":"VAL_SET_NAME","itemId":"COLUMN_VAL_SET_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#dictDesc#}","width":"220","dataIndex":"VAL_SET_DESC","itemId":"COLUMN_VAL_SET_DESC"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#dictType#}","width":"150","dataIndex":"VAL_SET_TYPE","itemId":"COLUMN_VAL_SET_TYPE","renderer":"if(value === \"S\"){\n  return '{#system#}';\n}else if(value === \"U\"){\n  return '{#user#}';\n}else{\n  return value;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#enable#}","align":"center","width":"80","dataIndex":"ENABLE_FLAG","itemId":"COLUMN_ENABLE_FLAG","renderer":"if(value=='Y'){\n\treturn '{#yes#}';\n}else{\n\t\n   return '<font color=\"red\">{#no#}<\/font>';\n}"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}