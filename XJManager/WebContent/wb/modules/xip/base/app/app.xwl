{"inframe":false,"title":"应用管理","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","loadJS":"ext","initScript":"com.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);\nvar userId = request.getSession().getAttribute(\"XzSessionVars\").get('userId');\nvar userName = request.getSession().getAttribute(\"XzSessionVars\").get('userName');\nvar empName = request.getSession().getAttribute(\"XzSessionVars\").get('empName');\n\nvar authModel = request.getSession().getAttribute(\"XzSessionVars\").get('AUTH_MODAL');\nvar roleId = request.getSession().getAttribute(\"XzSessionVars\").get('roleId');\nvar roleName = request.getSession().getAttribute(\"XzSessionVars\").get('roleName');\nvar roleCode = request.getSession().getAttribute(\"XzSessionVars\").get('roleCode');\n\nvar ctxPath = request.getContextPath();\n\nrequest.setAttribute(\"userId\", userId);\nrequest.setAttribute(\"userName\", userName);\nrequest.setAttribute(\"empName\", empName);\n\nrequest.setAttribute(\"authModel\", authModel);\nrequest.setAttribute(\"roleId\", roleId);\nrequest.setAttribute(\"roleName\", roleName);\nrequest.setAttribute(\"roleCode\", roleCode);\n\nrequest.setAttribute(\"contextPath\", ctxPath);\n\nvar godMoadl = request.getSession().getAttribute(\"XzSessionVars\").get('godMode');\nrequest.setAttribute(\"godMoadl\", godMoadl);","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/base/app/json/app\");","itemId":"module"},"events":{"initialize":"function getuuid() {\n  var s = [];\n  var hexDigits = \"0123456789abcdef\";\n  for (var i = 0; i < 36; i++) {\n    s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n  }\n  s[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n  s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n  s[8] = s[13] = s[18] = s[23] = \"-\";\n\n  var uuid = s.join(\"\");\n  return uuid;\n}\n//启用编辑窗口的可操作按钮\nfunction enableEditApp() {\n  app.saveBtn_appWin.enable();\n\n  app.addSecBtn.enable();\n  app.delSecBtn.enable();\n}\n//禁用编辑窗口的可操作按钮\nfunction disableEditApp() {\n  app.saveBtn_appWin.disable();\n\n  app.addSecBtn.disable();\n  app.delSecBtn.disable();\n}\nfunction operatorDbInfos(flag) {\n  app.DB_TYPE.setReadOnly(flag);\n  app.DB_USER.setReadOnly(flag);\n  app.DB_URL.setReadOnly(flag);\n  app.DB_PASSWORD.setReadOnly(flag);\n}"},"children":[{"configs":{"itemId":"dbTypeStore","autoLoad":"true","url":"m?xwl=xip/base/app/data/getDbType"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"appQueryByIdStore","url":"m?xwl=xip/base/app/data/queryById"},"events":{"load":"if(app.appQueryByIdStore.getAt(0)) {\n  var record = app.appQueryByIdStore.getAt(0);\n  app.appform.loadRecord(record);\n  var dbName = record.get('DB_NAME')===null?'':record.get('DB_NAME');\n  var enableFlag = record.get('ENABLE_FLAG')===null?'':record.get('ENABLE_FLAG');\n  var inXip = record.get('IN_XIP')===null?'':record.get('IN_XIP');  \n  if(enableFlag=='Y'){\n    enableFlag='{#app_yes#}';\n  }else if(enableFlag=='N'){\n    enableFlag='{#app_no#}';  \n  }\n  if(inXip=='Y'){\n    inXip='{#app_yes#}';\n    app.WEB_HOST.setReadOnly(true);\n    operatorDbInfos(true);\n  }else if(inXip=='N'){\n    inXip='{#app_no#}';\n    app.WEB_HOST.setReadOnly(false);\n    operatorDbInfos(false);\n  }\n  if(!Ext.isEmpty(dbName)){\n    app.dbTypeStore.load(function(){\n      app.DB_TYPE.setValue(record.get('DB_TYPE'));\n      app.DB_TYPE.setRawValue(dbName);\n      app.DB_TYPE.collapse();\n    });\n  }\n  app.ENABLE_FLAG.setRawValue(enableFlag);\n  app.IN_XIP.setRawValue(inXip);\n  app.appSecGrid.store.load({params:{APP_ID:record.get('APP_ID')}});\n  //根据上帝模式以及是否是系统内置应用来控制应用编辑窗口的按钮可用情况\n  if('{#godMoadl#}' != 'Y'){\n    if(record.get('IS_SYS')=='S'){\n      disableEditApp();\n    }else{\n      enableEditApp();\n    }\n  }else{\n    enableEditApp();\n  }\n}","beforeload":"\n\n Wb.edit(app.appgrid,app.appwin);\napp.appwin.setTitle('{#app_edit#}');"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"appWinbtns"},"children":[{"configs":{"text":"{#app_save#}","itemId":"saveBtn_appWin","iconCls":"save_icon"},"events":{"click":"if (app.appform.getForm().isValid() === false) {\n  Ext.Msg.alert('{#app_alert#}', '{#app_appInfoImp#}');\n  return;\n}\nvar appId = app.APP_ID.getValue();\nvar json = {\n  appId: '',\n  applCode: app.APP_CODE.getValue(),\n  applName: app.APP_NAME.getValue(),\n  appDesc: '',\n  enableFlag: app.ENABLE_FLAG.getValue(),\n  webHost: app.WEB_HOST.getValue(),\n  webPort: app.WEB_PORT.getValue(),\n  webPorject: app.WEB_PROJECT.getValue(),\n  loginUrl: app.LOGIN_URL.getValue(),\n  dbUrl: app.DB_URL.getValue(),\n  dbType: app.DB_TYPE.getValue(),\n  dbUser: app.DB_USER.getValue(),\n  dbPassword: app.DB_PASSWORD.getValue(),\n  inXip: app.IN_XIP.getValue(),\n  userId: '{#userId#}'\n};\nif (app.IN_XIP.getValue() == 'N' && Ext.isEmpty(app.WEB_HOST.getValue())) {\n  Ext.Msg.alert('{#app_alert#}', '{#app_appInfoAdd#}');\n  return;\n}\nif (Ext.isEmpty(appId)) { //新增\n  json.appId = getuuid();\n  Wb.request({\n    url: 'm?xwl=xip/base/app/data/insertApp',\n    params: json,\n    success: function(response) {\n      app.APP_ID.setValue(json.appId);\n      app.appgrid.store.reload();\n      app.appwin.hide();\n      Ext.Msg.alert('{#app_alert#}', '{#app_success#}');\n    }\n  });\n} else { //更新\n  json.appId = appId;\n  Wb.request({\n    url: 'm?xwl=xip/base/app/data/updateApp',\n    params: json,\n    success: function(response) {\n      app.appgrid.store.reload();\n      app.appwin.hide();\n      Ext.Msg.alert('{#app_alert#}', '{#app_success#}');\n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#app_close#}","itemId":"closeBtnAppWin","iconCls":"cancel_icon"},"events":{"click":"app.appwin.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"win"},"children":[{"configs":{"title":"{#app_appAdduser#}","height":"380","layout":"border","width":"580","closeAction":"hide","itemId":"userSelectWin","dialog":"true","modal":"true"},"events":{"ok":"\nvar rows = app.userSelectGrid.getSelectionModel().getSelection();\nvar  type=app.OP_TYPE.getValue();\nif(rows.length==0){\n  Ext.Msg.alert('{#alert#}','{#addselRecord#}');\n}else{\n  var insertArray = new Array();\n  \n  for(var i=0; i<rows.length; i++){\n    var _record = {secId:getuuid(), appId:app.userSelectWinAppId.getValue(), userId:rows[i].data.USER_ID, create:'{#userId#}'};\n    insertArray.push(_record);\n  }\n  \n//   ajax_appSec_insert.params.insertArray = Ext.JSON.encode(insertArray);\n//   ajax_appSec_insert.request();\n     Wb.request({\n    url: 'm?xwl=xip/base/app/data/insertAppSec',\n    params: Wb.apply({\n     insertArray:insertArray\n     }),\n    success: function() {\n     app.userSelectWin.close();\n     \n    if(type =='add'){\n    app.appSecGrid.store.load({params : { APP_ID :app.APP_ID.getValue()}});\n    }else{  \n   app.appSecGrid.store.reload();\n    \n    }\n    }\n  });\n \n}"},"children":[{"configs":{"region":"north","frame":"true","height":"70","layout":"fit","itemId":"userSelectForm"},"events":{"afterrender":"app.appform.getForm().trackResetOnLoad = true ;"},"children":[{"configs":{"title":"{#conditionQuery#}","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"hidden":"true","itemId":"userSelectWinAppId"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"selectedUserIds"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","width":"180","labelAlign":"right","itemId":"userName1","fieldLabel":"{#app_userName#}"},"events":{"specialkey":"app.userName1Upper.setValue(app.userName1.getValue().toUpperCase());\napp.userSelectGrid.store.load({\n  \n  params:{userSelectWinAppId :  app.userSelectWinAppId.getValue(),userName1Upper:app.userName1Upper.getValue(), empName1: app.empName1.getValue()}\n});"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","width":"180","labelAlign":"right","itemId":"empName1","fieldLabel":"{#app_empName#}"},"events":{"specialkey":"app.userName1Upper.setValue(app.userName1.getValue().toUpperCase());\napp.userSelectGrid.store.load({\n  \n  params:{userSelectWinAppId :  app.userSelectWinAppId.getValue(),userName1Upper:app.userName1Upper.getValue(), empName1: app.empName1.getValue()}\n});"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","width":"250","itemId":"userName1Upper"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#app_query#}","itemId":"queryUserBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.userName1Upper.setValue(app.userName1.getValue().toUpperCase());\napp.userSelectGrid.store.load({\n  params: {\n    userSelectWinAppId: app.userSelectWinAppId.getValue(),\n    userName1Upper: app.userName1Upper.getValue(),\n    empName1: app.empName1.getValue()\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#app_reset#}","itemId":"resetUserBtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"app.userName1.setValue('');\napp.empName1.setValue('');\napp.userSelectGrid.store.load();"},"children":[],"expanded":true,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","selType":"checkboxmodel","itemId":"userSelectGrid","simpleSelect":"true"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xip/base/app/data/getUser"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"用户id","hidden":"true","dataIndex":"USER_ID","itemId":"COLUMN_USER_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_userName#}","width":"250","dataIndex":"USER_NAME","itemId":"COLUMN_USER_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"员工编码","hidden":"true","dataIndex":"EMP_CODE","itemId":"COLUMN_EMP_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_empName#}","dataIndex":"EMP_NAME","itemId":"COLUMN_EMP_NAME","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"员工类型","hidden":"true","dataIndex":"USER_TYPE","itemId":"COLUMN_USER_TYPE","renderer":"if(value=='S'){\n  return '系统内置用户';\n}else if(value=='U'){\n  return '自定义用户';\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"开始时间","hidden":"true","dataIndex":"START_DATE","itemId":"COLUMN_START_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"结束时间","hidden":"true","dataIndex":"END_DATE","itemId":"COLUMN_END_DATE","renderer":"\n"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"maximized":"false","height":"500","layout":"fit","width":"700","closeAction":"hide","resizable":"true","buttonAlign":"center","buttons":"app.appWinbtns","itemId":"appwin","border":"false","dialog":"false","modal":"true","maximizable":"true"},"children":[{"configs":{"bodyStyle":"padding: 10px 10px 0px","tagConfigs":"trackResetOnLoad : true","frame":"true","autoScroll":"true","style":"border-width:0px","layout":"anchor","itemId":"appform"},"events":{"afterrender":"\n//app.appform.getForm().trackResetOnLoad= true;"},"children":[{"configs":{"labelWidth":"100","hidden":"true","width":"250","labelAlign":"right","itemId":"APP_ID","fieldLabel":"应用id"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"OP_TYPE"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"anchor:'100%'","title":"{#baseInfo#}","autoScroll":"true","collapsible":"true","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"frame":"true","style":"border-width:0px","itemId":"panel1","border":"false"},"children":[{"configs":{"allowBlank":"false","width":"280","labelAlign":"right","itemId":"APP_CODE","fieldLabel":"<font style=\"color:red\">*<\/font>{#app_appCode#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"displayField":"NAME","width":"280","valueField":"CODE","labelAlign":"right","pickList":"[['Y','{#app_yes#}'],['N','{#app_no#}']]","itemId":"IN_XIP","fieldLabel":"{#app_isInterEnginer#}"},"events":{"select":"var value=app.IN_XIP.getValue();\nvar addr=app.WEB_HOST.getValue();\nif(value=='N'){\napp.WEB_HOST.setReadOnly(false);\n  operatorDbInfos(false);\n}\nif(value=='Y' ){\n  app.WEB_HOST.setValue('');\n  app.WEB_HOST.setReadOnly(true);\n  app.DB_TYPE.setValue('');\n  app.DB_USER.setValue('');\n  app.DB_URL.setValue('');\n  app.DB_PASSWORD.setValue('');\n  operatorDbInfos(true);\n}"},"children":[],"expanded":true,"type":"combo"},{"configs":{"allowBlank":"false","width":"280","labelAlign":"right","pickList":"[['Y','{#app_yes#}'],['N','{#app_no#}']]","itemId":"ENABLE_FLAG","fieldLabel":"{#app_enable#}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px","itemId":"panel2","border":"false"},"children":[{"configs":{"allowBlank":"false","width":"280","labelAlign":"right","itemId":"APP_NAME","fieldLabel":"<font style=\"color:red\">*<\/font>{#app_appName#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"280","vtypeText":"不是有效的地址，请重新输入。","vtype":"url","labelAlign":"right","itemId":"WEB_HOST","fieldLabel":"{#app_appAddr#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"allowBlank":"true","hidden":"true","width":"280","labelAlign":"right","itemId":"WEB_PORT","fieldLabel":"<font style=\"color:red\">*<\/font>{#app_appPort#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"allowBlank":"true","hidden":"true","width":"280","labelAlign":"right","itemId":"WEB_PROJECT","fieldLabel":"<font style=\"color:red\">*<\/font>{#app_projectName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"},{"configs":{"tagConfigs":"anchor:'100%'","title":"{#otherInfo#}","autoScroll":"true","collapsible":"true","layout":"column","itemId":"fieldset2"},"children":[{"configs":{"frame":"true","style":"border-width:0px","itemId":"panel3","border":"false"},"children":[{"configs":{"store":"app.dbTypeStore","displayField":"VAL_NAME","width":"280","valueField":"VAL_CODE","labelAlign":"right","itemId":"DB_TYPE","fieldLabel":"{#app_dbType#}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"width":"280","labelAlign":"right","itemId":"DB_USER","fieldLabel":"{#app_dbUser#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"280","labelAlign":"right","itemId":"LOGIN_URL","fieldLabel":"{#app_casLoginUrl#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px","itemId":"panel4","border":"false"},"children":[{"configs":{"width":"280","labelAlign":"right","itemId":"DB_URL","fieldLabel":"{#app_dbAddr#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"280","inputType":"password","labelAlign":"right","itemId":"DB_PASSWORD","fieldLabel":"{#app_dbAdmin#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"},{"configs":{"tagConfigs":"anchor:'100% - 200'","title":"{#appAuth#}","autoScroll":"false","collapsible":"false","layout":"fit","itemId":"fieldset3"},"children":[{"configs":{"region":"center","multiSelect":"true","height":"300","selType":"checkboxmodel","itemId":"appSecGrid","simpleSelect":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/base/app/data/getAppSecByAppId"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#app_addAuth#}","itemId":"addSecBtn","iconCls":"insert_icon"},"events":{"click":"var win = new Ext.window.Window(app._userSelectWin);\nif (app.appform.getForm().isValid() === false) {\n  Ext.Msg.alert('{#app_alert#}', '{#app_appInfoImp#}');\n  return;\n}\nif (app.appform.getForm().isDirty() === true) {\n  var appId = app.APP_ID.getValue();\n  /*var json = {\n    appId: '',\n    appCode: app.APP_CODE.getValue(),\n    appName: app.APP_NAME.getValue(),\n    appDesc: '',\n    enableFlag: app.ENABLE_FLAG.getValue(),\n    webHost: app.WEB_HOST.getValue(),\n    webPort: app.WEB_PORT.getValue(),\n    webPorject: app.WEB_PROJECT.getValue(),\n    loginUrl: app.LOGIN_URL.getValue(),\n    dbUrl: app.DB_URL.getValue(),\n    dbType: app.DB_TYPE.getValue(),\n    dbUser: app.DB_USER.getValue(),\n    dbPassword: app.DB_PASSWORD.getValue(),\n    inXip: app.IN_XIP.getValue(),\n    userId: '{#userId#}'\n\n  };*/\n  var json = {\n  appId: '',\n  applCode: app.APP_CODE.getValue(),\n  applName: app.APP_NAME.getValue(),\n  appDesc: '',\n  enableFlag: app.ENABLE_FLAG.getValue(),\n  webHost: app.WEB_HOST.getValue(),\n  webPort: app.WEB_PORT.getValue(),\n  webPorject: app.WEB_PROJECT.getValue(),\n  loginUrl: app.LOGIN_URL.getValue(),\n  dbUrl: app.DB_URL.getValue(),\n  dbType: app.DB_TYPE.getValue(),\n  dbUser: app.DB_USER.getValue(),\n  dbPassword: app.DB_PASSWORD.getValue(),\n  inXip: app.IN_XIP.getValue(),\n  userId: '{#userId#}'\n};\n  if (app.IN_XIP.getValue() == 'N' && Ext.isEmpty(app.WEB_HOST.getValue())) {\n    Ext.Msg.alert('{#app_alert#}', '{#app_appInfoAdd#}');\n    return;\n  }\n  if (Ext.isEmpty(appId)) { //新增\n    json.appId = getuuid();\n    app.APP_ID.setValue(json.appId);\n    Wb.request({\n      url: 'm?xwl=xip/base/app/data/insertApp',\n      params: json,\n      async: true,\n      success: function(resp) {\n        win.show();\n        app.userSelectWinAppId.setValue(app.APP_ID.getValue());\n        app.userSelectGrid.store.load({\n          params: {\n            userSelectWinAppId: app.APP_ID.getValue()\n          }\n        });\n        app.appgrid.store.reload();\n      }\n    });\n  } else { //更新\n    json.appId = appId;\n    Wb.request({\n      url: 'm?xwl=xip/base/app/data/updateApp',\n      params: json,\n      async: true,\n      success: function(response) {\n        win.show();\n        app.userSelectWinAppId.setValue(app.APP_ID.getValue());\n        app.userSelectGrid.store.load({\n          params: {\n            userSelectWinAppId: app.APP_ID.getValue()\n          }\n        });\n        app.appgrid.store.reload();\n      }\n    });\n  }\n} else {\n  win.show();\n  app.userSelectWinAppId.setValue(app.APP_ID.getValue());\n  app.userSelectGrid.store.load({\n    params: {\n      userSelectWinAppId: app.APP_ID.getValue()\n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#app_delAuth#}","itemId":"delSecBtn","iconCls":"remove_icon"},"events":{"click":"var rows = app.appSecGrid.getSelectionModel().getSelection();\nif (rows.length === 0) {\n  Ext.Msg.alert('{#app_alert#}', '{#app_selRecord#}');\n} else {\n  Ext.Msg.confirm('{#app_alert#}', '{#app_confirm#}', function(a) {\n    if (a == 'yes') {\n      var secIds = \"'emptyId'\";\n      for (var i = 0; i < rows.length; i++) {\n        secIds += ',' + \"'\" + (rows[i].data.SEC_ID) + \"'\";\n      }\n      Wb.request({\n        url: 'm?xwl=xip/base/app/data/deleteAppSecById',\n        params: {\n          secids: secIds\n        },\n        success: function() {\n          Ext.Msg.alert('{#app_alert#}', '{#app_success#}');\n          app.appSecGrid.store.reload();\n          app.appgrid.store.reload();\n        }\n      });\n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"授权id","hidden":"true","dataIndex":"SEC_ID","itemId":"COLUMN_SEC_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"应用id","hidden":"true","dataIndex":"APP_ID","itemId":"COLUMN_APP_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"用户id","hidden":"true","dataIndex":"USER_ID","itemId":"COLUMN_USER_ID1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_userName#}","width":"260","dataIndex":"USER_NAME","itemId":"COLUMN_USER_NAME1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_empName#}","width":"260","dataIndex":"EMP_NAME","itemId":"COLUMN_EMP_NAME1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"80","frame":"true","style":"border-width:0px","layout":"fit","itemId":"queryform","border":"false"},"children":[{"configs":{"title":"{#conditionQuery#}","style":"padding-top:8px","collapsible":"true","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"150","width":"350","labelAlign":"right","itemId":"appCodeName","fieldLabel":"{#app_appCodeName#}"},"events":{"specialkey":"app.appgrid.store.load( {  params:{appCodeName:app.appCodeName.getValue() }} );"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#app_query#}","itemId":"queryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.appgrid.store.load( {  params:{appCodeName:app.appCodeName.getValue() }} );"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#app_reset#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"app.queryform.getForm().reset();\napp.appgrid.store.load();"},"children":[],"expanded":true,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"false","selType":"rowmodel","itemId":"appgrid"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xip/base/app/data/getApps"},"events":{"beforeload":"// var wheresql = \"where 1=1 \";\n// if(!Ext.isEmpty(app.appCodeName.getValue()))\n//   wheresql += \" and t.APP_CODE '\"+app.appCodeName.getValue()+\"'\";\n\n// store.getProxy().extraParams.WHERESQL=wheresql;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#app_add#}","itemId":"addBtn","iconCls":"application_add_icon"},"events":{"click":"var win = new Ext.window.Window(app._appwin);\nWb.setTitle(win, '{#app_appAdd#}');\napp.APP_CODE.setReadOnly(false);\napp.WEB_HOST.setReadOnly(false);\napp.APP_ID.setValue('');\napp.APP_CODE.setValue('');\napp.APP_NAME.setValue('');\napp.WEB_HOST.setValue('');\napp.WEB_PROJECT.setValue('');\napp.ENABLE_FLAG.setValue('Y');\napp.WEB_PORT.setValue('');\napp.IN_XIP.setValue('N');\napp.DB_TYPE.setValue('');\napp.DB_USER.setValue('');\napp.LOGIN_URL.setValue('');\napp.DB_URL.setValue('');\napp.DB_PASSWORD.setValue('');\napp.OP_TYPE.setValue('add');\nenableEditApp();\nwin.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#app_edit#}","itemId":"editBtn","iconCls":"table_edit_icon"},"events":{"click":"var rows = app.appgrid.getSelectionModel().getSelection();\nif(rows.length===0){\n  Ext.Msg.alert('{#app_alert#}','{#app_selRecord#}');   \n}else{\n  var id = rows[0].data.APP_ID;\n  if(Ext.isEmpty(id)){\n    Ext.Msg.alert('{#app_alert#}','{#app_saveBeforeOp#}');\n    return;\n  }\n  app.appQueryByIdStore.load({params:{appId:id}});\n  app.OP_TYPE.setValue('edit');\n\n  app.APP_CODE.setReadOnly(true);\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#app_delete#}","itemId":"deleteBtn","iconCls":"application_delete_icon"},"events":{"click":"var recs = app.appgrid.getSelection();\nif (!recs.length) {\n  Wb.warn('{#app_selRecord#}');\n  return;\n}\nExt.Msg.confirm('{#app_alert#}','{#app_confirm#}',function(a){\n    if(a=='yes'){\n    \n      var json ={\n        APP_ID:recs[0].get('APP_ID'),\n        APP_CODE:recs[0].get('APP_CODE')\n      };\n    Wb.request({\n        url: 'm?xwl=xip/base/app/data/deleteApp', \n           params:  json,\n           success: function() {\n             Ext.Msg.alert('{#app_alert#}','{#app_success#}');   \n             app.appgrid.store.reload();\n           }\n    });\n    }\n  });"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"应用id","hidden":"true","dataIndex":"APP_ID","itemId":"COLUMN_APP_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_appCode#}","width":"150","dataIndex":"APP_CODE","itemId":"COLUMN_APP_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_appName#}","width":"220","dataIndex":"APP_NAME","itemId":"COLUMN_APP_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_appAddr#}","width":"240","dataIndex":"WEB_HOST","itemId":"COLUMN_WEB_HOST"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_appPort#}","hidden":"true","width":"150","dataIndex":"WEB_PORT","itemId":"COLUMN_WEB_PORT"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_projectName#}","hidden":"true","width":"150","dataIndex":"WEB_PROJECT","itemId":"COLUMN_WEB_PROJECT"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_dbType#}","width":"150","dataIndex":"DB_TYPE","itemId":"COLUMN_DB_TYPE","renderer":"// if(value===null || value===''){\n//   return '';\n// }\n// var index = renderStore.find('VAL_CODE',value);\n// if(index!=-1){\n//   var rawValue = renderStore.getAt(index).get('VAL_NAME');\n//   return rawValue;\n// }\n"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_interEnginer#}","width":"100","align":"center","dataIndex":"IN_XIP","itemId":"COLUMN_IN_XIP","renderer":"if(value=='Y'){\n  return '{#yes#}';\n}else if(value=='N'){\n  return '{#no#}';\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_enable#}","align":"center","width":"100","dataIndex":"ENABLE_FLAG","itemId":"COLUMN_ENABLE_FLAG","renderer":"if(value=='Y'){\n\treturn '{#yes#}';\n}else{\n\t\n   return '<font color=\"red\">{#no#}<\/font>';\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#app_version#}","width":"100","align":"center","dataIndex":"VERSION","itemId":"VERSION"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}