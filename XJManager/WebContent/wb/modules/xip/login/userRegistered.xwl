{"inframe":true,"title":"用户注册","hidden":false,"roles":{"default":1},"children":[{"configs":{"cssLinks":"[\"xip/login/css/cssLogin2.css\"]","loginRequired":"false","initScript":"var ctxPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",ctxPath);\n","loadJS":"ext","serverScript":"var serverUrl = com.xzsoft.xip.platform.util.PlatformUtil.getXipConfigVal(\"cas.casServerUrl\");\nrequest.setAttribute('serverUrl',serverUrl);\n\n//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/login/json/userRegistered\"); ","head":"<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<link rel=\"stylesheet\" href=\"xip/login/css/bootstrap.css\"/>\n<link rel=\"stylesheet\" href=\"wb/libs/bs/css/bootstrap.css\"/>\n<link rel=\"stylesheet\" href=\"xip/bs/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.css\"/>\n<script type=\"text/javascript\" src=\"wb/libs/jquery/jquery.js\"><\/script> \n<script type=\"text/javascript\" src=\"xip/login/js/bootstrap.min.js\"><\/script>\n<script type=\"text/javascript\" src=\"xip/login/js/bootstrapValidator.js\"><\/script> \n<script type=\"text/javascript\" src=\"xip/bs/bootstrap-switch-master/dist/js/bootstrap-switch.js\"><\/script> \n<script>\n  \n  function keydown(e){\n\tvar currKey=0,e=e||event;\n\tif(e.keyCode==13){\n      $('#defaultForm').bootstrapValidator('validate');\n\t}\n}\ndocument.onkeydown=keydown;\n<\/script>\n<meta name=\"viewport\"  content=\"width=device-width,initial-scale=1.0\"> ","itemId":"module"},"events":{"finalize":"//前端验证表单 异步验证表单\n$(document).ready(function() {\n\n      //异步验证用户名\n      //  $(\"#username\").blur(function(){\n      // var userName=$(\"#username\").val().toUpperCase();\n      //});\n\n\n      var userid = '';\n      $('#defaultForm').bootstrapValidator({\n          message: 'This value is not valid',\n          feedbackIcons: {\n            valid: 'glyphicon glyphicon-ok',\n            invalid: 'glyphicon glyphicon-remove',\n            validating: 'glyphicon glyphicon-refresh'\n          },\n          fields: {\n\n            username: {\n              validators: {\n                notEmpty: {\n                  /*message: '用户名不能为空'*/\n                  message: '{#xip_login_register_usernameNotNull#}'\n                },\n                regexp: {\n                  regexp: /^[a-zA-Z0-9_]+$/,\n                  message: '{#xip_login_register_usernameNotZh#}'\n                  /*message: '用户名不能有汉字'*/\n                },\n               \n                 \n                  remote: {\n                    url: '{#contextPath#}' + '/platformAction.do?method=userNameValidation',\n                    type: \"post\",\n                    async: false,\n                    data: {\n                      userName: function(validator) {\n                        return $('#defaultForm :input[name=\"username\"]').val();\n\n                      }\n                    },\n                    message: '{#xip_login_register_usernameIsExist#}'\n                    /*message: '用户已存在'*/\n                  }\n                }\n              },\n              password: {\n                validators: {\n                  notEmpty: {\n                    message: '{#xip_login_register_passwordNotNull#}'\n                    /*message: '密码不能为空'*/\n                  }\n                  //                     identical: {\n                  //                         field: 'confirmPassword',\n                  //                         message: '两次密码不一致'\n                  //                     }\n                }\n              },\n              confirmPassword: {\n                validators: {\n                  notEmpty: {\n                    message: '{#xip_login_register_confirmPasswordNotNull#}'\n                    /*message: '确认密码不能为空'*/\n                  },\n                  identical: {\n                    field: 'password',\n                    message: '{#xip_login_register_passwordNotSame#}'\n                    /*message: '两次密码不一致'*/\n                  }\n                }\n              },\n              empno: {\n                validators: {\n                  notEmpty: {\n                    message: '{#xip_login_register_empCodeNotNull#}'\n                    /*message: '员工编号不能为空'*/\n                  },\n                  remote: {\n                    url: '{#contextPath#}' + '/platformAction.do?method=outEmpCodeValidation',\n                    type: \"post\",\n                    async: false,\n                    data: {\n                      outEmpCode: function(validator) {\n                        return $('#defaultForm :input[name=\"empno\"]').val();\n\n                      }\n                    },\n\n                    message: '{#xip_login_register_empCodeIsExist#}'\n                    /*message: '员工编号已存在'*/\n                  }\n                }\n              },\n              inempname: {\n                validators: {\n                  notEmpty: {\n                    message: '{#xip_login_register_innerempCodeNotNull#}'\n                    /*message: '内部员工编号不能为空'*/\n                  },\n                  remote: {\n                    url: '{#contextPath#}' + '/platformAction.do?method=empCodeValidation',\n                    type: \"post\",\n                    async: false,\n                    data: {\n                      empCode: function(validator) {\n                        return $('#defaultForm :input[name=\"inempname\"]').val();\n\n                      }\n                    },\n\n                    message: '{#xip_login_register_innerempExist#}'\n                    /*message: '内部员工编号不存在或员工已创建用户'*/\n                  }\n                }\n              },\n            empname: {\n                validators: {\n                  notEmpty: {\n                    message: '{#xip_login_register_empnameNotNull#}'\n                    /*message: '姓名不能为空'*/\n                  }\n\n                \n                }\n              },\n              telphone: {\n                validators: {\n                  notEmpty: {\n                    message: '{#xip_login_register_telphoneNotNull#}'\n                    /*message: '手机号不能为空'*/\n                  },\n\n                  regexp: {\n                    regexp: /^1[3|4|5|7|8][0-9]\\d{8}$/,\n                    message: '{#xip_login_register_telphoneError#}'\n                    /*message: '手机号格式有误'*/\n                  }\n                }\n              },\n\n              email: {\n                validators: {\n\n                  notEmpty: {\n                    message: '{#xip_login_register_emailNotNull#}'\n                    /*message: '邮箱地址不能为空'*/\n                  },\n                  emailAddress: {\n\n                    message: '{#xip_login_register_enterRightEmail#}'\n                    /*message: '请输入正确的E-mail地址'*/\n                  },\n                  remote: {\n                    url: '{#contextPath#}' + '/platformAction.do?method=emailValidation',\n                    type: \"post\",\n                    async: false,\n                    data: {\n                      email: function(validator) {\n                        return $('#defaultForm :input[name=\"email\"]').val();\n\n                      }\n                    },\n\n                    message: '{#xip_login_register_emailIsExist#}'\n                    /*message: '邮箱地址已存在'*/\n                  }\n                }\n              }\n\n            }\n          })\n        .on('success.form.bv', function(e) {\n          var userName = $(\"#username\").val().toUpperCase();\n          var passWord = Xip.getMD5($(\"#password\").val());\n          var againValue = $(\"#confirmPassword\").val();\n          var myName = $(\"#empname\").val();\n          var TelPhone = $(\"#telphone\").val();\n          var e_mail = $(\"#email\").val();\n          var inEmpCode = $(\"#inempname\").val();\n          var outEmpCode = $(\"#empno\").val();\n          Ext.Ajax.request({\n            url: '{#contextPath#}' + '/platformAction.do?method=regist',\n            params: {\n              userName: userName,\n              passWord: passWord,\n              myName: myName,\n              TelPhone: TelPhone,\n              e_mail: e_mail,\n              inEmpCode: inEmpCode,\n              outEmpCode: outEmpCode,\n              checkType: checkType\n            },\n            waitTitle: '{#xip_login_register_tips#}',\n            method: 'POST',\n            async: false,\n            waitMsg: '{#xip_login_register_waitMsg#}',\n            success: function(response, options) { // 回调函数有2个参数\n              var respText = Ext.JSON.decode(response.responseText);\n              if (checkType == '1') {\n                userid = respText.inUserId;\n              } else if (checkType == '0') {\n                userid = respText.userId;\n              }\n             if(respText.flag=='1'){\n              Ext.Msg.alert('{#xip_login_register_tips#}',respText.msg );\n             }else{ if(checkType == '1'){\n                 window.location.href = '{#serverUrl#}'+'/m?xwl=xip/login/registSuccess';\n             }else if (checkType == '0') {\n                window.location.href = '{#serverUrl#}'+'/m?xwl=xip/login/registSuccessout';\n              }\n           \n             }\n            },\n            failure: function(response, options) {\n              Ext.Msg.alert('{#xip_login_register_tips#}', '{#xip_login_register_registerFailure#}');\n            }\n          });\n\n\n\n        });\n        //提交按钮\n        $('#submitBtn').click(function() {\n          $('#defaultForm').bootstrapValidator('validate');\n        });\n\n\n        //重置按钮\n        $('#resetBtn').click(function() {\n          window.location.href = '{#serverUrl#}'+'/m?xwl=xip/login/login';\n         });\n        });\n   ","initialize":"var checkType='0';\n//初始化checkbox样式\n$(\"[name='checkemp']\").bootstrapSwitch({  \n            onText:'{#xip_login_register_yes#}',  \n            offText:'{#xip_login_register_no#}',\n          \n  size:'mini'\n     });\n\n//监听checkemp点击事件\n\n$('#checkemp').on('switchChange.bootstrapSwitch', function(event, state) {  \n\n   var checktype=document.getElementById(\"checkemp\").checked;\n  \n  if(checktype ){//选中\n    checkType='1';\n     $('#inempnamediv').show();\n     $('#empnodiv').hide();\n     $('#empnamediv').hide();\n     $('#telphonediv').hide();\n     $('#emaildiv').hide();\n     $('#empname').attr(\"disabled\",\"disabled\"); \n     $('#telphone').attr(\"disabled\",\"disabled\"); \n     $('#email').attr(\"disabled\",\"disabled\"); \n     $('#inempnamediv').removeAttr(\"disabled\");  \n   \n  }else{\n   checkType='0';\n     $('#inempnamediv').hide();\n     $('#empnodiv').show();\n     $('#empnamediv').show();\n     $('#telphonediv').show();\n     $('#emaildiv').show();\n     $('#inempnamediv').attr(\"disabled\",\"disabled\"); \n     $('#empname').removeAttr(\"disabled\"); \n     $('#telphone').removeAttr(\"disabled\"); \n     $('#email').removeAttr(\"disabled\"); \n\n  }\n  \n\n});  \n\n\n"},"children":[{"configs":{"text-align":"center","class":"container","itemId":"containerdiv"},"children":[{"configs":{"class":"row","itemId":"rowdiv"},"children":[{"configs":{"class":"col-lg-5  col-xs-2","itemId":"divleft"},"children":[],"expanded":false,"type":"div"},{"configs":{"class":"col-lg-2 col-xs-8","itemId":"divcenter"},"children":[{"configs":{"itemId":"div2"},"children":[{"configs":{"itemId":"header1"},"children":[],"expanded":false,"type":"header"}],"expanded":true,"type":"div"},{"configs":{"itemId":"br2"},"children":[],"expanded":false,"type":"br"},{"configs":{"itemId":"br1"},"children":[],"expanded":false,"type":"br"},{"configs":{"itemId":"hr1"},"children":[],"expanded":false,"type":"hr"},{"configs":{"text-align":"center","itemId":"divbody"},"children":[{"configs":{"id":"defaultForm","class":"form-horizontal","itemId":"from"},"children":[{"configs":{"id":"usernamediv","class":"form-group","itemId":"usernamediv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"username","placeholder":"{#xip_login_register_userName#}","name":"username","class":"form-control","itemId":"username"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"class":"form-group","itemId":"passworddiv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"password","placeholder":"{#xip_login_register_password#}","name":"password","class":"form-control","type":"password","itemId":"password"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"class":"form-group","itemId":"confirmPassworddiv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"confirmPassword","placeholder":"{#xip_login_register_confirmPassword#}","name":"confirmPassword","class":"form-control","type":"password","itemId":"confirmPassword"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"text-align":"left","class":"form-group","itemId":"checkempdiv"},"children":[{"configs":{"id":"mySwitch","class":"switch","itemId":"div1"},"children":[{"configs":{"text":"{#xip_login_register_isinnerEmp#}","style":"color:yellow","buttonType":"btn-group","itemId":"span1"},"children":[],"expanded":false,"type":"span"},{"configs":{"id":"checkemp","buttonType":"btn-group","name":"checkemp","type":"checkbox","itemId":"checkemp"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"id":"inempnamediv","style":"display: none;","class":"form-group","itemId":"inempnamediv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"inempname","placeholder":"{#xip_login_register_inempname#}","name":"inempname","class":"form-control","itemId":"inempname"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"id":"empnamediv","class":"form-group","itemId":"empnamediv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"empname","placeholder":"{#xip_login_register_empname#}","name":"empname","class":"form-control","itemId":"empname"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"id":"telphonediv","class":"form-group","itemId":"telphonediv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"telphone","placeholder":"{#xip_login_register_telphone#}","name":"telphone","class":"form-control","itemId":"telphone"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"id":"emaildiv","class":"form-group","itemId":"emaildiv"},"children":[{"configs":{"itemId":"div1"},"children":[{"configs":{"id":"email","placeholder":"{#xip_login_register_email#}","name":"email","class":"form-control","itemId":"email"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"class":"form-group","itemId":"buttondiv"},"children":[{"configs":{"class":"col-lg-4 col-xs-4","itemId":"div3"},"children":[{"configs":{"id":"submitBtn","text":"{#xip_login_register_submitBtn#}","class":"btn btn-primary","type":"btn-info","itemId":"submitBtn"},"children":[],"expanded":false,"type":"bbutton"}],"expanded":true,"type":"div"},{"configs":{"class":"col-lg-3 col-xs-3","itemId":"div1"},"children":[],"expanded":true,"type":"div"},{"configs":{"class":"col-lg-4 col-xs-4","itemId":"div2"},"children":[{"configs":{"id":"resetBtn","text":"{#xip_login_register_resetBtn#}","type":"btn-info","itemId":"resetBtn"},"children":[],"expanded":false,"type":"bbutton"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"bform"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"class":"col-lg-5 col-xs-2","itemId":"divright"},"children":[],"expanded":false,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}