{"inframe":false,"title":"数据建模","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var ctxPath = request.getContextPath() ;\nrequest.setAttribute(\"contextPath\",ctxPath);\nvar globalDbType = com.xzsoft.xip.platform.util.PlatformUtil.getDbType().toLowerCase();\nrequest.setAttribute(\"dbType\",globalDbType);\n\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","loginRequired":"false","jsLinks":"[\"xip/zeroClipboard/ZeroClipboard.js\"]","serverScript":"//三方语言,引入对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xip/tools/model/json/model');","itemId":"module"},"events":{"finalize":"var editColIndex = 0;\nvar editInIndex = 0;\nvar editConIndex = 0;\nvar exportParams;\nvar queryJson;\nvar opType;\nvar currentRowIndex = 0;\nvar mustType = ['VARCHAR','NUMERIC','NVARCHAR','DECIMAL'];"},"children":[{"configs":{"itemId":"winBtns"},"children":[{"configs":{"itemId":"objectWindowBtn"},"children":[{"configs":{"text":"{#tools_model_save#}","itemId":"objSaveBtn","iconCls":"save_icon"},"events":{"click":"var insertIndexValue = [];\nif (!app.objectForm.getForm().isValid()) {\n  Wb.warn('{#tools_model_fill_all#}');\n} else {\n  var _tableId = app.tableId.getValue();\n  var _appId = app.belongApp.getValue();\n  var _tableName = app.tableName.getValue();\n  var _tableDesc = app.tableDesc.getValue();\n  var json = {\n    'TAB_ID': _tableId,\n    'APP_ID': _appId,\n    'TAB_NAME': _tableName,\n    'TAB_COMMENT': _tableDesc\n  };\n  /**------------------------ column index and constrain duplicate check---------------------**/\n  /**-------------------------------necessary options check----------------------------------**/\n  var _columnArray = [];\n  var _indexArray = [];\n  var _constrainArray = [];\n  var _columnMust = true;\n  var _indexMust = true;\n  var _constrainMust = true;\n  var _lengthMust = true;\n  var _colName = '';\n  app.columnGrid.store.each(function(colItem) {\n    if (Ext.isEmpty(colItem.get('COL_NAME')) || Ext.isEmpty(colItem.get('COL_TYPE'))) {\n      _columnMust = false;\n      return;\n    }\n\n    var _tmpColType = colItem.get('COL_TYPE');\n    var _tmpColLen = colItem.get('COL_LENGTH');\n    _columnArray.push(colItem.get('COL_NAME'));\n    //判断必填长度的类型\n    if (Ext.Array.contains(mustType, _tmpColType) && Ext.isEmpty(_tmpColLen)) {\n      _colName = colItem.get('COL_NAME');\n      _lengthMust = false;\n      return;\n    }\n    if (!Ext.Array.contains(mustType, _tmpColType) && !Ext.isEmpty(_tmpColLen)) {\n      colItem.set('COL_LENGTH', '');\n    }\n  });\n  if (!_columnMust) {\n    Wb.warn('{#tools_model_fill_panel#}');\n    return;\n  }\n  if (!_lengthMust) {\n    Wb.warn(_colName + '{#tools_model_column_size#}');\n    return;\n  }\n  app.indexGrid.store.each(function(indexItem) {\n    if (Ext.isEmpty(indexItem.get('INDEX_TYPE')) || Ext.isEmpty(indexItem.get('INDEX_NAME')) || Ext.isEmpty(indexItem.get('COL_ID'))) {\n      _indexMust = false;\n      return;\n    }\n    _indexArray.push(indexItem.data.INDEX_NAME);\n  });\n  if (!_indexMust) {\n    Wb.warn('{#tools_model_fill_index_panel#}');\n    return;\n  }\n  //只能有一条主键\n  var _pkIsRepeat = 0;\n  app.refrenceGrid.store.each(function(refItem) {\n    if (refItem.get('CONS_TYPE') == 'FKEY') {\n      if (Ext.isEmpty(refItem.get('CONS_NAME')) || Ext.isEmpty(refItem.get('REF_TAB_NAME')) || Ext.isEmpty(refItem.get('REF_TAB_COL')) || Ext.isEmpty(refItem.get('CONS_TYPE'))) {\n        _constrainMust = false;\n        return;\n      }\n      if (refItem.get('CONS_TYPE') == 'PKEY') {\n        if (Ext.isEmpty(refItem.get('CONS_NAME')) || Ext.isEmpty(refItem.get('CONS_TYPE')) || Ext.isEmpty(refItem.get('CONS_ID'))) {\n          _constrainMust = false;\n          return;\n        }\n      }\n    }\n    if (refItem.get('CONS_TYPE') == 'PKEY') {\n      _pkIsRepeat++;\n    }\n    _constrainArray.push(refItem.data.CONS_NAME);\n  });\n  if (!_constrainMust) {\n    Wb.warn('{#tools_model_fill_constraint_panel#}');\n    return;\n  }\n  var _unColumnArray = Ext.Array.unique(_columnArray);\n  var _unIndexArray = Ext.Array.unique(_indexArray);\n  var _unConstrainArray = Ext.Array.unique(_constrainArray);\n  if (_unColumnArray.length !== _columnArray.length) {\n    Wb.warn('{#tools_model_repeat_column_name#}');\n    return;\n  }\n  if (_unIndexArray.length !== _indexArray.length) {\n    Wb.warn('{#tools_model_repeat_index_name#}');\n    return;\n  }\n  if (_unConstrainArray.length !== _constrainArray.length) {\n    Wb.warn('{#tools_model_repeat_constraint_name#}');\n    return;\n  }\n  if (_pkIsRepeat > 1) {\n    Wb.warn('{#tools_model_warn_msg1#}');\n    return;\n  }\n  /**----------------------save operation------------------**/\n  if ('add' == app.operateFlag.getValue()) {\n    Wb.request({\n      url: 'm?xwl=xip/tools/model/DATA/saveTableObj',\n      params: json,\n      success: function() {\n        app.operateFlag.setValue('edit');\n        app.belongApp.setReadOnly(true);\n        app.tableName.setReadOnly(true);\n        app.objectWindow.setTitle('{#tools_model_edit_object#}');\n        /**----------------columnGrid INSERT-----------------**/\n\n        var insertColValue = [];\n        app.columnGrid.store.each(function(e) {\n          var json = {\n            COL_ID: e.data.COL_ID,\n            TAB_ID: e.data.TAB_ID,\n            TAB_NAME: e.data.TAB_NAME,\n            COL_NAME: e.data.COL_NAME,\n            COL_TYPE: e.data.COL_TYPE,\n            COL_LENGTH: e.data.COL_LENGTH,\n            COL_COMMENT: e.data.COL_COMMENT,\n            DEFAULT_VAL: e.data.DEFAULT_VAL,\n            APP_ID: e.data.APP_ID,\n            IS_NULL: e.data.IS_NULL,\n            COL_SEQ: e.data.COL_SEQ\n          };\n          insertColValue.push(json);\n\n        });\n        Wb.request({\n          url: 'm?xwl=xip/tools/model/DATA/columnCreate',\n          params: Wb.apply({\n            array: Wb.encode(insertColValue)\n          }),\n          success: function() {\n            app.columnGrid.store.load();\n          }\n        });\n        /**----------------indexGrid INSERT-----------------**/\n\n        app.indexGrid.store.each(function(e) {\n          var json = {\n            CONS_ID: e.data.CONS_ID,\n            COL_ID: e.data.COL_ID,\n            INDEX_COL_NAME: e.data.INDEX_COL_NAME,\n            TAB_ID: e.data.TAB_ID,\n            TAB_NAME: e.data.TAB_NAME,\n            INDEX_TYPE: e.data.INDEX_TYPE,\n            INDEX_NAME: e.data.INDEX_NAME,\n            APP_ID: e.data.APP_ID\n          };\n          insertIndexValue.push(json);\n\n        });\n        Wb.request({\n          url: 'm?xwl=xip/tools/model/DATA/indexCreate',\n          params: Wb.apply({\n            array: Wb.encode(insertIndexValue)\n          }),\n          success: function() {\n            app.indexGrid.store.load();\n          }\n        });\n        /**----------------indexGrid synchronize-----------------**/\n\n        var insertReferValue = [];\n        app.refrenceGrid.store.each(function(e) {\n          var json = {\n            CONS_ID: e.data.CONS_ID,\n            COL_ID: e.data.COL_ID,\n            CONS_NAME: e.data.CONS_NAME,\n            TAB_ID: e.data.TAB_ID,\n            TAB_NAME: e.data.TAB_NAME,\n            CONS_TYPE: e.data.CONS_TYPE,\n            CONS_COL_NAME: e.data.CONS_COL_NAME,\n            APP_ID: e.data.APP_ID,\n            REF_TAB_ID: e.data.REF_TAB_ID,\n            REF_TAB_NAME: e.data.REF_TAB_NAME,\n            REF_TAB_COL: e.data.REF_TAB_COL\n          };\n          insertReferValue.push(json);\n\n        });\n        Wb.request({\n          url: 'm?xwl=xip/tools/model/DATA/fkCreate',\n          params: Wb.apply({\n            array: Wb.encode(insertReferValue)\n          }),\n          success: function() {\n            app.refrenceGrid.store.load();\n          }\n        });\n        Wb.info('{#tools_model_save_table_success#}');\n      },\n      failure: function() {\n        Wb.info('{#tools_model_save_fail#}');\n        app.columnGrid.store.removeAll();\n        app.indexGrid.store.removeAll();\n        app.refrenceGrid.store.removeAll();\n        \n      }\n    });\n  } else {\n    Wb.request({\n      url: 'm?xwl=xip/tools/model/DATA/updateTableObj',\n      params: {\n        'TAB_ID': _tableId,\n        'TAB_COMMENT': _tableDesc\n      },\n      success: function() {\n        /**----------------first delete All then insert-----------------**/\n\n        Wb.request({\n          url: 'm?xwl=xip/tools/model/DATA/deleteTable_l',\n          params: {\n            TAB_ID: _tableId\n          },\n          success: function() {\n             /**----------------columnGrid insert-----------------**/\n            var insertColValue = [];\n            app.columnGrid.store.each(function(e) {\n              var json = {\n                COL_ID: e.data.COL_ID,\n                TAB_ID: e.data.TAB_ID,\n                TAB_NAME: e.data.TAB_NAME,\n                COL_NAME: e.data.COL_NAME,\n                COL_TYPE: e.data.COL_TYPE,\n                COL_LENGTH: e.data.COL_LENGTH,\n                COL_COMMENT: e.data.COL_COMMENT,\n                DEFAULT_VAL: e.data.DEFAULT_VAL,\n                APP_ID: e.data.APP_ID,\n                IS_NULL: e.data.IS_NULL,\n                COL_SEQ: e.data.COL_SEQ\n              };\n              insertColValue.push(json);\n\n            });\n            Wb.request({\n              url: 'm?xwl=xip/tools/model/DATA/columnCreate',\n              params: Wb.apply({\n                array: Wb.encode(insertColValue)\n              }),\n              success: function() {\n                app.columnGrid.store.load();\n              }\n            });\n            /**----------------indexGrid insert-----------------**/\n\n            app.indexGrid.store.each(function(e) {\n              var json = {\n                CONS_ID: e.data.CONS_ID,\n                COL_ID: e.data.COL_ID,\n                INDEX_COL_NAME: e.data.INDEX_COL_NAME,\n                TAB_ID: e.data.TAB_ID,\n                TAB_NAME: e.data.TAB_NAME,\n                INDEX_TYPE: e.data.INDEX_TYPE,\n                INDEX_NAME: e.data.INDEX_NAME,\n                APP_ID: e.data.APP_ID\n              };\n              insertIndexValue.push(json);\n\n            });\n            Wb.request({\n              url: 'm?xwl=xip/tools/model/DATA/indexCreate',\n              params: Wb.apply({\n                array: Wb.encode(insertIndexValue)\n              }),\n              success: function() {\n                app.indexGrid.store.load();\n              }\n            });\n\n           /**----------------refrenceGrid insert-----------------**/\n            var insertReferValue = [];\n            app.refrenceGrid.store.each(function(e) {\n              var json = {\n                CONS_ID: e.data.CONS_ID,\n                COL_ID: e.data.COL_ID,\n                CONS_NAME: e.data.CONS_NAME,\n                TAB_ID: e.data.TAB_ID,\n                TAB_NAME: e.data.TAB_NAME,\n                CONS_TYPE: e.data.CONS_TYPE,\n                CONS_COL_NAME: e.data.CONS_COL_NAME,\n                APP_ID: e.data.APP_ID,\n                REF_TAB_ID: e.data.REF_TAB_ID,\n                REF_TAB_NAME: e.data.REF_TAB_NAME,\n                REF_TAB_COL: e.data.REF_TAB_COL\n              };\n              insertReferValue.push(json);\n\n            });\n            Wb.request({\n              url: 'm?xwl=xip/tools/model/DATA/fkCreate',\n              params: Wb.apply({\n                array: Wb.encode(insertReferValue)\n              }),\n              success: function() {\n                app.refrenceGrid.store.load();\n              }\n            });\n            Wb.info('{#tools_model_save_table_success#}');\n\n          }\n        });\n        \n      },\n      failure: function() {\n        Wb.info('{#tools_model_save_fail#}');\n      }\n    });\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_model_update_to_db#}","itemId":"objUpdate","iconCls":"accept_icon"},"events":{"click":"if(app.operateFlag.getValue() == 'add'){\n  Wb.warn('{#tools_model_save_table_first#}');\n  return ;\n}else{\n  var _paramsJson = {tableName:app.tableName.getValue(),tableId:app.tableId.getValue(),appId:app.appComboBox.getValue()};\n  //updateToDbAjax.request(_paramsJson);\n  Wb.request({\n    url:'{#contextPath#}/xipDataBaseManageAction.do?method=updateDifferIntoDB',\n    params:_paramsJson,\n    success:function(response){\n      var tmpText = Ext.decode(response.responseText);\n      app.scriptShowWin.show();\n      document.getElementById('updateScript').innerHTML = tmpText.msg;\n      app.tableUpdSql.setValue(tmpText.scriptSql);\n    },\n    failure:function(){\n      Wb.error('{#tools_model_create_reverse_fail#}');\n    }\n  });\n  \n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_model_close#}","itemId":"objCancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.objectWindow.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"array"},{"configs":{"itemId":"dbConvertWinBtn"},"children":[{"configs":{"text":"{#tools_model_cover#}","itemId":"convertOverride","iconCls":"write_icon"},"events":{"click":"Wb.confirm('{#tools_model_cover_msg1#}',function(){\n  opType = 'cover';\n  //var tableArry = [];\n  var tableArry = \"\";\n  app.convertSelGrid.store.each(function(obj) {\n    //tableArry.push(obj.get('TABLE_NAME'));\n      tableArry = tableArry + \",\" + obj.get('TABLE_NAME');\n  });\n  tableArry = tableArry.substring(1,tableArry.length);\n  if(tableArry.length>0){\n    var appId = app.appComboBox.getValue();\n    \n    var msg = Ext.MessageBox.show({\n      title \t : \t'{#tools_model_please_wait#}',\n      msg \t : \t'{#tools_model_verifing#}',\n      width \t : \t240,\n      wait\t : \ttrue,\n      progress : \ttrue,\n      closable : \tfalse\n    });\t\n    \n    Ext.Ajax.request({\n      url : '{#contextPath#}' +'/xipDataBaseManageAction.do?method=checkRefTable',\n      method : 'POST',\n      params : {dbObjects:tableArry, opType:opType, appId:appId},\n      success : function(response,options){\n        var temp = response.responseText;\n        var response = Ext.JSON.decode(temp);\n        msg.hide(null,function(){\n          if(response.flag){\n            if(!response.isExistRefTable){\n              Wb.request({\n                url:'{#contextPath#}/xipDataBaseManageAction.do?method=InStoreDbObejctsToXip',\n                params:{\n                     dbObjects : tableArry,\n                     appId     : appId,\n                     opType    : opType\n                },\n                success:function(response){\n                  var tmpText = Ext.decode(response.responseText);\n                  Wb.info(tmpText.msg);\n                },\n                failure:function(){\n                  Wb.error('{#tools_model_create_reverse_fail#}');\n                }\n              });\n            }else{\n              Ext.Msg.confirm('{#tools_model_prompt#}','{#tools_model_prompt_msg1#}',function(btn){\n                if(btn=='yes'){\n                  var refTables = response.refTableNames;\n\n                  var refTableArray = refTables.split(\",\");\n\n                  for(var i=0; i<refTableArray.length; i++){\n                    tableArry = tableArry + \",\" + refTableArray[i];\n                    //tableArry.push(refTableArray[i]);\n                  }\n                 tableArry = tableArry.substring(1,tableArry.length);\n                  Wb.request({\n                    url:'{#contextPath#}/xipDataBaseManageAction.do?method=InStoreDbObejctsToXip',\n                    params:{\n                         dbObjects : tableArry,\n                         appId     : appId,\n                         opType    : opType\n                    },\n                    success:function(response){\n                      var tmpText = Ext.decode(response.responseText);\n                      Wb.info(tmpText.msg);\n                    },\n                    failure:function(){\n                      Wb.error('{#tools_model_create_reverse_fail#}');\n                    }\n                 });\n                }\n              });\n            }\n          }else{\n            Ext.Msg.alert(\"{#tools_model_prompt#}\",response.msg);\n          }\n        });\n      },\n      failure : function(response,options){\n        msg.hide();\n        Ext.Msg.alert(\"{#tools_model_prompt#}\",\"{#tools_model_server_no_repeat_fail#}\");\n      }\n    });\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_model_refresh#}","itemId":"convertUpdate","iconCls":"accept_icon"},"events":{"click":"Wb.confirm('{#tools_model_cover_msg1#}', function() {\n  opType = 'update';\n  //var tableArry = [];\n  var tableArry = \"\";\n  app.convertSelGrid.store.each(function(obj) {\n    //tableArry.push(obj.get('TABLE_NAME'));\n      tableArry = tableArry + \",\" + obj.get('TABLE_NAME');\n  });\n  tableArry = tableArry.substring(1,tableArry.length);\n  if (tableArry.length > 0) {\n    var appId = app.appComboBox.getValue();\n\n    var msg = Ext.MessageBox.show({\n      title: '{#tools_model_please_wait#}',\n      msg: '{#tools_model_verifing#}',\n      width: 240,\n      wait: true,\n      progress: true,\n      closable: false\n    });\n\n    Ext.Ajax.request({\n      url: '{#contextPath#}' + '/xipDataBaseManageAction.do?method=checkRefTable',\n      method: 'POST',\n      params: {\n        dbObjects: tableArry,\n        opType: opType,\n        appId: appId\n      },\n      success: function(response, options) {\n        var temp = response.responseText;\n        var response = Ext.JSON.decode(temp);\n        msg.hide(null, function() {\n          if (response.flag) {\n            if (!response.isExistRefTable) {\n              Wb.request({\n                url: '{#contextPath#}/xipDataBaseManageAction.do?method=InStoreDbObejctsToXip',\n                params: {\n                  dbObjects: tableArry,\n                  appId: appId,\n                  opType: opType\n                },\n                success: function(response) {\n                  var tmpText = Ext.decode(response.responseText);\n                  Wb.info(tmpText.msg);\n                  app.objectGrid.store.load();\n                },\n                failure: function() {\n                  Wb.error('{#tools_model_create_reverse_fail#}');\n                }\n              });\n            } else {\n              Ext.Msg.confirm('{#tools_model_prompt#}', '{#tools_model_prompt_msg1#}', function(btn) {\n                if (btn == 'yes') {\n                  var refTables = response.refTableNames;\n\n                  var refTableArray = refTables.split(\",\");\n\n                  for (var i = 0; i < refTableArray.length; i++) {\n                    tableArry = tableArry + \",\" + refTableArray[i];\n                    //tableArry.push(refTableArray[i]);\n                  }\n                  tableArry = tableArry.substring(1,tableArry.length);\n                  Wb.request({\n                    url: '{#contextPath#}/xipDataBaseManageAction.do?method=InStoreDbObejctsToXip',\n                    params: {\n                      dbObjects: tableArry,\n                      appId: appId,\n                      opType: opType\n                    },\n                    success: function(response) {\n                      var tmpText = Ext.decode(response.responseText);\n                      Wb.info(tmpText.msg);\n                      app.objectGrid.store.load();\n                    },\n                    failure: function() {\n                      Wb.error('{#tools_model_create_reverse_fail#}');\n                    }\n                  });\n                }\n              });\n            }\n          } else {\n            Ext.Msg.alert(\"{#tools_model_prompt#}\", response.msg);\n          }\n        });\n      },\n      failure: function(response, options) {\n        msg.hide();\n        Ext.Msg.alert(\"{#tools_model_prompt#}\", \"{#tools_model_server_no_repeat_fail#}\");\n      }\n    });\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_model_close#}","itemId":"convertCancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.dbConvertWin.close();\napp.convertSelGrid.store.removeAll();"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"array"},{"configs":{"itemId":"dbCompareWinBtn"},"children":[{"configs":{"text":"{#tools_model_different#}","itemId":"compareBtn","iconCls":"write_icon"},"events":{"click":"var sourceSm = app.targetObj.getSelectionModel();\nif(!sourceSm.hasSelection()){\n  Wb.warn('{#tools_model_select_compare#}');\n  app.compareTPanel.setActiveTab(1);\n  return false;\n}\n//Wb.confirm('确定要比对数据库表结构差异？',function(){\n  //use setting params\n  var _contrastConfigs = {'isComparePk':'N','isCompareFk':'N','isCompareIndex':'N','isCreateSql':'N','isUpdateSql':'N','isDeleteSql':'N'};\n  var configIsNull = true;\n  if(app.pkCompare.checked){\n    configIsNull = false;\n    _contrastConfigs.isComparePk = 'Y';\n  }\n  if(app.fkCompare.checked){\n     configIsNull = false;\n    _contrastConfigs.isCompareFk = 'Y';\n  }\n  if(app.indexCompare.checked){\n     configIsNull = false;\n    _contrastConfigs.isCompareIndex = 'Y';\n  }\n  if(app.createSql.checked){\n     configIsNull = false;\n    _contrastConfigs.isCreateSql = 'Y';\n  }\n  if(app.updateSql.checked){\n     configIsNull = false;\n    _contrastConfigs.isUpdateSql = 'Y';\n  }\n  if(app.deleteSql.checked){\n     configIsNull = false;\n    _contrastConfigs.isDeleteSql = 'Y';\n  }\n  var  _rows = sourceSm.getSelection();\n  var _tableNames = \"\";\n  Ext.each(_rows,function(a){\n    //_tableNames.push(a.get('TABLE_NAME'));\n    _tableNames = _tableNames+\",\"+a.get('TABLE_NAME');\n  });\n  var _appId = app.appComboBox.getValue();\n  //contrastConfigs\n  //dbTableNames\n  app.compareRsGrid.store.getProxy().extraParams.appId=_appId;\n  app.compareRsGrid.store.getProxy().extraParams.dbTableNames=_tableNames.substring(1,_tableNames.length);\n  if(!configIsNull){\n    app.compareRsGrid.store.getProxy().extraParams.contrastConfigs=Ext.encode(_contrastConfigs);\n  }\n  app.compareRsGrid.store.load();\n//});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_model_refresh#}","itemId":"compareUpdate","iconCls":"accept_icon"},"events":{"click":"var sm = app.compareRsGrid.getSelectionModel();\nif(!sm.hasSelection()){\n  Wb.warn('{#tools_model_select_execute_demo#}');\n}else{\n  Wb.confirm('{#tools_model_sure_update_to_db#}',function(){\n      var _rows = sm.getSelection();\n      //var _scriptArray = [];\n      var _scriptArray = \"\";\n      Ext.each(_rows,function(a){\n         _scriptArray = _scriptArray + \"&\" + a.get('DIFFER_SQL');\n         //_scriptArray.push(a.get('DIFFER_SQL'));\n      });\n      Wb.request({\n        url:'{#contextPath#}/xipDataBaseManageAction.do?method=executeDifferScript',\n        params:{scriptArray:_scriptArray},\n        success:function(response){\n          var tmpText = Ext.decode(response.responseText);\n          var _batchId = tmpText.msg;\n          app.executeGrid.store.load({params:{'BATCH_ID':_batchId}});\n        }\n      });\n     });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_model_close#}","itemId":"convertCancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.dbCompareWin.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"array"}],"expanded":true,"type":"folder"},{"configs":{"itemId":"wins"},"children":[{"configs":{"title":"{#tools_model_add#}","height":"500","width":"850","layout":"border","closeAction":"hide","buttons":"app.objectWindowBtn","buttonAlign":"center","dialog":"false","itemId":"objectWindow","modal":"true","maximizable":"true"},"events":{"beforeclose":"app.objectForm.getForm().reset();\napp.belongApp.setReadOnly(false);\napp.tableName.setReadOnly(false);\n","close":"app.objectGrid.store.load();"},"children":[{"configs":{"region":"north","height":"70","frame":"true","style":"border-width:0px","layout":"fit","border":"false","itemId":"objectForm"},"children":[{"configs":{"title":"{#tools_model_basic_info#}","style":"padding-top:3px","layout":"column","itemId":"tableInfoSet"},"children":[{"configs":{"itemId":"operateFlag"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"tableId"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"labelWidth":"100","allowBlank":"false","queryMode":"local","displayField":"APP_NAME","width":"230","valueField":"APP_ID","labelAlign":"right","itemId":"belongApp","fieldLabel":"<font color='red'>*<\/font>{#tools_model_belong_app#}"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getApps"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"100","allowBlank":"false","width":"230","labelAlign":"right","itemId":"tableName","fieldLabel":"<font color='red'>*<\/font>{#tools_model_table_name#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"110","width":"230","labelAlign":"right","itemId":"tableDesc","fieldLabel":"{#tools_model_table_desc#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","title":"{#tools_model_detail_info#}","layout":"fit","itemId":"tableDetailSet"},"children":[{"configs":{"border":"false","itemId":"detailInfoTab"},"children":[{"configs":{"title":"{#tools_model_column_info#}","layout":"fit","columnWidth":"1","border":"false","itemId":"columnInfo"},"children":[{"configs":{"pagingBar":"false","multiSelect":"true","selType":"checkboxmodel","itemId":"columnGrid","viewConfig":"{ \n  plugins:{  \n    ptype:'gridviewdragdrop',\n    dragText:'{#tools_model_drop_order#}'\n  },\n  listeners:{\n    drop:function(node, data, dropRec, dropPosition){\n      for(var i=0;i<app.columnGrid.store.getCount();i++){\n          var _dragRecord = app.columnGrid.store.getAt(i);\n          _dragRecord.set(\"COL_SEQ\",i+1);\n      }\n    }\n  }\n} \n\n","editable":"true"},"events":{"itemclick":"editColIndex = index;","tagEvents":"cellclick:function(view, td, cellIndex, record, tr, rowIndex, event, options){\n  if(cellIndex==4){\n    if(record.get('OP_TYPE')=='_added'){\n      return true;\n    }else{\n      return false;\n    }\n  }\n}"},"children":[{"configs":{"proxy":"{\ntype:\"ajax\",\napi: {\nread: 'm?xwl=xip/tools/model/DATA/getColumns',\nupdate: 'm?xwl=xip/tools/model/DATA/columnUpdate',\ncreate: 'm?xwl=xip/tools/model/DATA/columnCreate',\ndestroy: 'm?xwl=xip/tools/model/DATA/columnDestroy'\n},\nreader:{type:\"json\",root:\"rows\",totalProperty:\"total\"},\nlisteners:{\nexception:function(proxy,response,operation,options){\nWb.except(response.responseText);\n}\n}\n}","pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getColumns"},"events":{"beforesync":"Wb.mask();","beforeload":"store.getProxy().extraParams.tableId = app.tableId.getValue();"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_model_add_column#}","itemId":"addColumn","iconCls":"record_add_icon"},"events":{"click":"var _tableName = app.tableName.getValue();\nif(Ext.isEmpty(_tableName)){\n  Wb.warn('{#tools_model_fill_table_name#}');\n  return ;\n}\n\nif(Ext.isEmpty(app.belongApp.getValue())){\n  Wb.warn('{#tools_model_select_app#}');\n  return ;\n}\nvar e = app.columnGrid.plugins[0],index=0;\ne.completeEdit();\nindex = app.columnGrid.store.getCount();\n\nWb.request({\n    url:'m?xwl=xip/tools/model/DATA/getUUid',\n    success:function(response){\n      var temp = response.responseText;\n      var resultJson = Wb.decode(temp);\n      var _colId = resultJson.uuid;\n      var _tableIdVar = app.tableId.getValue();\n      editColIndex = index;\n      app.columnGrid.store.insert(index,{'IS_NULL':'Y','IS_NULL_NAME':'{#tools_model_yes#}','APP_ID':app.appComboBox.getValue(),'COL_SEQ':index+1,'OP_TYPE':'_added'});\n      app.columnGrid.store.getAt(index).set('COL_ID',_colId);\n      app.columnGrid.store.getAt(index).set('TAB_ID',_tableIdVar);\n      app.columnGrid.store.getAt(index).set('TAB_NAME',_tableName);\n      app.columnGrid.store.getAt(index).set('APP_ID',app.belongApp.getValue());\n      e.startEditByPosition({row:index,column:3});\n\n    }\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_model_add_already_column#}","itemId":"addTableColumn","iconCls":"table_add_icon"},"events":{"click":"var _tableName = app.tableName.getValue();\nif(Ext.isEmpty(_tableName)){\n  Wb.warn('{#tools_model_fill_table_name#}');\n  return ;\n}\n\nif(Ext.isEmpty(app.belongApp.getValue())){\n  Wb.warn('{#tools_model_select_app#}');\n  return ;\n}\napp.tableObjectGrid.store.load();\napp.selectTableColumnWin.show();\napp.tableColumnGrid.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_model_delete_column#}","itemId":"delColumn","iconCls":"record_delete_icon"},"events":{"click":"var m = app.columnGrid.getSelectionModel(),s=m.getSelection(),i,j;\nif(s.length===0)return;\napp.columnGrid.plugins[0].completeEdit();\ni = app.columnGrid.store.indexOf(s[0]);\napp.columnGrid.store.remove(s);\nj = app.columnGrid.store.getCount() - 1;\nif (i > j)\n  i = j;\nif (i > -1)\n  m.select(i);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item4"},"children":[],"expanded":false,"type":"item"}],"expanded":false,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"TAB_ID","hidden":"true","dataIndex":"TAB_ID","itemId":"TAB_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"COL_ID","hidden":"true","dataIndex":"COL_ID","itemId":"COL_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#tools_model_column_name#}","width":"130","dataIndex":"COL_NAME","itemId":"COL_NAME_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_column_type#}","hidden":"true","dataIndex":"COL_TYPE","itemId":"COL_TYPE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#tools_model_column_type#}","width":"130","dataIndex":"COL_TYPE_NAME","itemId":"COL_TYPE_NAME_COL"},"children":[{"configs":{"displayField":"VAL_NAME","valueField":"VAL_CODE","itemId":"editor","forceSelection":"true"},"events":{"select":"var e = app.columnGrid.plugins[0];\ne.completeEdit();\napp.columnGrid.store.getAt(editColIndex).set('COL_TYPE',combo.getValue());\napp.columnGrid.store.getAt(editColIndex).set('COL_TYPE_NAME',combo.getRawValue());"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"{#contextPath#}/xipDataBaseManageAction.do?method=readDataTypeMapping"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_column_length#}","width":"120","dataIndex":"COL_LENGTH","itemId":"COL_LENGTH_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_column_desc#}","width":"220","dataIndex":"COL_COMMENT","itemId":"COL_COMMENT_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_is_null#}","hidden":"true","dataIndex":"IS_NULL","itemId":"IS_NULL_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_is_null#}","width":"80","dataIndex":"IS_NULL_NAME","itemId":"IS_NULL_NAME_COL"},"children":[{"configs":{"displayField":"VAL_NAME","valueField":"VAL_CODE","itemId":"editor"},"events":{"select":"var e=app.columnGrid.plugins[0];\ne.completeEdit();\napp.columnGrid.store.getAt(editColIndex).set('IS_NULL',combo.getValue());\napp.columnGrid.store.getAt(editColIndex).set('IS_NULL_NAME',combo.getRawValue());"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getIsNull"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_default_value#}","width":"120","dataIndex":"DEFAULT_VAL","itemId":"DEFAULT_VAL_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_column_order#}","width":"100","dataIndex":"COL_SEQ","itemId":"COL_SEQ_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_app_id#}","hidden":"true","dataIndex":"APP_ID","itemId":"APP_ID_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#tools_model_index_info#}","layout":"fit","columnWidth":"1","border":"false","itemId":"indexInfo"},"children":[{"configs":{"pagingBar":"false","multiSelect":"true","selType":"checkboxmodel","itemId":"indexGrid","editable":"true"},"events":{"itemclick":"editInIndex = index;"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_model_add_index#}","itemId":"addIndex","iconCls":"record_add_icon"},"events":{"click":"var _tableName = app.tableName.getValue();\nif(Ext.isEmpty(_tableName)){\n  Wb.warn('{#tools_model_fill_table_name#}');\n  return ;\n}\n\nif(Ext.isEmpty(app.belongApp.getValue())){\n  Wb.warn('{#tools_model_select_app#}');\n  return ;\n}\n\nvar e = app.indexGrid.plugins[0],iIndex=0;\ne.completeEdit();\niIndex = app.indexGrid.store.getCount();\n\nWb.request({\n    url:'m?xwl=xip/tools/model/DATA/getUUid',\n    success:function(response){\n      var temp = response.responseText;\n      var resultJson = Wb.decode(temp);\n      var _iIndex = resultJson.uuid;\n      editInIndex = iIndex;\n      app.indexGrid.store.insert(iIndex,{});\n      app.indexGrid.store.getAt(iIndex).set('CONS_ID',_iIndex);\n      app.indexGrid.store.getAt(iIndex).set('APP_ID',app.belongApp.getValue());\n      app.indexGrid.store.getAt(iIndex).set('TAB_ID',app.tableId.getValue());\n      app.indexGrid.store.getAt(iIndex).set('TAB_NAME',app.tableName.getValue());\n      e.startEditByPosition({row:iIndex,column:2});\n   }\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_model_delete_index#}","itemId":"delIndex","iconCls":"record_delete_icon"},"events":{"click":"var m = app.indexGrid.getSelectionModel(),s=m.getSelection(),i,j;\nif(s.length===0)return;\napp.indexGrid.plugins[0].completeEdit();\ni = app.indexGrid.store.indexOf(s[0]);\napp.indexGrid.store.remove(s);\nj = app.indexGrid.store.getCount() - 1;\nif (i > j)\n  i = j;\nif (i > -1)\n  m.select(i);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"INDEX_TYPE","hidden":"true","dataIndex":"INDEX_TYPE","itemId":"INDEX_TYPE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#tools_model_index_name#}","width":"220","dataIndex":"INDEX_NAME","itemId":"INDEX_NAME_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#tools_model_index_type#}","width":"160","dataIndex":"INDEX_TYPE_NAME","itemId":"INDEX_TYPE_NAME_COL"},"children":[{"configs":{"displayField":"VAL_NAME","valueField":"VAL_CODE","itemId":"editor"},"events":{"select":"var e = app.indexGrid.plugins[0];\ne.completeEdit();\napp.indexGrid.store.getAt(editInIndex).set('INDEX_TYPE',combo.getValue());\napp.indexGrid.store.getAt(editInIndex).set('INDEX_TYPE_NAME',combo.getRawValue());"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getIndexType"},"events":{"beforeload":"store.getProxy().extraParams.WHERESQL=' AND d.VAL_CODE LIKE \\'%INDEX%\\'';"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"},{"configs":{"text":"INDEX_COL_ID","hidden":"true","dataIndex":"COL_ID","itemId":"INDEX_COL_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#tools_model_index_column#}","width":"120","dataIndex":"INDEX_COL_NAME","itemId":"INDEX_COL_NAME_COL","flex":"1"},"children":[{"configs":{"multiSelect":"true","displayField":"COL_NAME","valueField":"COL_ID","itemId":"editor"},"events":{"collapse":"var e = app.indexGrid.plugins[0];\ne.completeEdit();\napp.indexGrid.store.getAt(editInIndex).set('COL_ID',combo.getValue());\napp.indexGrid.store.getAt(editInIndex).set('INDEX_COL_NAME',combo.getRawValue());"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getColumns"},"events":{"load":"/**---将列页签上所添加的记录动态地append到列选择store中，供索引页签列选取使用-----**/\nstore.add(app.columnGrid.store.getModifiedRecords());","beforeload":"store.getProxy().extraParams.tableId = app.tableId.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"proxy":"{\ntype:\"ajax\",\napi: {\nread: 'm?xwl=xip/tools/model/DATA/indexRead',\nupdate: 'm?xwl=xip/tools/model/DATA/indexUpdate',\ncreate: 'm?xwl=xip/tools/model/DATA/indexCreate',\ndestroy: 'm?xwl=xip/tools/model/DATA/indexDestroy'\n},\nreader:{type:\"json\",root:\"rows\",totalProperty:\"total\"},\nlisteners:{\nexception:function(proxy,response,operation,options){\nWb.except(response.responseText);\n}\n}\n}","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/indexRead"},"events":{"tagEvents":"beforesync:function(){Wb.mask();}","beforeload":"store.getProxy().extraParams.tableId = app.tableId.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#tools_mode_constrain_info#}","layout":"fit","columnWidth":"1","border":"false","itemId":"refrenceInfo"},"children":[{"configs":{"pagingBar":"false","multiSelect":"true","selType":"checkboxmodel","itemId":"refrenceGrid","viewConfig":"{ \n  plugins:{  \n    ptype:'gridviewdragdrop',\n    dragText:'{#tools_model_drop_order#}'\n  },\n  listeners:{\n    drop:function(node, data, dropRec, dropPosition){\n      for(var i=0;i<columnGridStore.getCount();i++){\n          var _dragRecord = columnGridStore.getAt(i);\n          _dragRecord.set(\"COL_SEQ\",i+1);\n      }\n    }\n  }\n} \n\n","editable":"true"},"events":{"itemclick":"editConIndex = index;"},"children":[{"configs":{"proxy":"{\ntype:\"ajax\",\napi: {\nread: 'm?xwl=xip/tools/model/DATA/fkRead',\nupdate: 'm?xwl=xip/tools/model/DATA/fkUpdate',\ncreate: 'm?xwl=xip/tools/model/DATA/fkCreate',\ndestroy: 'm?xwl=xip/tools/model/DATA/fkDestroy'\n},\nreader:{type:\"json\",root:\"rows\",totalProperty:\"total\"},\nlisteners:{\nexception:function(proxy,response,operation,options){\nWb.except(response.responseText);\n}\n}\n}","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/fkRead"},"events":{"tagEvents":"beforesync:function(){Wb.mask();}","beforeload":"store.getProxy().extraParams.tableId = app.tableId.getValue();"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_add_constrain#}","itemId":"addCons","iconCls":"record_add_icon"},"events":{"click":"var _tableName = app.tableName.getValue();\nif(Ext.isEmpty(_tableName)){\n  Wb.warn('{#tools_model_fill_table_name#}');\n  return ;\n}\n\nif(Ext.isEmpty(app.belongApp.getValue())){\n  Wb.warn('{#tools_model_select_app#}');\n  return ;\n}\n\nvar _tableIdVar = app.tableId.getValue();\nvar _appId = app.belongApp.getValue();\nWb.request({\n    url:'m?xwl=xip/tools/model/DATA/getUUid',\n    success:function(response){\n      var temp = response.responseText;\n      var resultJson = Wb.decode(temp);\n      var _indexId = resultJson.uuid;\n      var e= app.refrenceGrid.plugins[0],index=0;\n      e.completeEdit();\n      index = app.refrenceGrid.store.getCount();\n      editConIndex = index;\n      app.refrenceGrid.store.insert(index,{});\n      var _tableIdVar = app.tableId.getValue();\n      app.refrenceGrid.store.getAt(index).set('CONS_ID',_indexId);\n      app.refrenceGrid.store.getAt(index).set('APP_ID',_appId);\n      app.refrenceGrid.store.getAt(index).set('TAB_ID',_tableIdVar);\n      app.refrenceGrid.store.getAt(index).set('TAB_NAME',_tableName);\n      e.startEditByPosition({row:index,column:2});\n\n    }\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_delete_constrain#}","itemId":"delCons","iconCls":"record_delete_icon"},"events":{"click":"var m = app.refrenceGrid.getSelectionModel(),s=m.getSelection(),i,j;\nif(s.length===0)return;\napp.refrenceGrid.plugins[0].completeEdit();\ni = app.refrenceGrid.store.indexOf(s[0]);\napp.refrenceGrid.store.remove(s);\nj = app.refrenceGrid.store.getCount() - 1;\nif (i > j)\n  i = j;\nif (i > -1)\n  m.select(i);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"主键","hidden":"true","dataIndex":"CONS_ID","itemId":"CONS_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_constrain_name#}","width":"240","dataIndex":"CONS_NAME","itemId":"CONS_NAME_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"CONS_TYPE","itemId":"CONS_TYPE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#tools_mode_type#}","width":"150","dataIndex":"CONS_TYPE_NAME","itemId":"CONS_TYPE_NAME_COL"},"children":[{"configs":{"displayField":"VAL_NAME","valueField":"VAL_CODE","itemId":"editor"},"events":{"select":"var e = app.refrenceGrid.plugins[0];\ne.completeEdit();\napp.refrenceGrid.store.getAt(editConIndex).set('CONS_TYPE',combo.getValue());\napp.refrenceGrid.store.getAt(editConIndex).set('CONS_TYPE_NAME',combo.getRawValue());\n"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getIndexType"},"events":{"beforeload":"store.getProxy().extraParams.WHERESQL=' AND d.VAL_CODE LIKE  \\'%KEY%\\'';"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"},{"configs":{"text":"COL_ID","hidden":"true","dataIndex":"COL_ID","itemId":"CONS_COL_ID_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_mode_constrain_column#}","width":"220","dataIndex":"CONS_COL_NAME","itemId":"CONS_COL_NAME_COL"},"children":[{"configs":{"multiSelect":"true","displayField":"COL_NAME","valueField":"COL_ID","itemId":"editor"},"events":{"collapse":"var e = app.refrenceGrid.plugins[0];\ne.completeEdit();\napp.refrenceGrid.store.getAt(editConIndex).set('COL_ID',combo.getValue());\napp.refrenceGrid.store.getAt(editConIndex).set('CONS_COL_NAME',combo.getRawValue());"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getColumns"},"events":{"load":"/**---将列页签上所添加的记录动态地append到列选择store中，供索引页签列选取使用-----**/\nstore.add(app.columnGrid.store.getModifiedRecords());","beforeload":"store.getProxy().extraParams.tableId = app.tableId.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"REF_TAB_ID","itemId":"REF_TAB_ID_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_mode_key_table_name#}","width":"270","dataIndex":"REF_TAB_NAME","itemId":"REF_TAB_NAME_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_mode_key_column_name#}","width":"260","dataIndex":"REF_TAB_COL","itemId":"REF_TAB_COL_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"TAB_ID","hidden":"true","dataIndex":"TAB_ID","itemId":"CONS_TAB_ID_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"应用ID","hidden":"true","dataIndex":"APP_ID","itemId":"CONS_APP_ID_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"window"},{"configs":{"title":"{#tools_mode_please_select_table#}","height":"500","frame":"true","width":"900","layout":"border","closeAction":"hide","buttons":"app.dbConvertWinBtn","buttonAlign":"center","border":"false","dialog":"false","itemId":"dbConvertWin","modal":"true"},"children":[{"configs":{"region":"west","width":"'65%'","layout":"border","columnWidth":"1","itemId":"westPanel"},"children":[{"configs":{"region":"north","frame":"true","height":"'10%'","style":"border-width:0px","layout":"column","bodyPadding":"10px 0px 0px 0px","border":"false","itemId":"convertQueryForm"},"children":[{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"queryTabName","fieldLabel":"{#tools_mode_table_name_1#}"},"events":{"specialkey":"app.convetQuery.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#tools_mode_query#}","itemId":"convetQuery","iconCls":"seek_icon","x":"5"},"events":{"click":"if(!Ext.isEmpty(app.queryTabName.getValue())){\n  queryJson.tableName = app.queryTabName.getValue();\n  app.convertGrid.store.load({params:{'appInfo':Ext.encode(queryJson)}});\n}else{\n   queryJson.tableName = '';\n   app.convertGrid.store.load({params:{'appInfo':Ext.encode(queryJson)}});\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","title":"{#tools_mode_choose_table#}","pagingBar":"false","selType":"checkboxmodel","scroll":"both","itemId":"convertGrid","simpleSelect":"false","viewConfig":"{\n  enableTextSelected:true\n}"},"events":{"itemdblclick":"app.addSel.fireEvent('click');"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"{#contextPath#}/xipDataBaseManageAction.do?method=getAppDBObj"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_table_name#}","width":"160","dataIndex":"TABLE_NAME","itemId":"DB_TABLE_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_table_desc#}","width":"160","dataIndex":"TABLE_COMMENT","itemId":"DB_TABLE_COMMENT_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_mode_create_time#}","width":"90","dataIndex":"CREATE_TIME","itemId":"DB_CREATION_DATE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_mode_create_by#}","width":"80","dataIndex":"CREATED_BY","itemId":"DB_CREATED_BY_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"region":"center","frame":"false","width":"'7%'","layout":"border","columnWidth":"1","split":"true","border":"false","itemId":"centerPanel"},"children":[{"configs":{"region":"south","height":"'30%'","frame":"true","style":"border-width:0px","columnWidth":"1","border":"false","bodyPadding":"padding: 0px 10px 0px","itemId":"cenSouth"},"children":[{"configs":{"text":"<<","width":"40","itemId":"cancelSel","x":"8","tooltip":"{#tools_mode_delete_select_table#}"},"events":{"click":"var _hasRows = app.convertSelGrid.getSelectionModel().getSelection();\napp.convertSelGrid.store.remove(_hasRows);\n\napp.convertSelGrid.getView().refresh();\n\napp.convertSelGrid.setTitle(\"{#tools_mode_already_choose#}\"+\"<font color='red'>\"+app.convertSelGrid.store.getCount()+\"<\/font>\"+\"{#tools_mode_few_table#}\");"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"region":"north","height":"'30%'","frame":"true","style":"border-width:0px","columnWidth":"1","border":"false","itemId":"cenNorth"},"children":[],"expanded":false,"type":"panel"},{"configs":{"region":"center","frame":"true","style":"border-width:0px","layout":"form","columnWidth":"1","border":"false","bodyPadding":"padding: 0px 10px 0px","itemId":"cenCenter"},"children":[{"configs":{"text":">>","width":"40","itemId":"addSel","x":"8","tooltip":"{#tools_mode_add_select_table#}"},"events":{"click":"var _selSm = app.convertGrid.getSelectionModel();\nif(_selSm.hasSelection()){\n  var _hasRows = app.convertSelGrid.getSelectionModel().getSelection();\n  var _selRows = _selSm.getSelection();\n  Ext.each(_selRows,function(item){\n    if(!app.convertSelGrid.store.findRecord('TABLE_NAME',item.get('TABLE_NAME')))\n      //selTableStore.add(item);\n      app.convertSelGrid.store.insert(app.convertSelGrid.store.getCount(),item.data);\n  });\n}\napp.convertSelGrid.getView().refresh();\n_selSm.deselectAll();\n\napp.convertSelGrid.setTitle(\"{#tools_mode_already_choose#}\"+\"<font color='red'>\"+app.convertSelGrid.store.getCount()+\"<\/font>\"+\"{#tools_mode_few_table#}\");"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"region":"east","width":"'28%'","layout":"border","columnWidth":"1","itemId":"eastPanel"},"children":[{"configs":{"region":"center","multiSelect":"true","title":"{#tools_mode_already_choose#}<font color='red'>0<\/font>{#tools_mode_few_table#}","pagingBar":"false","selType":"checkboxmodel","scroll":"both","itemId":"convertSelGrid","simpleSelect":"false","viewConfig":"{\n  enableTextSelected:true\n}"},"children":[{"configs":{"autoLoad":"false","itemId":"store","fields":"[{name:'TABLE_NAME'}]"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_table_name#}","dataIndex":"TABLE_NAME","itemId":"SEL_TABLE_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"SEL_TABLE_ID","hidden":"true","dataIndex":"TABLE_ID","itemId":"SEL_TABLE_ID_COL"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"window"},{"configs":{"title":"{#tools_mode_structure_sync#}","height":"500","width":"850","layout":"fit","closeAction":"hide","buttons":"app.dbCompareWinBtn","buttonAlign":"center","dialog":"false","border":"false","itemId":"dbCompareWin","modal":"true"},"events":{"close":"app.objectGrid.store.load();"},"children":[{"configs":{"frame":"false","border":"false","itemId":"compareTPanel"},"children":[{"configs":{"title":"{#tools_mode_normal#}","frame":"false","layout":"border","border":"false","itemId":"generalPanel"},"children":[{"configs":{"region":"center","frame":"false","border":"false","itemId":"centerPanG"},"children":[],"expanded":true,"type":"panel"},{"configs":{"region":"west","frame":"false","width":"'45%'","layout":"fit","border":"false","itemId":"westPanG"},"children":[{"configs":{"title":"{#tools_mode_compare_choose#}","layout":"form","itemId":"compareSet"},"children":[{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"pkCompare","checked":"true","boxLabel":"{#tools_mode_compare_key#}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"fkCompare","checked":"true","boxLabel":"{#tools_mode_compare_foreign#}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"indexCompare","checked":"true","boxLabel":"{#tools_mode_compare_index#}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"panel"},{"configs":{"region":"east","height":"'45%'","frame":"false","width":"'45%'","layout":"fit","border":"false","itemId":"eastPanG"},"children":[{"configs":{"title":"{#tools_mode_run_select#}","layout":"form","itemId":"runSet"},"children":[{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"createSql","checked":"true","boxLabel":"{#tools_mode_create_sql#}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"updateSql","checked":"true","boxLabel":"{#tools_mode_update_sql#}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"70","labelAlign":"right","itemId":"deleteSql","checked":"true","boxLabel":"{#tools_mode_delete_sql#}l"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#tools_mode_compare_object#}","layout":"fit","columnWidth":"1","border":"false","itemId":"objectPanel"},"children":[{"configs":{"frame":"false","layout":"fit","border":"false","itemId":"objPanel"},"children":[{"configs":{"region":"center","title":"{#tools_mode_db_object#}","pagingBar":"false","multiSelect":"true","selType":"checkboxmodel","itemId":"targetObj","viewConfig":"{enableTextSelection:true}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getDbTables"},"events":{"beforeload":"var whereSql = \" and a.APP_ID='\" + app.appComboBox.getValue()+\"'\";\n\nif(!Ext.isEmpty(app.tableName_targetObjGridToolbar.getValue())){\n  whereSql += \"  and UPPER(a.TAB_NAME) like UPPER('%\"+app.tableName_targetObjGridToolbar.getValue()+\"%')\";\n}\n\nstore.getProxy().extraParams.WHERESQL = whereSql;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"50","width":"200","labelAlign":"right","itemId":"tableName_targetObjGridToolbar","fieldLabel":"{#tools_mode_table_name_1#}"},"events":{"specialkey":"app.targetObj.store.load();"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#tools_mode_query#}","itemId":"searchBtn_targetObjGridToolbar","iconCls":"seek_icon"},"events":{"click":"app.targetObj.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"T_TAB_ID","hidden":"true","dataIndex":"TAB_ID","itemId":"T_TAB_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_table_name#}","width":"220","dataIndex":"TABLE_NAME","itemId":"T_TAB_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#tools_mode_compare_result#}","layout":"border","columnWidth":"1","split":"true","border":"false","itemId":"infoPanel"},"children":[{"configs":{"region":"north","pagingBar":"false","multiSelect":"true","height":"'50%'","selType":"checkboxmodel","itemId":"compareRsGrid"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"{#contextPath#}/xipDataBaseManageAction.do?method=differenceContrast"},"events":{"load":"app.compareTPanel.setActiveTab(2);"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item11"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_export_different_demo#}","itemId":"exportDifferBtn","iconCls":"export_icon"},"events":{"click":"var _scriptSm = app.compareRsGrid.getSelectionModel();\nif(!_scriptSm.hasSelection()){\n  Wb.warn('{#tools_mode_choose_different_demo#}');\n  return false;\n}\nvar _scriptRows = _scriptSm.getSelection();\nvar _srciptSqlArray ='';\nExt.Array.each(_scriptRows,function(a){\n  _srciptSqlArray +=a.data.DIFFER_SQL+'\\n';\n});\nvar _ctx ='{#contextPath#}';\nvar exportForm = document.createElement('form');\nexportForm.setAttribute(\"method\",\"post\");\nexportForm.setAttribute(\"style\",\"'display:none'\");\nexportForm.setAttribute(\"name\",\"postForm\");\nexportForm.setAttribute(\"action\",_ctx+\"/xipDataBaseManageAction.do?method=exportDiffScript\");\nvar input1 = document.createElement('input');\ninput1.setAttribute(\"name\",\"differSql\");\ninput1.setAttribute(\"value\",_srciptSqlArray);\nexportForm.appendChild(input1); \nexportForm.submit();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_different_demo#}","width":"650","dataIndex":"DIFFER_SQL","itemId":"DIFFER_SQL_COL","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:15px;';\nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_different_type#}","width":"80","dataIndex":"SQL_TYPE","itemId":"SQL_TYPE_COL","renderer":"if(value == 'ADD'){\n  return \"<font color='red'>新增<\/font>\";\n}else{\n  return \"<font color='green'>更新<\/font>\";\n}"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"},{"configs":{"region":"center","title":"{#tools_mode_login_info#}","layout":"fit","split":"true","itemId":"logFieldSet"},"children":[{"configs":{"pagingBar":"false","selType":"checkboxmodel","itemId":"executeGrid"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getExeResult"},"events":{"load":"store.each(function(a){\n  var _executeType = a.data.RUN_STATUS;\n  if(_executeType == '1'){\n    var _tmpRecord = app.compareRsGrid.store.findRecord('DIFFER_SQL',a.data.SCRIPT_SQL);\n    app.compareRsGrid.store.remove(_tmpRecord);\n  }\n});"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_different_demo#}","width":"450","dataIndex":"SCRIPT_SQL","itemId":"SCRIPT_SQL_COL","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:15px;';\nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_execute_result#}","width":"80","dataIndex":"RUN_STATUS","itemId":"RUN_STATUS_COL","renderer":"if(value == '0'){\n  return \"<font color='red'>失败<\/font>\";\n}else{\n  return \"<font color='green'>成功<\/font>\";\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_error_info#}","width":"450","dataIndex":"ERROR_MSG","itemId":"ERROR_MSG_COL","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:15px;';\nreturn value;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"tab"}],"expanded":false,"type":"window"},{"configs":{"title":"{#tools_mode_export_demo#}","height":"500","width":"850","layout":"border","closeAction":"hide","dialog":"false","itemId":"exportWindow","modal":"true"},"events":{"show":"app.preScriptBtn.fireEvent('click');\n\n// 定义一个新的复制对象EXT.get()\nvar clip = new ZeroClipboard(document.getElementById(\"d_clip_button\"), {\n  moviePath: \"xip/zeroClipboard/ZeroClipboard.swf\"\n});\n\n//alert(document.getElementById(\"d_clip_button\"));\n\n// 复制内容到剪贴板成功后的操作\nclip.on( 'complete', function(client, args) {\n   //Wb.message(\"已复制至剪切板\");\n  //MsgTip.msg('<font color=\"red\">提示<\/font>', '已复制至剪贴板', true, 1000,\"copy_text\");\n  Wb.toast('<font color=\"red\">'+'{#tools_model_prompt#}'+'<\/font>'+'<br>'+'{#tools_mode_copy_to_cut#}');\n});","close":"app.objectGrid.store.load();"},"children":[{"configs":{"region":"north","height":"'8%'","frame":"true","style":"border-width:0px","layout":"column","html":"<div id=\"d_clip_button_div\" class=\"x-btn x-column x-btn-default-small x-icon-text-left x-btn-icon-text-left x-btn-default-small-icon-text-left\" style=\"border-width: 1px; left: 25px;\">\n  <em id=\"d_clip_button-btnWrap\">\n    <button style=\"height: 16px;\" id=\"d_clip_button\" type=\"button\" class=\"x-btn-center\" hidefocus=\"true\" role=\"button\" autocomplete=\"off\" data-clipboard-target=\"previewScriptDiv\">\n      <span id=\"d_clip_button-btnInnerEl\" class=\"x-btn-inner\" style=\"\">复制到剪贴板<\/span>\n      <span id=\"d_clip_button-btnIconEl\" class=\"x-btn-icon copy_icon\"><\/span>\n    <\/button>\n  <\/em>\n<\/div>","border":"false","bodyPadding":"10px 0px 0xp 0xp","itemId":"exportForm"},"children":[{"configs":{"multiSelect":"false","labelWidth":"90","width":"320","value":"{#dbType#}","pickList":"[['oracle','ORACLE'],['mysql','MYSQL']]","labelAlign":"right","itemId":"dbTypeCombox","forceSelection":"true","fieldLabel":"{#tools_mode_data_type#}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"text":"{#tools_mode_export#}","itemId":"exportBtn","iconCls":"export_icon","x":"5"},"events":{"click":"var _exportType = app.dbTypeCombox.getValue();\nexportParams.exportType = _exportType;\nexportParams.executeType = 'export';\nvar _ctx ='{#contextPath#}';\nWb.download(_ctx+\"/xipDataBaseManageAction.do?method=exportDbScript\",{\"appId\":exportParams.appId,\"tableArray\":exportParams.tableArray,\"exportType\":exportParams.exportType,\"executeType\":exportParams.executeType});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_mode_preview#}","hidden":"true","itemId":"preScriptBtn","iconCls":"preview_icon","x":"10"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_mode_cancel#}","itemId":"exportCancel","iconCls":"cancel_icon","x":"15"},"events":{"click":"app.exportWindow.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"region":"center","title":"{#tools_mode_demo_preview#}","layout":"fit","itemId":"prevSqlFieldset"},"children":[{"configs":{"height":"'100%'","autoScroll":"true","columnWidth":"1","html":"<div id='previewScriptDiv' style=\"width:100%;height:100%;overflow:auto;\"><\/div>","itemId":"panel1"},"children":[],"expanded":false,"type":"panel"},{"configs":{"height":"'100%'","hidden":"true","width":"'100%'","itemId":"perviewScript"},"children":[],"expanded":false,"type":"textarea"}],"expanded":true,"type":"fieldset"}],"expanded":false,"type":"window"},{"configs":{"title":"{#tools_mode_select_application#}","height":"450","width":"600","layout":"border","closeAction":"hide","dialog":"true","itemId":"chooseAppWin"},"events":{"ok":"var _chooseAppSm = app.applicationGrid.getSelectionModel();\nif(!_chooseAppSm.hasSelection()){\n  Wb.warn('{#tools_model_select_app#}');\n  return ;\n}\nvar _chooseAppRows = _chooseAppSm.getSelection();\nvar _chooseAppId = '';\nvar _appIdArray = '';\nfor(var i=0;i<_chooseAppRows.length;i++){\n  if(i !== _chooseAppRows.length-1){\n    _chooseAppId +=\"'\"+_chooseAppRows[i].data.APP_ID+\"',\";\n  }else{\n    _chooseAppId +=\"'\"+_chooseAppRows[i].data.APP_ID+\"'\";\n  }\n  _appIdArray +=_chooseAppRows[i].data.APP_ID+',';\n}\n_appIdArray = _appIdArray.substring(0,_appIdArray.length-1);\nvar _ctx ='{#contextPath#}';\n\nWb.download(_ctx+\"/xipDataBaseInstallAction.do?method=exportDbObj\",{\"appId\":_chooseAppId,\"appArray\":_appIdArray});\n\n"},"children":[{"configs":{"hidden":"true","itemId":"dataExportForm"},"children":[],"expanded":false,"type":"form"},{"configs":{"region":"center","pagingBar":"false","multiSelect":"true","selType":"checkboxmodel","border":"false","itemId":"applicationGrid"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getApps"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_app_code#}","width":"120","dataIndex":"APP_CODE","itemId":"APP_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_app_name#}","width":"150","dataIndex":"APP_NAME","itemId":"CHOOSE_APP_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_app_desc#}","width":"200","dataIndex":"APP_DESC","itemId":"CHOOSE_APP_DESC_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"title":"{#tools_mode_import_model_data#}","height":"100","layout":"fit","width":"500","closeAction":"hide","itemId":"importDbDataWin"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","bodyPadding":"10px 0px 0px 0px","itemId":"dataForm"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"fileSelector","fieldLabel":"{#tools_mode_file_name#}"},"children":[],"expanded":false,"type":"file"},{"configs":{"text":"{#tools_mode_import#}","itemId":"importDataBtn","iconCls":"import_icon","x":"15"},"events":{"click":"if(Ext.isEmpty(app.fileSelector.getValue())){\n  Wb.warn('{#tools_mode_please_upload_file#}');\n}else{\n  var _ctx ='{#contextPath#}';\n  app.dataForm.getForm().submit({\n    url : _ctx+\"/xipDataBaseInstallAction.do?method=loadDataToDbModel\",\n    waitTitle: '{#tools_model_prompt#}', //标题\n    waitMsg: '{#tools_model_wait#}', //提示信息    \n    method : 'POST',\t\t\t\t\t\t\t\n    success : function(form, action, value) {\n      Ext.Msg.alert('{#tools_model_prompt#}','{#tools_mode_import_success#}');\n      app.importDbDataWin.close();\n    },\t\t\t\t\t\t\t\n    failure : function(form, action, value) {\n      Ext.Msg.alert('{#tools_model_prompt#}',action.result.msg);\n  }\t\t\t\t\t\t\n});\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"}],"expanded":false,"type":"window"},{"configs":{"title":"{#tools_model_add_already_column#}","height":"500","width":"800","layout":"border","closeAction":"hide","dialog":"true","itemId":"selectTableColumnWin"},"events":{"ok":"var _dbSm = app.tableColumnGrid.getSelectionModel();\nvar _dbRows = _dbSm.getSelection();\nif(_dbRows.length === 0){\n  Wb.warn('{#tools_mode_please_add_record#}');\n  return;\n}\n\nvar e = app.columnGrid.plugins[0],index=0;\ne.completeEdit();\n\nvar _tableIdVar = app.tableId.getValue();\nvar _tableNameVar = app.tableName.getValue();\n\nfor(var i=0; i<_dbRows.length; i++){\n  var jsonDate = _dbRows[i].data;\n  \n  var index = app.columnGrid.store.getCount();\n  \n  app.columnGrid.store.insert(index,jsonDate);\n//   Wb.request({\n//     url:'m?xwl=xip/tools/model/DATA/getUUid',\n//     success:function(response){\n//       var temp = response.responseText;\n//       var resultJson = Wb.decode(temp);\n//       app.columnGrid.store.getAt(index).set('COL_ID',resultJson.uuid);\n      \n\n//     }\n// });\n      app.columnGrid.store.getAt(index).set('COL_ID',Xip.getId());\n      app.columnGrid.store.getAt(index).set('TAB_ID',_tableIdVar);\n      app.columnGrid.store.getAt(index).set('TAB_NAME',_tableNameVar);\n      app.columnGrid.store.getAt(index).set('APP_ID',app.belongApp.getValue());\n      app.columnGrid.store.getAt(index).set('OP_TYPE','_added');\n      app.columnGrid.store.getAt(index).set('COL_SEQ',index+1);\n\n  \n}\n\napp.selectTableColumnWin.hide();"},"children":[{"configs":{"region":"west","title":"{#tools_mode_table#}","width":"300","itemId":"tableObjectGrid"},"events":{"itemclick":"var tableId = record.get('TAB_ID');\napp.tableColumnGrid.store.load({params:{'tableId':tableId}});"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getDbTables"},"events":{"beforeload":"var whereSql = \" and a.APP_ID='\"+app.appComboBox.getValue()+\"'\";\n\nif(!Ext.isEmpty(app.tableName_tableObjectGrid.getValue())){\n  whereSql += \"  and UPPER(a.TAB_NAME) like UPPER('%\"+app.tableName_tableObjectGrid.getValue()+\"%')\";\n}\n\nstore.getProxy().extraParams.WHERESQL = whereSql;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"50","width":"200","labelAlign":"right","itemId":"tableName_tableObjectGrid","fieldLabel":"{#tools_mode_table_name_1#}"},"events":{"specialkey":"if(e.getKey()===13){\n app.tableObjectGrid.store.load();\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#tools_mode_query#}","itemId":"searchBtn","iconCls":"seek_icon"},"events":{"click":"app.tableObjectGrid.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_table_name#}","width":"220","dataIndex":"TABLE_NAME","itemId":"TABLE_NAME_tableObject"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_table_desc#}","width":"320","dataIndex":"TABLE_COMMENT","itemId":"TABLE_COMMENT_tableObject"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_app_name#}","width":"240","dataIndex":"APP_NAME","itemId":"APP_NAME_tableObject"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_create_time#}","width":"120","dataIndex":"CREATION_DATE","itemId":"CREATION_DATE_tableObject"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_create_by#}","width":"80","dataIndex":"CREATED_BY_NAME","itemId":"CREATED_BY_NAME_tableObject"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_app_id#}","hidden":"true","dataIndex":"TABLE_ID","itemId":"TABLE_ID_tableObject"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"},{"configs":{"region":"center","title":"表列","multiSelect":"true","selType":"checkboxmodel","itemId":"tableColumnGrid","simpleSelect":"true"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getColumns"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"TAB_ID","hidden":"true","dataIndex":"TAB_ID","itemId":"TAB_ID_tableColumn"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"COL_ID","hidden":"true","dataIndex":"COL_ID","itemId":"COL_ID_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>列名","width":"130","dataIndex":"COL_NAME","itemId":"COL_NAME_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"创建时间","hidden":"true","width":"120","dataIndex":"COL_TYPE","itemId":"COL_TYPE_tableColumn"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>列类型","width":"130","dataIndex":"COL_TYPE_NAME","itemId":"COL_TYPE_NAME_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"列长度","width":"120","dataIndex":"COL_LENGTH","itemId":"COL_LENGTH_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"列描述","width":"220","dataIndex":"COL_COMMENT","itemId":"COL_COMMENT_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"默认值","width":"150","dataIndex":"DEFAULT_VAL","itemId":"DEFAULT_VAL_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"IS_NULL","itemId":"IS_NULL_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"是否可空","width":"150","dataIndex":"IS_NULL_NAME","itemId":"IS_NULL_NAME_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"列排序","width":"130","dataIndex":"COL_SEQ","itemId":"COL_SEQ_tableColumn"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"APP_ID","hidden":"true","dataIndex":"APP_ID","itemId":"APP_ID_tableColumn"},"children":[],"expanded":true,"type":"column"}],"expanded":false,"type":"array"}],"expanded":false,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"title":"{#tools_mode_refresh_preview#}","height":"450","width":"600","layout":"border","closeAction":"hide","dialog":"true","itemId":"scriptShowWin"},"events":{"ok":"var _scriptSql = app.tableUpdSql.getValue();\nif(Ext.isEmpty(_scriptSql)){\n  Wb.warn('{#tools_mode_no_different_demo_create#}');\n}else{\n // var _sqlArray = _scriptSql.split('&');\n//    updateModifyToDb.params.scriptArray = _sqlArray;\n//    updateModifyToDb.params.tableOperate = 'Y';\n//    updateModifyToDb.request();\n   Wb.request({\n      url:'{#contextPath#}/xipDataBaseManageAction.do?method=executeDifferScript',\n      params:{scriptArray:_scriptSql,tableOperate:'Y'},\n      success:function(response){\n       var tmpText = Ext.decode(response.responseText);\n       if(tmpText.flag ==='0'){\n         Wb.warn(tmpText.msg);\n       }else{\n         Wb.info('{#tools_mode_execute_update_success#}');\n         app.scriptShowWin.close();\n       }\n      },\n      failure:function(){\n        Wb.error('{#tools_mode_execute_update_fail#}');\n      }\n    });\n}","close":"document.getElementById('updateScript').innerHTML = '';"},"children":[{"configs":{"region":"center","title":"{#tools_mode_demo_preview#}","layout":"fit","itemId":"fieldset1"},"children":[{"configs":{"height":"'100%'","autoScroll":"true","columnWidth":"1","html":"<div id='updateScript' style=\"width:100%;height:100%;overflow:auto;\">\n  \n<\/div>","itemId":"panel1"},"children":[{"configs":{"itemId":"tableUpdSql"},"children":[],"expanded":false,"type":"hidden"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"}],"expanded":false,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","frame":"true","height":"80","style":"border-width:0px","layout":"fit","split":"true","border":"false","itemId":"conditionForm"},"children":[{"configs":{"title":"{#tools_mode_query_condition#}","style":"padding-top:8px;","layout":"column","itemId":"querySet"},"children":[{"configs":{"labelWidth":"100","queryMode":"local","displayField":"APP_NAME","valueField":"APP_ID","labelAlign":"right","itemId":"appComboBox","forceSelection":"true","fieldLabel":"{#tools_mode_application#}"},"events":{"select":"app.objectGrid.store.load();"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getApps"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"objectName","fieldLabel":"{#tools_model_table_name#}"},"events":{"specialkey":"app.objectGrid.store.load();"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"110","labelAlign":"right","itemId":"objDesc","fieldLabel":"{#tools_model_table_desc#}"},"events":{"specialkey":"app.objectGrid.store.load();"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#tools_mode_query#}","itemId":"queryBtn","iconCls":"seek_icon","x":"5"},"events":{"click":"app.objectGrid.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#tools_mode_reset#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"10"},"events":{"click":"Wb.reset(app.conditionForm);\napp.objectGrid.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"objectGrid"},"events":{"itemdblclick":"app.editObject.fireEvent('click');"},"children":[{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"store","url":"m?xwl=xip/tools/model/DATA/getDbTables"},"events":{"beforeload":"var whereSql = \" and a.APP_ID='\" + app.appComboBox.getValue()+\"'\";\nif(!Ext.isEmpty(app.objectName.getValue())){\n  whereSql +=\"  and a.TAB_NAME like '%\"+app.objectName.getValue()+\"%'\";\n}\nif(!Ext.isEmpty(app.objDesc.getValue())){\n  whereSql +=\"  and a.TAB_COMMENT like '%\"+app.objDesc.getValue()+\"%'\";\n}\nstore.getProxy().extraParams.WHERESQL = whereSql;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_add_table#}","itemId":"addObject","iconCls":"table_add_icon"},"events":{"click":"Wb.request({\n    url:'m?xwl=xip/tools/model/DATA/getUUid',\n    success:function(response){\n      var temp = response.responseText;\n      var resultJson = Wb.decode(temp);\n      var _tableId = resultJson.uuid;\n      var win = new Ext.window.Window(app._objectWindow);\n      win.setTitle('{#tools_mode_add_object#}');\n      win.show();\n      app.belongApp.setValue(app.appComboBox.getValue());\n      app.operateFlag.setValue('add');\n      app.tableId.setValue(_tableId);\n      app.columnGrid.store.load();\n    }\n});\n      \n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_model_edit_object#}","itemId":"editObject","iconCls":"table_edit_icon"},"events":{"click":"var _dbSm = app.objectGrid.getSelectionModel();\nvar _dbRows = _dbSm.getSelection();\nif(_dbRows.length != 1){\n  Wb.warn('{#tools_mode_please_select_record#}');\n}else{\n  var _dbRecord = _dbRows[0];\n  app.tableId.setValue(_dbRecord.get('TAB_ID'));\n  app.tableName.setValue(_dbRecord.get('TABLE_NAME'));\n  app.tableDesc.setValue(_dbRecord.get('TABLE_COMMENT'));\n  app.belongApp.setValue(_dbRecord.get('APP_ID'));\n  app.belongApp.setReadOnly(true);\n  app.tableName.setReadOnly(true);\n  app.operateFlag.setValue('edit');\n  app.columnGrid.store.load();\n  app.indexGrid.store.load();\n  app.refrenceGrid.store.load();\n  app.objectWindow.setTitle('{#tools_mode_edit_table#}');\n  app.objectWindow.show();\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_delete_table#}","itemId":"deleteObject","iconCls":"table_delete_icon"},"events":{"click":"var sm = app.objectGrid.getSelectionModel();\nif(!sm.hasSelection()){\n   Wb.warn('{#tools_mode_choose_select_delete_record#}');\n}else{\n  Wb.confirm('{#tools_mode_sure_delete_table#}',function(btn){\n        var rows = sm.getSelection();\n        var _delTabIds = '';\n        Ext.each(rows,function(a){\n          _delTabIds +='\\''+a.get('TAB_ID')+'\\',';\n        });\n        _delTabIds = _delTabIds.substring(0,_delTabIds.length-1);\n        Wb.request({\n          url:'m?xwl=xip/tools/model/DATA/delTableObj',\n          params:{'ids':_delTabIds},\n          success:function(){\n            Wb.info('{#tools_mode_delete_success#}');\n            app.objectGrid.store.load();\n          }\n        });\n    \n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item4"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_export_table_demo#}","itemId":"exportObject","iconCls":"export_icon"},"events":{"click":"var sm = app.objectGrid.getSelectionModel();\nvar _appName = app.appComboBox.getRawValue();\nvar _appId = app.appComboBox.getValue();\nif(Ext.isEmpty(_appId)){\n  Wb.warn('{#tools_mode_choose_app_first#}');\n  return ;\n}\nif(!sm.hasSelection()){\n  Wb.confirm('{#tools_mode_sure_export#}'+_appName+'{#tools_mode_all_table_demo#}',function(){\n    exportParams = {appId:_appId,executeType:'',exportType:''};\n    app.exportWindow.show();\n  });\n}else{\n   var rows = sm.getSelection();\n   var _selTableId = \"\";\n   Ext.each(rows,function(a){\n          _selTableId +=a.get('TAB_ID')+\",\"; \n        });\n    _selTableId = _selTableId.substring(0,_selTableId.length-1);\n    exportParams = {appId:_appId,tableArray:_selTableId,executeType:'',exportType:''};   \n         app.exportWindow.show();\n}\nif(document.getElementById('previewScriptDiv')){\n  document.getElementById('previewScriptDiv').innerHTML='';\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item5"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_reverse_create_table#}","itemId":"convertObject","iconCls":"store_icon"},"events":{"click":"if(Ext.isEmpty(app.appComboBox.getValue())){\n  Wb.warn('{#tools_mode_choose_create_reverse_project#}');\n  return false;\n}\nvar selRecord = app.appComboBox.findRecord('APP_ID',app.appComboBox.getValue());\nif(!Ext.isEmpty(selRecord)){\n  var appJsonObj ={\n    'appId'  :selRecord.data.APP_ID,\n    'appName':selRecord.data.APP_NAME,\n    'dbUrl'  :selRecord.data.DB_URL,\n    'isInner':selRecord.data.IN_XIP,\n    'dbType' :selRecord.data.DB_TYPE,\n    'dbUserName' :selRecord.data.DB_USER,\n    'dbPassword' :selRecord.data.DB_PASSWORD,\n    'tableName':''\n  };\n  queryJson = appJsonObj;\n  var win = new Ext.window.Window(app._dbConvertWin);\n  win.show();\n  app.convertGrid.store.load({params:{'appInfo':Ext.encode(appJsonObj)}});\n  \n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item6"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_different_compare#}","itemId":"differeCompare","iconCls":"product_icon"},"events":{"click":"if(Ext.isEmpty(app.appComboBox.getValue())){\n  Wb.warn('{#tools_mode_choose_app_first#}');\n  return false;\n}else{\n  app.targetObj.store.load();\n   var win = new Ext.window.Window(app._dbCompareWin);\n   win.show();\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item7"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_export_data_model#}","itemId":"exportDataObj","iconCls":"db_export_icon"},"events":{"click":"app.applicationGrid.store.load();\napp.chooseAppWin.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item8"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_import_data_model#}","itemId":"importDbData","iconCls":"db_import_icon"},"events":{"click":"app.importDbDataWin.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item9"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#tools_mode_update_to_data_dictionary#}","itemId":"updateToDict","iconCls":"accept_icon"},"events":{"click":"var _dbSm = app.objectGrid.getSelectionModel();\nvar _appId = app.appComboBox.getValue();\nif(!_dbSm.hasSelection()){\n  Wb.warn('{#tools_mode_update_table_record#}');\n}else if(Ext.isEmpty(_appId)){\n  Wb.warn('{#tools_mode_choose_app_first#}');\n}else{\n  var _dbRows = _dbSm.getSelection();\n  var _tableNames = '';\n  Ext.Array.each(_dbRows,function(a){\n    _tableNames +=\"'\"+a.data.TABLE_NAME+\"',\";\n  });\n  _tableNames = _tableNames.substring(0,_tableNames.length-1);\n  Wb.request({\n    url:'{#contextPath#}/xipDataBaseInstallAction.do?method=insertTableIntoWbDict',\n    params:{\n            appId     : _appId,\n            tableNames: _tableNames\n            },\n    success:function(response){\n      var tmpText = Ext.decode(response.responseText);\n      Wb.info(tmpText.msg);\n    },\n    failure:function(){\n      Wb.error('{#tools_mode_execute_update_fail#}');\n    }\n  });\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item10"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_app_name#}","width":"240","dataIndex":"APP_NAME","itemId":"APP_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_model_table_name#}","width":"220","dataIndex":"TABLE_NAME","itemId":"TABLE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_model_table_desc#}","width":"320","dataIndex":"TABLE_COMMENT","itemId":"TABLE_COMMENT_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#tools_mode_create_time#}","width":"120","dataIndex":"CREATION_DATE","itemId":"CREATION_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#tools_mode_create_by#}","width":"100","dataIndex":"CREATED_BY_NAME","itemId":"CREATED_BY_NAME_COL"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}