{"inframe":false,"title":"数据导入","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var contextPath = request.getContextPath();\n\nvar templateCode = request.getParameter(\"templateCode\");\n\nvar url = contextPath + '/templateManageAction.do?method=importExcel&templateCode=' + templateCode;\nrequest.setAttribute('url',url);\nrequest.setAttribute('templateCode',templateCode);\nrequest.setAttribute('contextPath',contextPath);","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/tools/io/json/dataImport\");","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"50","frame":"true","style":"border-width:0px","width":"400","layout":"column","bodyPadding":"12 0 0 20","itemId":"importForm"},"children":[{"configs":{"labelWidth":"80","width":"350","labelAlign":"left","itemId":"fileName","fieldLabel":"{#xip_tools_dataImport_fileName#}"},"children":[],"expanded":false,"type":"file"},{"configs":{"text":"{#xip_tools_dataImport_submmit#}","itemId":"submmit","iconCls":"import_icon","x":"10"},"events":{"click":"if(app.fileName.getValue()===\"\"){\n  Ext.Msg.alert('{#xip_tools_dataImport_tip#}','{#xip_tools_dataImport_fileName#}!');\n  return;\n}\napp.importForm.getForm().submit({\n  url : '{#url#}',\n  timeout : 3600*1000,\n  waitTitle: '{#xip_tools_dataImport_tip#}', //标题\n  waitMsg: '{#xip_tools_dataImport_wati#}', //提示信息    \n  success : function(from,action) {\n    var resultJson = Wb.decode(action.response.responseText);\n    if(resultJson.tagColumnId){\n      app.logGrid.store.getProxy().extraParams.tagId = resultJson.tagColumnId;\n      app.logGrid.store.load();\n    }\n  },\t\t\t\t\t\t\t\n  failure : function(from,action) {\n    var resultJson = Wb.decode(action.response.responseText);\n    if(resultJson.tagColumnId){\n      app.logGrid.store.getProxy().extraParams.tagId = resultJson.tagColumnId;\n      app.logGrid.store.load();\n    }\n    //Ext.Msg.alert('提示',resultJson.msg);\n  }\t\t\t\t\t\t\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_tools_dataImport_reset#}","itemId":"reset","iconCls":"refresh_icon","x":"20"},"events":{"click":"Wb.reset(app.fileName);\napp.logGrid.store.removeAll();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"logGrid","simpleSelect":"false","editable":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/io/DATA/getLogs"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"xtype":"rownumberer","align":"center","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_tools_dataImport_CREATION_DATE#}","width":"120","dataIndex":"CREATION_DATE","itemId":"CREATION_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_tools_dataImport_MSG#}","dataIndex":"MSG","itemId":"MSG","flex":"1"},"children":[{"configs":{"height":"200","itemId":"editor"},"children":[],"expanded":false,"type":"textarea"}],"expanded":true,"type":"column"},{"configs":{"text":"LOG_ID","hidden":"true","dataIndex":"LOG_ID","itemId":"LOG_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"TAG_ID","hidden":"true","dataIndex":"TAG_ID","itemId":"TAG_ID"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}