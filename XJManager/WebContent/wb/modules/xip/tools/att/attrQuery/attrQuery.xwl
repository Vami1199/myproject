{"inframe":false,"title":"附件查询","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var userId = request.getSession().getAttribute(\"XzSessionVars\").get('userId');\nvar userName = request.getSession().getAttribute(\"XzSessionVars\").get('userName');\nvar empName = request.getSession().getAttribute(\"XzSessionVars\").get('empName');\n\nvar authModel = request.getSession().getAttribute(\"XzSessionVars\").get('AUTH_MODAL');\nvar roleId = request.getSession().getAttribute(\"XzSessionVars\").get('roleId');\nvar roleName = request.getSession().getAttribute(\"XzSessionVars\").get('roleName');\nvar roleCode = request.getSession().getAttribute(\"XzSessionVars\").get('roleCode');\n\nvar ctxPath = request.getContextPath() ;\n\nrequest.setAttribute(\"userId\",userId);\nrequest.setAttribute(\"userName\",userName);\nrequest.setAttribute(\"empName\",empName);\n\nrequest.setAttribute(\"authModel\",authModel);\nrequest.setAttribute(\"roleId\",roleId);\nrequest.setAttribute(\"roleName\",roleName);\nrequest.setAttribute(\"roleCode\",roleCode);\n\nrequest.setAttribute(\"contextPath\",ctxPath);\n\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","loginRequired":"false","serverScript":"//三方语言,引入对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xip/tools/att/attrQuery/json/attrQuery');","itemId":"module"},"children":[{"configs":{"itemId":"Gcolumns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"ATT_ID","itemId":"COLUMN_ATT_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_enclosure_name#}","width":"260","dataIndex":"ATT_FILE_NAME","itemId":"COLUMN_ATT_FILE_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_file_size#}","align":"right","width":"120","dataIndex":"FILE_SIZE","itemId":"COLUMN_FILE_SIZE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_type#}","width":"120","dataIndex":"CAT_NAME","itemId":"COLUMN_CAT_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_server#}","width":"150","dataIndex":"SERVER_NAME","itemId":"COLUMN_SERVER_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_business_code#}","width":"120","dataIndex":"BUS_NO","itemId":"COLUMN_BUS_NO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_upload_date#}","width":"120","dataIndex":"CREATION_DATE","itemId":"COLUMN_CREATION_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#att_attrQuery_preview#}","align":"center","width":"80","itemId":"column_view","renderer":"var returnValue = '';\nvar imgUrl = '{#contextPath#}' + '/xip/images/owc_view.bmp';\nreturnValue = \"<img src='\"+imgUrl+\"' style='width:12px;height:12px'/>\"; \nreturn returnValue;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"layout":"border","itemId":"viewport"},"children":[{"configs":{"region":"north","height":"120","frame":"true","style":"border-width:0px","layout":"fit","itemId":"queryform","border":"false"},"children":[{"configs":{"title":"{#att_attrQuery_queryCon#}","collapsible":"true","layout":"form","itemId":"fieldset1"},"children":[{"configs":{"height":"38","frame":"true","style":"border-width:0px","bodyCls":"border-style:none","layout":"column","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"80","displayField":"NAME","queryMode":"local","width":"180","valueField":"ID","labelAlign":"right","itemId":"attrTypeCombox","forceSelection":"true","fieldLabel":"{#att_attrQuery_enclosure_type#}"},"events":{"select":"app.btn_query.fireEvent('click');\n","specialkey":"app.btn_query.fireEvent('click');"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/att/attrQuery/data/getAttrTypes"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"90","displayField":"NAME","queryMode":"local","width":"180","valueField":"ID","labelAlign":"right","itemId":"attrServiceCombox","forceSelection":"true","fieldLabel":"{#att_attrQuery_enclosure_server#}"},"events":{"select":"app.btn_query.fireEvent('click');","specialkey":"app.btn_query.fireEvent('click');"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/tools/att/attrQuery/data/getAttrServers"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"80","width":"190","labelAlign":"right","itemId":"uploadFromDate","fieldLabel":"{#att_attrQuery_upload_date#}"},"events":{"specialkey":"btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"date"},{"configs":{"text":"-","width":"20","labelAlign":"center","itemId":"label1"},"children":[],"expanded":false,"type":"label"},{"configs":{"labelWidth":"0","width":"100","labelAlign":"right","itemId":"uploadToDate"},"events":{"select":"var _tmpDate = app.uploadFromDate.getValue();\nif(!Ext.isEmpty(_tmpDate) && _tmpDate >value){\n  Wb.warn('{#att_attrQuery_endDate_startDate#}');\n  app.uploadToDate.setValue('');\n  return false;\n}","specialkey":"app.btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"date"},{"configs":{"text":"{#att_attrQuery_query#}","width":"60","itemId":"btn_query","iconCls":"seek_icon","x":"10"},"events":{"click":" \nvar sdate = Ext.util.Format.date(app.uploadFromDate.getValue(), 'Y-m-d');\nvar edate = Ext.util.Format.date(app.uploadToDate.getValue(), 'Y-m-d');\n\nvar  json ={\n  attrType:app.attrTypeCombox.getValue(),\n  attrServer:app.attrServiceCombox.getValue(),\n  attrName:app.attrName.getValue(),\n  businessCode:app.businessCode.getValue(),\n  startDate:sdate,\n  endDate:edate,\n  minSize:app.fileSizeFrom.getValue(),\n  maxSize:app.fileSizeTo.getValue()\n};\n\n\napp.grid.store.load( {  params: json });"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"height":"38","frame":"true","style":"border-width:0px","bodyCls":"border-style:none","layout":"column","border":"false","itemId":"panel2"},"children":[{"configs":{"labelWidth":"80","width":"180","labelAlign":"right","itemId":"attrName","fieldLabel":"{#att_attrQuery_enclosure_name1#}"},"events":{"specialkey":"app.btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"90","width":"180","labelAlign":"right","itemId":"businessCode","fieldLabel":"{#att_attrQuery_business_code#}"},"events":{"specialkey":"app.btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","width":"190","minValue":"0","labelAlign":"right","itemId":"fileSizeFrom","fieldLabel":"{#att_attrQuery_file_size#}"},"events":{"specialkey":"app.btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"number"},{"configs":{"text":"-","width":"20","labelAlign":"center","itemId":"label11"},"children":[],"expanded":false,"type":"label"},{"configs":{"width":"100","minValue":"1","itemId":"fileSizeTo"},"events":{"specialkey":"app.btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"number"},{"configs":{"text":"{#att_attrQuery_reset#}","width":"60","itemId":"btn_reset","iconCls":"refresh_icon","x":"10"},"events":{"click":"app.queryform.getForm().reset();\napp.btn_query.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","selType":"checkboxmodel","columns":"app.Gcolumns","itemId":"grid"},"events":{"tagEvents":"cellclick :function (Table ,  td,  cellIndex, record,  tr,  rowIndex, e,  eOpts ){\n\nif(cellIndex==9){\n  var id = record.data.ATT_ID;\n  window.open ('{#contextPath#}'+\"/xipAttMrgAction.do?method=down&view=1&att_id=\"+id.toString(),'newwindow','height=768,width=1024,top=0,left=0,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no');\n}\n}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xip/tools/att/attrQuery/data/getAttrs"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#att_attrQuery_delete#}","itemId":"deleteBtn","iconCls":"application_delete_icon"},"events":{"click":"\n\nvar rows = app.grid.getSelectionModel().getSelection();\nif(rows.length===0){\n  Ext.Msg.alert('{#att_attrQuery_prompt#}','{#att_attrQuery_prompt_msg1#}');\n}else{\n  \n  \n  Ext.Msg.confirm('{#att_attrQuery_prompt#}','{#att_attrQuery_prompt_msg2#}',function(a){\n  \n   if(a=='yes'){\n    var p = [];\n  for(var i=0; i<rows.length; i++){\n    var id = rows[i].data.ATT_ID;\n    p.push(id);\n  }\n\n  Ext.Msg.wait('{#att_attrQuery_in_delete#}');\n  Ext.Ajax.request({\n    url : '{#contextPath#}'+ '/xipAttMrgAction.do?method=del',\n    method: 'POST',\n    timeout: 6000000,\n    params:{ids : p.toString()},\n    success: function(response,options){\n      Ext.Msg.hide();\n      var json = Ext.JSON.decode(response.responseText);\n      Ext.Msg.alert('',json.msg,function(){\n        \n        app.btn_query.fireEvent('click');\n      });\n    },\n    failure: function(response,options){\n      Ext.Msg.alert('{#att_attrQuery_prompt#}','{#att_attrQuery_prompt_msg3#}');\n    }\n  });\n   \n   }\n  });\n\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item31"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#att_attrQuery_download#}","itemId":"downBtn","iconCls":"module_icon"},"events":{"click":"var rows = app.grid.getSelectionModel().getSelection();\nif(rows.length===0){\n  Ext.Msg.alert('{#att_attrQuery_prompt#}','{#att_attrQuery_prompt_msg4#}');\n}else{\n  var p = [];\n  for(var i=0; i<rows.length; i++){\n    var id = rows[i].data.ATT_ID;\n    p.push(id);\n  }\n  window.location.href= \"{#contextPath#}\"+\"/xipAttMrgAction.do?method=down&selectedIds=\"+p.toString();\t\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}