{"inframe":true,"title":"修改面","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"修改密码","initScript":"var pwdLenLimit= com.xzsoft.xip.platform.util.PlatformUtil.getSystemParamVal(\"PW_LEN_LIMIT\");\nvar pwdIncludeChar =  com.xzsoft.xip.platform.util.PlatformUtil.getSystemParamVal(\"PW_INCLUDE_CHAR\");\nrequest.setAttribute(\"PW_LEN_LIMIT\",pwdLenLimit);\nrequest.setAttribute(\"PW_INCLUDE_CHAR\",pwdIncludeChar);","loadJS":"touch","itemId":"xip.chgPwd"},"children":[{"configs":{"itemId":"viewport1"},"children":[{"configs":{"itemId":"container1"},"children":[{"configs":{"itemId":"tfs_chgpwd"},"children":[{"configs":{"xtype":"passwordfield","label":"原密码：","itemId":"oldPwd"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"xtype":"passwordfield","label":"新密码：","itemId":"newPwd"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"xtype":"passwordfield","label":"确认密码：","itemId":"secondPwd"},"children":[],"expanded":false,"type":"ttext"}],"expanded":true,"type":"tfieldset"},{"configs":{"docked":"bottom","itemId":"toolbar1"},"children":[{"configs":{"text":"确定","glyph":"f00c","itemId":"tb_ok"},"events":{"tap":"var pwdLengthLimit ='{#PW_LEN_LIMIT#}';\nvar pwdIncludeChar ='{#PW_INCLUDE_CHAR#}';\nif(app.oldPwd.getValue()===\"\"){\n  app.tfs_chgpwd.setInstructions('原密码不能为空');\n  app.oldPwd.focus();\n  return;\n}\nif(app.newPwd.getValue()===\"\"){\n  app.tfs_chgpwd.setInstructions('新密码不能为空');\n  app.newPwd.focus();\n  return;\n}\nif(app.secondPwd.getValue()===\"\"){\n  app.tfs_chgpwd.setInstructions('确认密码不能为空');\n  app.secondPwd.focus();\n  return;\n}\nif(app.secondPwd.getValue()!=app.newPwd.getValue()){\n  app.tfs_chgpwd.setInstructions('确认密码与新密码不一致');\n  app.secondPwd.focus();\n  return;\n}\nif(pwdLengthLimit===\"\"){\n  pwdLengthLimit =0;\n}\nif(pwdIncludeChar===\"\"){\n  pwdIncludeChar ='N';\n}\nif(pwdLengthLimit>0){\n  if (app.newPwd.getValue().length<pwdLengthLimit){\n     app.tfs_chgpwd.setInstructions('密码至少要'+pwdLengthLimit+'个字符或数字。');\n     app.newPwd.focus();\n     return;\n  }\n}\nif(pwdIncludeChar==='Y'){\n  var re = new RegExp(\"[A-Za-z\\x21-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7e]\");\n  if(!re.test((app.newPwd.getValue()))){\n     app.tfs_chgpwd.setInstructions('密码必须要包含字符。');\n     app.newPwd.focus();\n     return;\n  }\n}\n   Ext.Ajax.request({\n     url : 'frameAction.do?method=modifyUserPassword',\n     params:{\n       password:Xip.getMD5(app.newPwd.getValue()),\n       oldPwd:Xip.getMD5(app.oldPwd.getValue),\n       isValidPassword:\"Y\"\n     },\n     method: 'POST',\n     async : false,\n     success: function(response,options){\n       var resp = Ext.JSON.decode(response.responseText);\n       if(resp.flag==='1'){\n         Ext.Msg.alert(\"提示\",\"修改密码成功!\",function(){window.location=\"/\";});\n       }else{\n         app.tfs_chgpwd.setInstructions(resp.msg);\n       }\n     },\n     failure: function(response,options){\n       Ext.Msg.alert(\"提示\",\"修改密码失败!\");\n       return;\n     }\n   });"},"children":[],"expanded":false,"type":"tbutton"}],"expanded":true,"type":"ttoolbar"}],"expanded":true,"type":"tcontainer"}],"expanded":true,"type":"tviewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}