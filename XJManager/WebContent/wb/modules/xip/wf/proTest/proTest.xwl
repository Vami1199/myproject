{"inframe":false,"title":"流程测试","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","initScript":"var processId = request.getParameter(\"processId\") ;\n\nrequest.setAttribute(\"processId\",processId) ;","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/wf/proTest/json/wf_proTest\");","itemId":"module"},"children":[{"configs":{"itemId":"buttonArray"},"children":[{"configs":{"text":"{#wf_proTest_btnTest#}","itemId":"btnTest","iconCls":"ok_icon"},"events":{"click":"// 获取内置参数\nvar _e_submitter = app.e_submitter.getValue() ;\nvar _e_org = app.e_org.getValue() ;\nvar _e_dept = app.e_dept.getValue() ;\nvar _e_business_id = app.e_business_id.getValue() ;\nvar _e_business_code = app.e_business_code.getValue() ;\nvar _e_business_name = app.e_business_name.getValue() ;\nvar _processId = app.procId.getValue() ;\n\nvar json = {\n  'e_submitter'\t\t:\t_e_submitter,\n  'e_org'\t\t\t:\t_e_org,\n  'e_dept'\t\t\t:\t_e_dept,\n  'e_business_id'\t:\t_e_business_id,\n  'e_business_code'\t:\t_e_business_code,\n  'e_business_name'\t:\t_e_business_name,\n  'processId'\t\t:_processId\n} ;\n\n// 获取自定义参数\nvar rows = app.grid1.store.data.items ;\nExt.each(rows , function(r){\n  var attrCode = r.get('ATTR_CODE') ;\n  var attrResult = r.get('FUNC_VALUE') ;  \n  \n  json[attrCode] = attrResult ;\n}) ;\n\n//var jsonstr = JSON.stringify(json) ;\nvar attrs = Ext.JSON.encode(json) ;\n\n//var p = {'attributes':attrs} ;\n\n// 提交ajax请求\nWb.request({\n\turl:'m?xwl=xip/wf/proTest/data/Test_Process',\n    params:{'attributes':attrs},\n    success:function(resp){\n\tvar response = Ext.JSON.decode(resp.responseText);\nvar flag = response.flag ;\n\nif(flag === \"0\"){\n\n  \n  app.resultWin.show() ;\n  app.resultGrid.store.loadData(response.data);\n \n \n  \n}else{\n  Ext.Msg.alert(\"{#wf_proTest_prompt#}\",\"{#wf_proTest_lccssb#}\"+response.msg) ;\n}\n\t}\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_proTest_btnReset#}","itemId":"btnReset","iconCls":"minus_icon"},"events":{"click":"\nWb.reset(app.form1);\nWb.reload(app.grid1);"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"resultBtnArray"},"children":[{"configs":{"text":"{#wf_proTest_btnClose#}","itemId":"btnClose","iconCls":"logout_icon"},"events":{"click":"app.resultWin.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"title":"{#wf_proTest_resultWin#}","height":"450","layout":"fit","width":"document.body.clientWidth*(.9)","closeAction":"hide","buttons":"app.resultBtnArray","buttonAlign":"center","dialog":"false","itemId":"resultWin","modal":"true"},"children":[{"configs":{"region":"center","selType":"cellmodel","frame":"false","barExportButtons":"false","barExportAllButtons":"false","barNavigateButtons":"false","forceFit":"true","itemId":"resultGrid","viewConfig":"{\n enableTextSelection:true\n}","barInfoLabel":"false"},"children":[{"configs":{"itemId":"store","fields":"['step','actCode','actName','actType','approver']"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#wf_proTest_step#}","align":"center","dataIndex":"step","titleAlign":"center","itemId":"step"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_actCode#}","width":"120","dataIndex":"actCode","itemId":"actCode"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_actName#}","width":"120","dataIndex":"actName","itemId":"actName"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_actType#}","width":"120","dataIndex":"actType","itemId":"actType","renderer":"if(value === 'Start'){\n  return '{#wf_proTest_Startnode#}' ;\n}else if(value === 'Notice'){\n  return '{#wf_proTest_Noticenode#}' ;\n}else if(value === 'Switch'){\n  return '{#wf_proTest_Switchnode#}' ;\n}else if(value === 'End'){\n  return '{#wf_proTest_Endnode#}' ;\n}else if(value === 'Response'){\n  return '{#wf_proTest_Responsenode#}' ;\n}else if(value === 'Function'){\n  return '{#wf_proTest_Functionnode#}' ;\n}else if(value === 'Countersign'){\n  return '{#wf_proTest_Countersigncode#}' ;\n}else{\n  return value ;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_approver#} (<font color=red><i>{#wf_proTest_approver1#}<\/i><\/font>)","width":"300","dataIndex":"approver","itemId":"approver","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:20px;';   \nreturn value; "},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","frame":"true","layout":"fit","itemId":"form1"},"children":[{"configs":{"title":"{#wf_proTest_fieldset1#}","height":"100","layout":"form","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"180","labelAlign":"right","normalName":"ORG_NAME","itemId":"cbx_org","fieldLabel":"{#wf_proTest_ORG_NAME#}【e_org】","editable":"true"},"children":[{"configs":{"height":"250","barExportButtons":"false","barExportAllButtons":"false","itemId":"pickComp"},"events":{"itemclick":"\nvar orgId = record.get('ID');\nvar orgName = record.get('NAME');\n\napp.ORG_NAME.setValue(orgName);\napp.e_org.setValue(orgId);\n\n\n// app.pickComp.hide() ;\nvar picker = this.ownerCmp;\npicker.collapse();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"40","width":"300","labelAlign":"right","itemId":"orgName","fieldLabel":"{#wf_proTest_orgName#}"},"events":{"specialkey":"if(Ext.EventObject.getKey() == 13){\n app.pickComp.getStore().load() ;\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#wf_proTest_ORG_NAME#}","hidden":"true","dataIndex":"ID","itemId":"ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_CODE#}","width":"100","dataIndex":"CODE","itemId":"CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_orgName#}","width":"250","dataIndex":"NAME","itemId":"NAME","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_SHORT_NAME#}","hidden":"true","width":"200","dataIndex":"SHORT_NAME","itemId":"SHORT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/wf/proTest/data/Get_Orgs"},"events":{"beforeload":"store.proxy.extraParams.orgName = app.orgName.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"grid"}],"expanded":false,"type":"picker"},{"configs":{"labelWidth":"180","labelAlign":"right","normalName":"D_NAME","itemId":"cbx_dept","fieldLabel":"{#wf_proTest_cbx_dept#}【e_dept】","editable":"true"},"events":{"expand":"var str=app.e_org.getValue();\nif(str == ''|| str==null){\n  Ext.Msg.alert(\"{#wf_proTest_prompt#}\",\"{#wf_proTest_qxzzz#}\") ;\n\n}else{picker.getPicker().getStore().load({params:{\n\t\te_org:app.e_org.getValue()\n\t}});}\n"},"children":[{"configs":{"height":"250","barExportButtons":"false","barExportAllButtons":"false","itemId":"pickComp"},"events":{"itemclick":"\nvar deptId = record.get('ID');\nvar deptName = record.get('NAME');\n\napp.D_NAME.setValue(deptName);\napp.e_dept.setValue(deptId);\n\n\n// app.pickComp.hide() ;\nvar picker = this.ownerCmp;\npicker.collapse();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"40","width":"300","labelAlign":"right","itemId":"deptName","fieldLabel":"{#wf_proTest_orgName#}"},"events":{"specialkey":"if(Ext.EventObject.getKey() == 13){\n  \n app.pickComp.getStore().load() ;\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"DEPT_ID","hidden":"true","dataIndex":"ID","itemId":"DEPT_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_CODE#}","width":"100","dataIndex":"CODE","itemId":"DEPT_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_orgName#}","width":"250","dataIndex":"NAME","itemId":"DEPT_NAME","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_SHORT_NAME#}","hidden":"true","width":"200","dataIndex":"SHORT_NAME","itemId":"DEPT_SHORT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"store","url":"m?xwl=xip/wf/proTest/data/Get_Dept"},"events":{"beforeload":"store.getProxy().extraParams.e_org = app.e_org.getValue();\nstore.proxy.extraParams.deptName = app.deptName.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"picker"},{"configs":{"labelWidth":"180","hidden":"true","labelAlign":"right","itemId":"e_submitter","fieldLabel":"提交人ID【e_submitter】"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"180","hidden":"true","labelAlign":"right","itemId":"e_business_id","fieldLabel":"业务ID【e_business_id】"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"180","hidden":"true","labelAlign":"right","itemId":"e_business_code","fieldLabel":"业务编码【e_business_code】"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"180","hidden":"true","labelAlign":"right","itemId":"e_business_name","fieldLabel":"业务名称【e_business_name】"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"180","hidden":"true","value":"{#processId#}","labelAlign":"right","itemId":"procId","fieldLabel":"流程ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"180","hidden":"true","labelAlign":"right","itemId":"e_org","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"180","hidden":"true","labelAlign":"right","itemId":"e_dept","fieldLabel":"部门ID"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"cellmodel","barPageButton":"false","barNavigateButtons":"false","buttons":"app.buttonArray","itemId":"grid1","forceFit":"true","editable":"true","title":"{#wf_proTest_grid1#}","frame":"false","barExportAllButtons":"false","barExportButtons":"false","barRefreshButton":"false","buttonAlign":"right","barInfoLabel":"false"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/wf/proTest/data/Get_EntityAttrs"},"events":{"beforeload":"\nstore.getProxy().extraParams.procId = '{#processId#}';"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"width":"30","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"id","hidden":"true","width":"150","dataIndex":"ATTR_ID","itemId":"ATTR_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_CODE#}","width":"150","dataIndex":"ATTR_CODE","itemId":"ATTR_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_ATTR_NAME#}","width":"200","dataIndex":"ATTR_NAME","itemId":"ATTR_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_ATTR_CATEGORY#}","align":"center","width":"120","dataIndex":"ATTR_CATEGORY","itemId":"ATTR_CATEGORY","renderer":"if(value === 'static'){\n  return '{#wf_proTest_static#}' ;\n}else if(value === 'dynamic'){\n  return '{#wf_proTest_dynamic#}' ;\n}else{\n  return value ;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_FUNC_TYPE#}","align":"center","width":"120","dataIndex":"FUNC_TYPE","itemId":"FUNC_TYPE","renderer":"if(value === 'PROC'){\n  return '{#wf_proTest_PROC#}' ;\n}else if(value === 'WEB'){\n  return '{#wf_proTest_WEB#}' ;\n}else{\n  return value ;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proTest_FUNC_VALUE#}","width":"350","dataIndex":"FUNC_VALUE","itemId":"FUNC_VALUE","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value; "},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}