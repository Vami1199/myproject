{"inframe":false,"title":"流程表单","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"com.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/wf/wfpage/json/wf_wfpage\");","itemId":"module"},"children":[{"configs":{"itemId":"Winbtns"},"children":[{"configs":{"text":"{#wf_wfpage_saveWin#}","itemId":"saveWin","iconCls":"save_icon"},"events":{"click":"var _opType = app.opType.getValue();\nvar _appId = app.selectApp.getValue();\nvar _formCode = app.textFormId.getValue();\nvar _textfromCode=app.textFormCode.getValue();\nvar _formUrl = app.textFormUrl.getValue();\nvar _formDesc = app.textFormDesc.getValue();\nvar _selectClientType=app.selectClientType.getValue();\nvar _selectEnabled=app.selectEnabled.getValue();\nvar _cbxEnableFlag=app.cbxEnableFlag.getValue();\nvar _cbxClientType=app.cbxClientType.getValue();\nvar formDesc=app.formDesc.getValue();\nif(_appId === null || _appId === \"\"){\n//   Ext.Msg.alert('提示','请选择应用!');\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qxzyyxx#}\") ;\n  return false;\n}\nif(_opType === 'add'){\t// 新增\n  if(_formCode === null || _formCode === \"\"){\n//     Ext.Msg.alert('提示','请录入表单编码!') ;\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qlrbdbm#}\") ;\n    return false;\n  }else{\n   var addcode=app.textAppCode.getValue() + '-' + _formCode;\n    \n  }  \n}\n\nif(_formDesc === null || _formDesc === \"\"){\n//   Ext.Msg.alert('提示','请录入表单名!') ;\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qlrbdmc#}\") ;\n  return false;\n}\nif(_formUrl === null || _formUrl === \"\"){\n//   Ext.Msg.alert('提示','请录入表单地址!') ;\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qlrbddz#}\") ;\n  return false;\n}\nvar json = {\n  \n  textFormCode:addcode,\n  selectApp:_appId,\n  textFormUrl:_formUrl,\n  textFormDesc:_formDesc,\n  selectEnabled:_selectEnabled,\n  selectClientType:_selectClientType\n\n};\n// 执行保存处理\nif(_opType === 'add'){\t// 新增\n   \n   Wb.request({\n           url: 'm?xwl=xip/wf/wfpage/data/insertProForms', \n           params: json,\n           success: function() {\n             app.formGrid.store.load({params:{appid:_appId,\n                                       cbxEnableFlag:_cbxEnableFlag,\n                                           cbxClientType:_cbxClientType,\n                                              formDesc:formDesc\n                                             }});\n             app.win.hide();\n//              Ext.MessageBox.alert('提示','数据保存成功!') ;\n             Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_skbccg#}\") ;\n          \n          }\n       });\n  \n}else if(_opType === 'update'){ // 更新\n  json.textFormCode=_textfromCode;\n   Wb.request({\n           url: 'm?xwl=xip/wf/wfpage/data/updateProForms', \n           params: json,\n           success: function() {\n               app.formGrid.store.load({params:{appid:_appId,\n                                  cbxEnableFlag:_cbxEnableFlag,\n                                           cbxClientType:_cbxClientType ,\n                                                formDesc:formDesc\n                                             }});\n             app.win.hide();\n//              Ext.MessageBox.alert('提示','数据保存成功!') ;\n             Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_skbccg#}\") ;\n          }\n       });\n  \n}else{\n  // 其他\n}\n\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfpage_btnSaveAll#}","itemId":"btnSaveAll"},"events":{"click":"var _opType = app.opType.getValue();\nvar _appId = app.selectApp.getValue();\nvar _formCode = app.textFormId.getValue();\nvar _textfromCode=app.textFormCode.getValue();\nvar _formUrl = app.textFormUrl.getValue();\nvar _formDesc = app.textFormDesc.getValue();\nvar _selectClientType=app.selectClientType.getValue();\nvar _selectEnabled=app.selectEnabled.getValue();\nvar _cbxEnableFlag=app.cbxEnableFlag.getValue();\nvar _cbxClientType=app.cbxClientType.getValue();\nvar formDesc=app.formDesc.getValue();\nif(_appId === null || _appId === \"\"){\n//   Ext.Msg.alert('提示','请选择应用!');\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qxzyyxx#}\") ;\n  return false;\n}\nif(_opType === 'add'){\t// 新增\n  if(_formCode === null || _formCode === \"\"){\n//     Ext.Msg.alert('提示','请录入表单编码!') ;\n    Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qlrbdbm#}\") ;\n    return false;\n  }else{\n   var addcode=app.textAppCode.getValue() + '-' + _formCode;\n    \n  }  \n}\n\nif(_formDesc === null || _formDesc === \"\"){\n//   Ext.Msg.alert('提示','请录入表单名!') ;\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qlrbdmc#}\") ;\n  return false;\n}\nif(_formUrl === null || _formUrl === \"\"){\n//   Ext.Msg.alert('提示','请录入表单地址!') ;\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qlrbddz#}\") ;\n  return false;\n}\nvar json = {\n  \n  textFormCode:addcode,\n  selectApp:_appId,\n  textFormUrl:_formUrl,\n  textFormDesc:_formDesc,\n  \n  selectEnabled:_selectEnabled,\n  selectClientType:_selectClientType\n\n};// 执行保存处理\n Wb.request({\n           url: 'm?xwl=xip/wf/wfpage/data/insertProForms', \n           params: json,\n           success: function() {\n            \n          \n            \n             // 重置表单\n             app.selectClientType.setValue('PC') ;\n             app.selectEnabled.setValue('Y');\n             app.textFormId.setValue();\n             app.textFormCode.setValue();\n             app.textFormUrl.setValue('');\n             app.textFormDesc.setValue('') ;\n             \n              app.formGrid.store.load({params:{appid:_appId,\n                                       cbxEnableFlag:_cbxEnableFlag,\n                                           cbxClientType:_cbxClientType  ,\n                                               formDesc:formDesc\n                                             }});\n          }\n       });"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfpage_closeWin#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.win.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"height":"270","layout":"fit","width":"540","closeAction":"hide","buttons":"app.Winbtns","buttonAlign":"center","dialog":"false","itemId":"win","modal":"true"},"children":[{"configs":{"frame":"true","style":"border-width:0px","border":"false","itemId":"form2"},"children":[{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","layout":"column","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"100","displayField":"APP_NAME","width":"450","valueField":"APP_ID","emptyText":"{#wf_wfpage_pleaseSelect#}","labelAlign":"right","itemId":"selectApp","fieldLabel":"{#wf_wfpage_selectApp#}","editable":"false"},"events":{"select":"var appcode = records[0].get('APP_CODE') ;\n\napp.textAppCode.setValue(appcode) ;\n"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/data/getApps"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","hidden":"true","layout":"column","border":"false","itemId":"panel2"},"children":[{"configs":{"labelWidth":"100","allowBlank":"true","hidden":"true","width":"450","labelAlign":"right","itemId":"selectEntity","forceSelection":"true","fieldLabel":"{#wf_wfpage_selectEntity#}","editable":"false","disabled":"true"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","layout":"column","border":"false","itemId":"panel3"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","width":"200","labelAlign":"right","itemId":"textAppCode","fieldLabel":"<font color='red'>*<\/font>{#wf_wfpage_FORM_ID#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","allowBlank":"false","hidden":"true","width":"250","labelAlign":"right","itemId":"textFormId"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","hidden":"true","layout":"column","border":"false","itemId":"panel4"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","width":"450","labelAlign":"right","itemId":"textFormCode","fieldLabel":"<font color='red'>*<\/font>{#wf_wfpage_FORM_ID#}","disabled":"true"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","layout":"column","border":"false","itemId":"panel5"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","width":"450","labelAlign":"right","itemId":"textFormDesc","fieldLabel":"<font color=red>*<\/font>{#wf_wfpage_FORM_DESC#}"},"children":[],"expanded":true,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","layout":"column","border":"false","itemId":"panel6"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","width":"450","labelAlign":"right","itemId":"textFormUrl","fieldLabel":"<font color=red>*<\/font>{#wf_wfpage_FORM_URL#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","layout":"column","border":"false","itemId":"panel7"},"children":[{"configs":{"labelWidth":"100","displayField":"NAME","width":"450","value":"PC","pickList":"[['PC','{#wf_wfpage_dndbd#}'],['PAD','{#wf_wfpage_pbdbd#}'],['Mobile','{#wf_wfpage_sjdbd#}']]","labelAlign":"right","itemId":"selectClientType","fieldLabel":"{#wf_wfpage_CLIENT_TYPE#}","editable":"false"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","layout":"column","border":"false","itemId":"panel8"},"children":[{"configs":{"labelWidth":"100","displayField":"NAME","width":"450","value":"Y","pickList":"[['Y','{#wf_wfpage_yx#}'],['N','{#wf_wfpage_wx#}']]","labelAlign":"right","itemId":"selectEnabled","fieldLabel":"{#wf_wfpage_ENABLE_FLAG#}","editable":"false"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"hidden":"true","itemId":"opType","fieldLabel":"操作类型"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"},{"configs":{"layout":"border","itemId":"viewport"},"children":[{"configs":{"region":"north","height":"80","frame":"true","style":"border-width:0px","layout":"fit","itemId":"queryform","border":"false"},"children":[{"configs":{"title":"{#wf_wfpage_cxtj#}","style":"padding-top:8px","collapsible":"true","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"40","displayField":"APP_NAME","width":"250","valueField":"APP_ID","emptyText":"{#wf_wfpage_pleaseSelect#}","labelAlign":"right","itemId":"cbxApps","fieldLabel":"{#wf_wfpage_cbx4App#}","editable":"false"},"events":{"select":"app.queryBtn.fireEvent('click');\n\n"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/data/getApps"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"80","displayField":"NAME","width":"200","value":"ALL","pickList":"[['ALL','{#wf_wfpage_all#}'],['Y','{#wf_wfpage_yx#}'],['N','{#wf_wfpage_wx#}']]","labelAlign":"right","itemId":"cbxEnableFlag","fieldLabel":"{#wf_wfpage_cbxEnableFlag#}","editable":"false"},"events":{"select":"app.queryBtn.fireEvent('click');\n"},"children":[],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"120","displayField":"NAME","width":"240","value":"ALL","pickList":"[['ALL','{#wf_wfpage_all#}'],['PC','{#wf_wfpage_dndbd#}'],['PAD','{#wf_wfpage_pbdbd#}'],['Mobile','{#wf_wfpage_sjdbd#}']]","labelAlign":"right","itemId":"cbxClientType","fieldLabel":"{#wf_wfpage_cbxClientType#}","editable":"false"},"events":{"select":"app.queryBtn.fireEvent('click');"},"children":[],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"80","width":"200","labelAlign":"right","itemId":"formDesc","fieldLabel":"{#wf_wfpage_formDesc#}"},"events":{"specialkey":"app.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#wf_wfpage_queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"var _appId = app.cbxApps.getValue();\nvar cbxEnableFlag=app.cbxEnableFlag.getValue();\nvar cbxClientType=app.cbxClientType.getValue();\n\nvar formDesc=app.formDesc.getValue();\nif(_appId === null || _appId === \"\"){\n//   Ext.Msg.alert(\"提示\",\"请选择应用!\") ;\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qxzyyxx#}\") ;\n  return false ;\n}\n\napp.formGrid.store.load({params:{\n  appid:_appId,\n  cbxEnableFlag: cbxEnableFlag,\n  cbxClientType: cbxClientType,\n  formDesc:formDesc\n}});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfpage_resetBtn#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"var appId = app.cbxApps.getValue();\napp.queryform.getForm().reset(); \napp.cbxApps.setValue(appId);\napp.queryBtn.fireEvent('click');\n"},"children":[],"expanded":true,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"rowmodel","itemId":"formGrid"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xip/wf/wfpage/data/getProcForms"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfpage_addBtn#}","itemId":"addBtn","iconCls":"application_add_icon"},"events":{"click":"var win = new Ext.window.Window(app._win);\n\n//app.selectApp.enable();\napp.textAppCode.show();\napp.textFormId.show();\n\n//app.selectEntity.disable();\napp.opType.setValue('add') ;\napp.btnSaveAll.show();\n// app.win.setTitle('添加流程关联表单');\napp.win.setTitle('{#wf_wfpage_tjlcglbd#}');\nwin.show();\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfpage_editBtn#}","itemId":"editBtn","iconCls":"table_edit_icon"},"events":{"click":"var rows = app.formGrid.getSelectionModel().getSelection();\nif(rows.length === 0){\n//   Ext.Msg.alert('提示','请选择表单信息!');\n  Ext.Msg.alert(\"{#wf_wfpage_prompt#}\",\"{#wf_wfpage_qxzbdxx#}\") ;\n  return false ;\n}else{\n  app.opType.setValue('update');\n  app.btnSaveAll.hide();\n//   app.win.setTitle('修改流程关联表单');\n  app.win.setTitle('{#wf_wfpage_xglcglbd#}');\n  //   selectEntity.enable();\n  // 执行表单赋值\n  app.selectApp.store.load({callback:function(){\n    app.selectApp.setValue(rows[0].data.APP_ID);   \n    app.selectApp.collapse();\n  }}) ; \n  //   selectEntityStore.load({callback:function(){\n  //     selectEntity.setValue(rows[0].data.ENTITY_ID) ;\n  //   }}) ;  \n   app.selectApp.disable() ;\n  app.panel3.hide();\n  app.panel4.show();\n  app.selectClientType.setValue(rows[0].data.CLIENT_TYPE) ;\n  app.selectEnabled.setValue(rows[0].data.ENABLE_FLAG);  \n  app.textFormCode.setValue(rows[0].data.FORM_ID) ;\n  app.textFormUrl.setValue(rows[0].data.FORM_URL) ;\n  app.textFormDesc.setValue(rows[0].data.FORM_DESC) ;\n  app.win.show();\n}\n\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#wf_wfpage_xh#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_FORM_ID#}","width":"150","align":"left","dataIndex":"FORM_ID","itemId":"FORM_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_FORM_DESC#}","width":"250","dataIndex":"FORM_DESC","itemId":"FORM_DESC"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_FORM_URL#}","width":"350","dataIndex":"FORM_URL","itemId":"FORM_URL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_ENABLE_FLAG#}","align":"center","width":"90","dataIndex":"ENABLE_FLAG","itemId":"ENABLE_FLAG","renderer":"if(value === 'Y'){\n  return '{#wf_wfpage_yx#}' ;\n}else if(value === 'N'){\n  return \"<font color='red'>{#wf_wfpage_wx#}<\/font>\";\n}else{\n  return value ;\n}  \n"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_CLIENT_TYPE#}","width":"120","dataIndex":"CLIENT_TYPE","itemId":"CLIENT_TYPE","renderer":"if(value === 'PC'){\n  return '{#wf_wfpage_dn#}' ;\n}else if(value === 'PAD'){\n  return '{#wf_wfpage_pb#}';\n}else if(value === 'Mobile'){\n  return '{#wf_wfpage_sj#}';\n}else{\n  return value ;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_APP_ID#}","hidden":"true","dataIndex":"APP_ID","itemId":"APP_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfpage_APP_NAME#}","align":"left","width":"250","dataIndex":"APP_NAME","itemId":"APP_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}