{"inframe":false,"title":"流程导出","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/wf/proExpImp/json/wf_proExpImp\");\n\nvar ctxPath = request.getContextPath() ;\nvar appId = request.getParameter(\"appId\") ;\nrequest.setAttribute(\"appId\",appId) ;\nrequest.setAttribute(\"contextPath\",ctxPath);","itemId":"module"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#wf_proExpImp_btnExp#}","itemId":"btnExp","iconCls":"ok_icon"},"events":{"click":"var rows = app.grid1.getSelectionModel().getSelection();\nif(rows.length === 0){\n//   \tExt.Msg.alert(\"提示\",\"请选择流程信息!\") ;\n    Ext.MessageBox.alert('{#wf_proExpImp_prompt#}', '{#wf_proExpImp_qxzlcxx#}');\n  \treturn false ;\n}else{\n  \tvar procList = \"\" ;\n    Ext.each(rows, function(r){\n      var pid = r.get('PID') ;\n      if(procList === \"\"){\n        procList = pid ;\n      }else{\n        procList = procList + \",\" + pid ;\n      }\n    });\n\n\tvar msg = Ext.MessageBox.show({\n\t\ttitle \t : \t'{#wf_proExpImp_wait#}',\n\t\tmsg \t : \t'{#wf_proExpImp_zztjqq#}',\n\t\twidth \t : \t240,\n\t\twait\t : \ttrue,\n\t\tprogress : \ttrue,\n\t\tclosable : \tfalse\n\t});\n  \n  \t// 提交ajax请求\n\tExt.Ajax.request({\n      url \t: '{#contextPath#}'+'/procImpAndExpAction.do?method=expProc',\n\t\tparams\t: {'procList'  : procList},\n\t\tmethod \t: 'post',\n\t\ttimeout : 3600000,\n\t\tasync\t:\tfalse,\n\t\tsuccess : function(response, options) {\n            msg.hide();\n\t\t\tvar resp = Ext.JSON.decode(response.responseText); \n            \n          \tvar flag = resp.flag ;\n          \tvar filepath = resp.filepath ;\n          \tvar filename = resp.filename ;\n            if(flag === \"0\"){\n              window.open('{#contextPath#}' + '/down?method=download&filepath='+filepath+'&filename='+filename);\n            }else{\n              Ext.Msg.alert(\"{#wf_proExpImp_prompt#}\", response.msg);\n            }\n\t\t},\n\t\tfailure : function(reponse, options) {\n            msg.hide();\n\t\t\tvar resp = Ext.JSON.decode(response.responseText);\n          \tExt.Msg.alert(\"{#wf_proExpImp_prompt#}\", response.msg);\n\t\t}\n\t});\t\t  \n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"layout":"fit","itemId":"viewport1"},"children":[{"configs":{"pagingBar":"true","selType":"checkboxmodel","barPageButton":"false","barNavigateButtons":"false","buttons":"app.buttons","itemId":"grid1","tagConfigs":"features:[{ftype:'grouping'}]","multiSelect":"true","barExportAllButtons":"false","barExportButtons":"false","barRefreshButton":"false","buttonAlign":"right","border":"false","simpleSelect":"true","barInfoLabel":"false"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"80","displayField":"NAME","width":"300","valueField":"ID","labelAlign":"right","itemId":"cbxEntities","fieldLabel":"{#wf_proExpImp_cbxEntities#}","editable":"false"},"events":{"afterrender":"app.cbxEntities.setValue('') ;","select":"app.btnQuery.fireEvent('click');"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/wf/proExpImp/data/Get_Entitys"},"events":{"load":"Ext.define('EntityModel', {  \n    extend: 'Ext.data.Model',  \n    fields: [  \n        {name: 'ID'},  \n        {name: 'CODE'},   \n        {name: 'NAME'}\n     ]  \n});\nvar p = Ext.create('EntityModel', {ID:'',CODE:'', NAME: '全部实体'});\napp.cbxEntities.store.insert(0,p);","beforeload":"store.proxy.extraParams.appId = '{#appId#}' ;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"80","width":"300","labelAlign":"right","itemId":"proc_name","fieldLabel":"{#wf_proExpImp_proc_name#}"},"events":{"specialkey":"if (e.getKey() == Ext.EventObject.ENTER) {\n  app.btnQuery.fireEvent('click') ;\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"btnQuery","iconCls":"seek_icon"},"events":{"click":"app.grid1.getStore().load() ;"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"groupDir":"DESC","groupField":"GROUPTYPE","pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/wf/proExpImp/data/Get_Process"},"events":{"beforeload":"store.proxy.extraParams.appId = '{#appId#}' ;\n\nvar _entityId = app.cbxEntities.getValue() ;\nif(Wb.isEmpty(_entityId) ||　_entityId === undefined){\n  _entityId = '' ;\n}\nstore.proxy.extraParams.selEntityId = _entityId ;\nstore.proxy.extraParams.procName = app.proc_name.getValue() ;\n\n"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proExpImp_procId#}","hidden":"true","width":"150","dataIndex":"PID","itemId":"procId"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proExpImp_procCode#}","width":"150","dataIndex":"PCODE","itemId":"procCode"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proExpImp_proc_name#}","width":"250","dataIndex":"PNAME","itemId":"procName","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value ;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proExpImp_PVERISON#}","hidden":"true","width":"80","dataIndex":"PVERISON","itemId":"PVERISON"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proExpImp_PCATEGORY#}","hidden":"true","dataIndex":"PCATEGORY","itemId":"PCATEGORY","renderer":"if(value === 'P'){\n  return '{#wf_proExpImp_gglc#}';\n}else if(value === 'O'){\n  return '{#wf_proExpImp_zzlc#}';\n}else{\n  return value ;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_proExpImp_ENTITYID#}","hidden":"true","dataIndex":"ENTITYID","itemId":"ENTITYID"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#wf_proExpImp_cbxEntities#}","width":"150","dataIndex":"ENTITYNAME","itemId":"ENTITYNAME","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value ;"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#wf_proExpImp_ORG_ID#}","hidden":"true","dataIndex":"PORGID","itemId":"orgid"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#wf_proExpImp_PORGNAME#}","width":"250","dataIndex":"PORGNAME","itemId":"PORGNAME","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nif(value === null){\n  return '{#wf_proExpImp_gglc#}';\n}else{\n  return value ;\n}"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}