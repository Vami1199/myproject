{"inframe":true,"title":"工作流调用演示","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var userId = request.getSession().getAttribute(\"XzSessionVars\").get('userId');\n\nvar protocol = request.getProtocol() ;\nvar ipAddr = request.getServerName();\nvar port = request.getServerPort() ;\nvar ctxPath = request.getContextPath() ;\n\nprotocol = (protocol.substring(0, 4) == \"HTTPS\" ? \"https\" : \"http\") ;\nvar url = protocol + \"://\" + ipAddr +\":\" + port + ctxPath ;\n\nrequest.setAttribute('contextPath',ctxPath);\nrequest.setAttribute(\"userId\",userId);\nrequest.setAttribute(\"appIP\",url);\nvar appId = request.getSession().getAttribute(\"XzSessionVars\").get('appId');\nrequest.setAttribute(\"funId\",request.getParameter('funId'));\nrequest.setAttribute(\"appId\",request.getParameter('appId'));\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","loginRequired":"false","jsLinks":"[\"xip/js/xipWf-debug.js\"]","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/wf/wfDemo/json/wf_wfDemo\");","head":" ","itemId":"module"},"events":{"finalize":"var userId = '{#userId#}';\n\nvar curPoid=\"\";\n\nvar clickRowNum = 0;\n\n//设置总金额\nfunction sumAmt(){\n  app.newWinGrid.plugins[0].completeEdit();\n  \n  var total = 0;\n  for(var i=0; i< app.newWinGrid.store.getCount(); i++){\n    var subRecord = app.newWinGrid.store.getAt(i);\n    \n    var subPrice = subRecord.get('PRICE');\n    if(Ext.isEmpty(subPrice)){\n      subPrice = 0;\n    }\n    \n    var subCount = subRecord.get('CNT');\n    if(Ext.isEmpty(subCount)){\n      subCount = 0;\n    }\n    \n    var subTotal = subPrice * subCount;\n    \n    total = total + subTotal;\n  }\n  \n  app.AMT.setValue(total);\n}"},"children":[{"configs":{"itemId":"windows"},"children":[{"configs":{"title":"{#wf_monitor_orgWin#}","height":"400","width":"500","closeAction":"hide","dialog":"false","itemId":"orgWin"},"children":[{"configs":{"frame":"true","style":"border-width:0px","itemId":"orgPanel"},"children":[{"configs":{"height":"33","frame":"true","layout":"column","border":"false","itemId":"orgForm"},"children":[{"configs":{"labelWidth":"80","width":"220","labelAlign":"right","itemId":"orgname","fieldLabel":"{#wf_wfDemo_orgname#}"},"events":{"specialkey":"app.orgGrid.store.load({params:{orgname:app.orgname.getValue()}});"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#wf_wfDemo_queryBtn#}","itemId":"orgqueryBtn","iconCls":"seek_icon","x":"5"},"events":{"click":"app.orgGrid.store.load({params:{orgname:app.orgname.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"multiSelect":"true","height":"330","itemId":"orgGrid","editable":"true"},"events":{"itemdblclick":"app.orgOkbtn.fireEvent('click');"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_ORG_CODE#}","dataIndex":"ORG_CODE","itemId":"ORG_CODE_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_ORG_ID#}","hidden":"true","dataIndex":"ORG_ID","itemId":"ORG_ID_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_ORG_NAME#}","dataIndex":"ORG_NAME","itemId":"ORG_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/wf/wfDemo/DATA/orgStore"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#wf_wfDemo_okBtn#}","pressed":"true","itemId":"orgOkbtn","iconCls":"ok_icon"},"events":{"click":"var rows = app.orgGrid.getSelection()[0];\nif (Ext.isEmpty(rows)) {\n  Ext.MessageBox.alert('{#wf_wfDemo_prompt#}', '{#wf_wfDemo_nmyxzrhsj#}');\n  return;\n}else{\n  //app.newWinForm.loadRecord(rows);\n  app.ORG_NAME.setValue(rows.get('ORG_NAME'));\n  app.ORG_ID.setValue(rows.get('ORG_ID'));\n  app.orgWin.close();\n}\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"window"},{"configs":{"title":"{#wf_wfDemo_deptWin#}","height":"400","width":"500","closeAction":"hide","dialog":"false","itemId":"deptWin"},"children":[{"configs":{"frame":"true","style":"border-width:0px","itemId":"deptPanel"},"children":[{"configs":{"height":"33","frame":"true","layout":"column","border":"false","itemId":"deptForm"},"children":[{"configs":{"labelWidth":"80","width":"220","labelAlign":"right","itemId":"deptname","fieldLabel":"{#wf_wfDemo_deptname#}"},"events":{"specialkey":"app.deptGrid.store.load({params:{deptname:app.deptname.getValue()}});"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#wf_wfDemo_queryBtn#}","itemId":"deptqueryBtn","iconCls":"seek_icon","x":"5"},"events":{"click":"app.deptGrid.store.load({params:{deptname:app.deptname.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"height":"330","itemId":"deptGrid"},"events":{"itemdblclick":"app.okbtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/wf/wfDemo/DATA/deptStore"},"events":{"beforeload":"store.getProxy().extraParams.ORG_ID = app.ORG_ID.getValue();\n"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_DEPT_CODE#}","dataIndex":"DEPT_CODE","itemId":"DEPT_CODE_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_DEPT_ID#}","hidden":"true","dataIndex":"DEPT_ID","itemId":"DEPT_ID_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_DEPT_NAME#}","dataIndex":"DEPT_NAME","itemId":"DEPT_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#wf_wfDemo_okBtn#}","pressed":"true","itemId":"okbtn","iconCls":"ok_icon"},"events":{"click":"var rows = app.deptGrid.getSelection()[0];\nif (Ext.isEmpty(rows)) {\n  Ext.MessageBox.alert('{#wf_wfDemo_prompt#}', '{#wf_wfDemo_nmyxzrhsj#}');\n  return;\n}else{\n  app.DEPT_NAME.setValue(rows.get('DEPT_NAME'));\n  app.DEPT_ID.setValue(rows.get('DEPT_ID'));\n  app.deptWin.close();\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"window"},{"configs":{"height":"450","layout":"border","width":"900","closeAction":"hide","defaultFocus":"PO_NO","itemId":"newWindow","modal":"true"},"children":[{"configs":{"region":"north","height":"110","frame":"true","layout":"form","border":"false","itemId":"newWinForm"},"children":[{"configs":{"style":"border-width:0px","border":"false","itemId":"tbar"},"children":[{"configs":{"text":"{#wf_wfDemo_saveAllbtn#}","pressed":"false","itemId":"saveAllbtn","iconCls":"save_icon"},"events":{"click":"if(curPoid===\"\"){\n  curPoid = Wb.getId();\n  var val = app.PO_NO.getValue();\n  var now = new Date();\n  var lastdate = now;\n  var podate = app.PO_DATE.getValue();\n  var json={PO_ID\t:\tcurPoid,\n            PO_NO\t:\tapp.PO_NO.getValue(),\n            PO_DESC\t:\tapp.PO_DESC.getValue(),\n            VENDOR\t:\tapp.VENDOR.getValue(),\n            ORG_ID\t:\tapp.ORG_ID.getValue(),\n            DEPT_ID\t:\tapp.DEPT_ID.getValue(),\n            BUYER\t:\tapp.BUYER.getValue(),\n            AMT\t\t:\tapp.AMT.getValue(),\n            PO_DATE\t:\tpodate,\n            CREATION_DATE\t:\tlastdate,\n            CREATED_BY\t\t:\tuserId,\n            LAST_UPDATE_DATE:\tlastdate,\n            LAST_UPDATED_BY\t:\tuserId,\n            LAST_UPDATE_LOGIN\t:\tuserId\n           };\n  // 提交请求  插入主表\n  Wb.request({\n    url: 'm?xwl=xip/wf/wfDemo/DATA/poInsert', \n    params: Wb.apply({\n      array: [json]\n    }),\n    success: function() {\n      //插入或更新子表\n      var recs = app.newWinGrid.store.getCount();\n      if(recs===0){\n          app.newWindow.close();\n          app.newWinGrid.store.load();\n      }else{ \n          for(var i=0;i<recs;i++){\n                var rec =  app.newWinGrid.store.getAt(i);\n                if(rec.data.PO_L_ID ===''||rec.data.PO_L_ID === null){\n                 //插入子表\n                 var json_l={\n                           PO_L_ID : Wb.getId(),\n                           PO_ID   : curPoid,\n                           ITEM_NAME:rec.data.ITEM_NAME,\n                           UNIT    : rec.data.UNIT,\n                           PRICE   : rec.data.PRICE,\n                           CNT     : rec.data.CNT,\n                           AMT     : rec.data.AMT,\n                           CREATION_DATE :  new Date(),\n                           CREATED_BY    :  userId,\n                           LAST_UPDATE_DATE: new Date(),\n                           LAST_UPDATED_BY:  userId,\n                           LAST_UPDATE_LOGIN: userId};\n         Wb.request({\n           url: 'm?xwl=xip/wf/wfDemo/DATA/polInsert', \n           params: Wb.apply({\n                array: [json_l]\n           }),\n           success: function() {\n           }\n        });\n       }else{\n          //更新子表\n          var json_l_update={\n                    PO_L_ID  :   Wb.getId(),\n                    ITEM_NAME:   rec.data.ITEM_NAME,\n                    UNIT     :   rec.data.UNIT,\n                    PRICE    :   rec.data.PRICE,\n                    CNT      :   rec.data.CNT,\n                    AMT      :   rec.data.AMT,\n                    LAST_UPDATE_DATE :   new Date(),\n                    LAST_UPDATED_BY  :   userId,\n                    LAST_UPDATE_LOGIN:   userId};\n           Wb.request({\n              url: 'm?xwl=xip/wf/wfDemo/DATA/polUpdate', \n              params: Wb.apply({\n                  array: [json_l_update]\n              }),\n              success: function(){\n              \n              }\n           });\n       } \n     }\n    \n}\n       app.newWindow.close();\n      app.grid1.store.load();\n      \n    }\n  });\n}else{\n  var podate = app.PO_DATE.getValue();\n  var json={PO_ID  : curPoid,\n            PO_NO  : app.PO_NO.getValue(),\n            PO_DESC: app.PO_DESC.getValue(),\n            VENDOR : app.VENDOR.getValue(),\n            ORG_ID : app.ORG_ID.getValue(),\n            DEPT_ID: app.DEPT_ID.getValue(),\n            BUYER  : app.BUYER.getValue(),\n            AMT    : app.AMT.getValue(),\n            PO_DATE: podate,\n            LAST_UPDATE_DATE : lastdate,\n            LAST_UPDATED_BY  : userId,\n            LAST_UPDATE_LOGIN: userId\n           };\n  // 提交请求 保存主表\n  Wb.request({\n    url: 'm?xwl=xip/wf/wfDemo/DATA/poUpdate', \n    params: Wb.apply({\n      array: [json]\n    }),\n    success: function() {\n      //保存子表 判断更新还是插入\n      var recs = app.newWinGrid.store.getCount();\n      if(recs === 0){\n         app.newWindow.close();\n         app.newWinGrid.store.load();\n      }else{ \n         for(var i=0;i<recs;i++){\n           var rec = app.newWinGrid.store.getAt(i);\n           if(rec.data.PO_L_ID === ''||rec.data.PO_L_ID === null){\n            var json={\n                PO_L_ID\t\t\t\t:\tWb.getId(),\n                PO_ID\t\t\t\t:\tcurPoid,\n                ITEM_NAME\t\t\t:\trec.data.ITEM_NAME,\n                UNIT\t\t\t\t:\trec.data.UNIT,\n                PRICE\t\t\t\t:\trec.data.PRICE,\n                CNT\t\t\t\t\t:\trec.data.CNT,\n                AMT\t\t\t\t\t:\trec.data.AMT,\n                CREATION_DATE\t\t:\tnew Date(),\n                CREATED_BY\t\t\t:\tuserId,\n                LAST_UPDATE_DATE\t:\tnew Date(),\n                LAST_UPDATED_BY\t\t:\tuserId,\n                LAST_UPDATE_LOGIN\t:\tuserId};\n        Wb.request({\n           url: 'm?xwl=xip/wf/wfDemo/DATA/polInsert', \n           params: Wb.apply({\n             array: [json]\n           }),\n           success: function() {\n      \n           }\n       });\n        }else{\n           var json_l_update={\n                PO_L_ID\t\t\t\t:\trec.data.PO_L_ID,\n                ITEM_NAME\t\t\t:\trec.data.ITEM_NAME,\n                UNIT\t\t\t\t:\trec.data.UNIT,\n                PRICE\t\t\t\t:\trec.data.PRICE,\n                CNT\t\t\t\t\t:\trec.data.CNT,\n                AMT\t\t\t\t\t:\trec.data.AMT,\n                LAST_UPDATE_DATE\t:\tnew Date(),\n                LAST_UPDATED_BY\t\t:\tuserId,\n                LAST_UPDATE_LOGIN\t:\tuserId};\n         Wb.request({\n           url: 'm?xwl=xip/wf/wfDemo/DATA/polUpdate', \n           params: Wb.apply({\n              array: [json_l_update]\n            }),\n           success: function() {\n           }\n       });\n     } \n  }\n \n} app.newWindow.close();\n  app.grid1.store.load();\n      \n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"toolbar"},{"configs":{"height":"30","frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"80","width":"200","labelAlign":"right","itemId":"PO_NO","fieldLabel":"{#wf_wfDemo_PO_NO#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","width":"200","labelAlign":"right","itemId":"PO_DESC","fieldLabel":"{#wf_wfDemo_PO_DESC#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","width":"200","labelAlign":"right","itemId":"VENDOR","fieldLabel":"{#wf_wfDemo_VENDOR#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","width":"200","labelAlign":"right","itemId":"BUYER","fieldLabel":"{#wf_wfDemo_BUYER#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"height":"30","frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"panel2"},"children":[{"configs":{"labelWidth":"80","width":"175","labelAlign":"right","itemId":"ORG_NAME","fieldLabel":"{#wf_wfDemo_ORG_NAME_01#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"25","itemId":"orgBtn","iconCls":"set_icon"},"events":{"click":"app.orgWin.show();\napp.orgGrid.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"labelWidth":"80","width":"175","labelAlign":"right","itemId":"DEPT_NAME","fieldLabel":"{#wf_wfDemo_DEPT_NAME_01#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"25","itemId":"deptBtn","iconCls":"set_icon"},"events":{"click":"var orgname=app.ORG_NAME.getValue();\nif(orgname !==\"\" &&  orgname !==null){\n  app.deptWin.show();\n  app.deptGrid.store.reload();\n}else{\n//    Ext.Msg.alert('提示', '请先选择组织' );\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxxzzz#}\") ;\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"labelWidth":"80","readOnly":"true","width":"200","labelAlign":"right","itemId":"AMT","fieldLabel":"{#wf_wfDemo_AMT#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","width":"200","value":"@new Date()","labelAlign":"right","itemId":"PO_DATE","fieldLabel":"{#wf_wfDemo_PO_DATE#}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"height":"30","frame":"true","hidden":"true","layout":"column","border":"false","itemId":"panel3"},"children":[{"configs":{"labelWidth":"80","width":"220","labelAlign":"right","itemId":"ORG_ID","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","width":"220","labelAlign":"right","itemId":"DEPT_ID","fieldLabel":"部门ID"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","itemId":"newWinGrid","editable":"true"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","itemId":"XUHAO "},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PO_ID#}","hidden":"true","dataIndex":"PO_ID","itemId":"PO_ID_M_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PO_L_ID#}","hidden":"true","dataIndex":"PO_L_ID","itemId":"PO_L_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_ITEM_NAME#}","width":"200","dataIndex":"ITEM_NAME","itemId":"ITEM_NAME_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#wf_wfDemo_UNIT#}","width":"80","dataIndex":"UNIT","itemId":"UNIT_COL","renderer":"if(value=='T'){\n  return '{#wf_wfDemo_tai#}';\n} else if(value=='G'){\n  return '{#wf_wfDemo_ge#}';\n} else if(value=='X'){\n  return '{#wf_wfDemo_xiang#}';\n} else {\n  return value;\n}"},"children":[{"configs":{"pickList":"[['T','{#wf_wfDemo_tai#}'],['G','{#wf_wfDemo_ge#}'],['X','{#wf_wfDemo_xiang#}']]","itemId":"editor","forceSelection":"true"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PRICE#}","width":"120","dataIndex":"PRICE","itemId":"PRICE_COL"},"children":[{"configs":{"itemId":"editor"},"events":{"blur":"var selectRecord = app.newWinGrid.getSelection();\n//var selectRecord = app.newWinGrid.store.getAt(clickRowNum);\n\nvar price = this.getValue();\nif(Ext.isEmpty(price)){\n  price = 0;\n}\n\nvar count = selectRecord[0].get('CNT');\nif(Ext.isEmpty(count)){\n  count = 0;\n}\n\nselectRecord[0].set('AMT',price * count);\n\nsumAmt();"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_CNT#}","width":"120","dataIndex":"CNT","itemId":"CNT_COL"},"children":[{"configs":{"itemId":"editor"},"events":{"blur":"//var selectRecord = app.newWinGrid.store.getAt(clickRowNum);\nvar selectRecord = app.newWinGrid.getSelection();\nvar price = selectRecord[0].get('PRICE');\nif(Ext.isEmpty(price)){\n  price = 0;\n}\n\nvar count = this.getValue();\nif(Ext.isEmpty(count)){\n  count = 0;\n}\n\nselectRecord[0].set('AMT',price * count);\n\nsumAmt();"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#wf_wfDemo_AMT_01#}","width":"120","dataIndex":"AMT","itemId":"AMT_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xip/wf/wfDemo/DATA/poListStore"},"events":{"beforeload":"// var rows = app.grid1.getSelection();\n// alert(rows[0].data.PO_ID);\n// store.getProxy().extraParams.poid = rows[0].data.PO_ID;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_addBtn#}","pressed":"false","itemId":"addBtn","iconCls":"record_add_icon"},"events":{"click":"Wb.addEdit(app.newWinGrid);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_deleteBtn#}","pressed":"false","itemId":"deleteBtn","iconCls":"record_delete_icon"},"events":{"click":"var recs = app.newWinGrid.getSelection();\nif (!recs.length) {\n//   Wb.warn('请选择需要删除的记录。');\n\tWb.warn('{#wf_wfDemo_qxzxyscdjl#}');\n\treturn;\n}\nWb.request({\n        url: 'm?xwl=xip/wf/wfDemo/DATA/poldel', \n        params: Wb.apply({\n           destroy: Wb.getData(recs)\n        }),\n        success: function() {\n          Wb.remove(app.newWinGrid);\n//           Ext.Msg.alert('提示','删除成功！');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_sccg#}\") ;\n        }\n      });"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"}],"expanded":false,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","frame":"true","height":"80","style":"border-width:0px","layout":"fit","border":"false","itemId":"form1"},"children":[{"configs":{"title":"{#wf_wfDemo_cxtj#}","style":"padding-top:8px","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"code","fieldLabel":"{#wf_wfDemo_PO_NO#}"},"events":{"specialkey":"app.grid1.store.load({\n           params:{  \n             code       : app.code.getValue(),\n             description: app.description.getValue(),\n             vendor     : app.vendor.getValue()}\n});"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"description","fieldLabel":"{#wf_wfDemo_PO_DESC#}"},"events":{"specialkey":"app.grid1.store.load({\n           params:{  \n             code       : app.code.getValue(),\n             description: app.description.getValue(),\n             vendor     : app.vendor.getValue()}\n});"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"vendor","fieldLabel":"{#wf_wfDemo_VENDOR#}"},"events":{"specialkey":"app.grid1.store.load({\n           params:{  \n             code       : app.code.getValue(),\n             description: app.description.getValue(),\n             vendor     : app.vendor.getValue()}\n});"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#wf_wfDemo_queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.grid1.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_resetBtn#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"app.form1.getForm().reset();\napp.grid1.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","store":"app.store","rowNumber":"true","itemId":"grid1"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#wf_wfDemo_addPOBtn#}","itemId":"addBtn","iconCls":"application_add_icon"},"events":{"click":"curPoid=\"\";\nvar win = new Ext.window.Window(app._newWindow);\nwin.show();\n// win.setTitle('新增采购订单');\nwin.setTitle('{#wf_wfDemo_xzcgdd#}');\napp.newWinGrid.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_editPOBtn#}","itemId":"editBtn","iconCls":"record_edit_icon"},"events":{"click":"var rows = app.grid1.getSelection();\nif (rows.length!=1) {\n//   Ext.MessageBox.alert('提示', '请选择一条订单信息!');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n  return;\n}else{\n  Wb.edit(app.grid1,app.newWindow);\n  var poid = rows[0].data.PO_ID;\n  curPoid = poid;\n  //Wb.load(grid2stroe,{\"poid\":poid});\n  app.newWindow.show();\n  app.newWinGrid.store.load({params:{poid:poid}});\n//   app.newWindow.setTitle('修改采购订单') ;\n  app.newWindow.setTitle('{#wf_wfDemo_xgcgdd#}') ;\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_copyBtn#}","itemId":"copyBtn","iconCls":"copy_icon"},"events":{"click":"curPoid=\"\";\nvar rows = app.grid1.getSelection();\nif (rows.length!=1) {\n//   Ext.MessageBox.alert('提示', '请选择一条订单信息!');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n  return;\n}else{\n  Wb.edit(app.grid1,app.newWindow);\n var poid = rows[0].data.PO_ID;\n  app.newWindow.show();\n  app.newWinGrid.store.load({params:{poid:poid},callback : function (){\n    var recs = app.newWinGrid.store.getCount();\n  if(recs===0){\n\n  }else{\n    \n    for(var i=0;i<recs;i++){\n    \n    var rec =  app.newWinGrid.store.getAt(i);\n     rec.set('PO_L_ID','');\n       rec.set('PO_ID','');\n    }\n  }\n  \n  }});\n//   app.newWindow.setTitle('复制采购订单') ;\n  app.newWindow.setTitle('{#wf_wfDemo_fzcgdd#}') ;\n \n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_deletePOBtn#}","itemId":"deleteBtn","iconCls":"application_delete_icon"},"events":{"click":"// Wb.del(app.grid1, {\n//   url: 'm?xwl=dev/examples/crud/crud-db-access/delete'\n// });\nvar recs = app.grid1.getSelection();\nif (recs.length!==1) {\n//   Wb.warn('请选择一条订单信息!');\n  Wb.warn(\"{#wf_wfDemo_qxzytddxx#}\");\n  return;\n}\nif(recs[0].get('STATUS')==='运行中'){\n//      Ext.MessageBox.alert('提示', '运行中的订单不能删除!');\n    Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_yxzdddbnsc#}\") ;\n     return;\n}\n// Wb.confirm('确定要删除选择的 ' + recs.length + ' 条记录吗？', function() {\nWb.confirm('{#wf_wfDemo_qdyscxzd#} ' + recs.length + ' {#wf_wfDemo_tjlm#}', function() {\n  Wb.request({\n    url: 'm?xwl=xip/wf/wfDemo/DATA/deleteList', \n    params: Wb.apply({\n      destroy: Wb.getData(recs)\n    }),\n    success: function() {\n      Wb.remove(app.grid1, recs);\n//       Ext.Msg.alert('提示','删除成功！');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_sccg#}\") ;\n    }\n  });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_addAttachment#}","itemId":"addAttachment","iconCls":"attach_icon"},"events":{"click":"//test();\nvar rows = app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n   if(rows[0].data.PO_ID !== ''){\n    Xip.showAttachmentManager('{#XIP.userId#}',rows[0].data.PO_ID,rows[0].data.ORG_ID,'TEST_LQP',rows[0].data.PO_NO,'Y','Y','Y',function(){},30); \n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_item7#}","hidden":"true","itemId":"item7"},"children":[{"configs":{"text":"{#wf_wfDemo_startProcByProcCode#}","hidden":"false","itemId":"startProcByProcCode","iconCls":"start_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE === ''){       \n        XipWf.createInstanceByProcess('XIP_WF_DEMO',function(e){\n            Ext.Msg.hide();\n            if(e.flag == \"1\"){\n               //  Ext.Msg.alert('提示','创建流程实例失败,原因：'+e.msg);\n                Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_cjlcslsbyy#}\"+e.msg) ;\n            }else if(e.flag == \"0\"){\n                // Ext.Msg.alert('提示','流程实例创建成功,流程实例编码：'+e.instanceCode);\n              Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_lcslcjcglcslbm#}\"+e.instanceCode) ;\n                 Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: \n                             [{PO_ID     :  rows[0].data.PO_ID,\n                               INST_CODE :  e.instanceCode,\n                               APP_IP\t:\t'{#appIP#}'}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n            }\n        });\n      }else{\n       //  Ext.Msg.alert('提示','请选择一条未创建的流程实例');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytwcjdlcsl#}\") ;\n      }\n  }else{\n     // Ext.Msg.alert('提示','请先保存数据');\n     Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_startProcByEntityCode#}","hidden":"true","itemId":"startProcByEntityCode","iconCls":"start_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//  Ext.Msg.alert('提示','请选择一条订单信息');\n    Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n        var json = {\n          \tAMT\t\t:\trows[0].data.AMT,\n          \tPO_DESC\t:\trows[0].data.PO_DESC,\n          \tPO_NO\t:\trows[0].data.PO_NO,\n         \te_org\t:\trows[0].data.ORG_ID,\n          \te_dept\t:\trows[0].data.DEPT_ID,\n          \te_business_id\t:\trows[0].data.PO_ID,\n          \tAPP_IP\t:\t'{#appIP#}'\n        };\n         if(rows[0].data.AMT === ''||rows[0].data.AMT ===null){\n         //  Ext.Msg.alert('提示','请填写完整的订单行信息！');\n              Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",'{#wf_wfDemo_qtxwzdddhxx#}');\n        \n          \n           return;\n        }\n        \n        //2.通过entityCode创建实例\n        XipWf.createInstanceByEntity('XIP_DEMO',json,function(e){\n            if(e.flag === \"1\"){\n              //   Ext.Msg.alert('提示','创建流程实例失败,原因：'+e.msg);\n                Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_cjlcslsbyy#}\"+e.msg) ;\n            }else if(e.flag === \"0\"){\n                // Ext.Msg.alert('提示','流程实例创建成功,流程实例编码：'+e.instanceCode);\n                Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_lcslcjcglcslbm#}\"+e.instanceCode) ;\n            \n                 //saveInstanceCode_ajax.request({PO_ID:rows[0].data.PO_ID,INST_CODE:e.instanceCode});\n                 Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n            }\n        });\n      }else{\n        // Ext.Msg.alert('提示','请选择一条未创建的流程实例');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytwcjdlcsl#}\") ;\n      }\n  }else{\n     // Ext.Msg.alert('提示','请先保存数据');\n     Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"根据流程编码启动","hidden":"true","itemId":"startByProcess"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE === ''){       \n        XipWf.createInstanceByProcess('XIP_WF_DEMO',function(e){\n            Ext.Msg.hide();\n            if(e.flag == \"1\"){\n                 Ext.Msg.alert('提示','创建流程实例失败,原因：'+e.msg);\n            }else if(e.flag == \"0\"){\n                 Ext.Msg.alert('提示','流程实例创建成功,流程实例编码：'+e.instanceCode);\n                 Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: \n                             [{PO_ID     :  rows[0].data.PO_ID,\n                               INST_CODE :  e.instanceCode,\n                               APP_IP\t:\t'{#appIP#}'}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n            }\n        });\n      }else{\n         Ext.Msg.alert('提示','请选择一条未创建的流程实例');\n      }\n  }else{\n      Ext.Msg.alert('提示','请先保存数据');\n  }\n}"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"根据实体编码启动","hidden":"true","itemId":"startByEntity"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n        var json = {\n          \tAMT\t\t:\trows[0].data.AMT,\n          \tPO_DESC\t:\trows[0].data.PO_DESC,\n          \tPO_NO\t:\trows[0].data.PO_NO,\n         \te_org\t:\trows[0].data.ORG_ID,\n          \te_dept\t:\trows[0].data.DEPT_ID,\n          \te_business_id\t:\trows[0].data.PO_ID,\n          \tAPP_IP\t:\t'{#appIP#}'\n        };\n         if(rows[0].data.AMT === ''||rows[0].data.AMT ===null){\n           Ext.Msg.alert('提示','请填写完整的订单行信息！');\n           return;\n        }\n        \n        //2.通过entityCode创建实例\n        XipWf.createInstanceByEntity('XIP_DEMO',json,function(e){\n            if(e.flag === \"1\"){\n                 Ext.Msg.alert('提示','创建流程实例失败,原因：'+e.msg);\n            }else if(e.flag === \"0\"){\n                 Ext.Msg.alert('提示','流程实例创建成功,流程实例编码：'+e.instanceCode);\n                 //saveInstanceCode_ajax.request({PO_ID:rows[0].data.PO_ID,INST_CODE:e.instanceCode});\n                 Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n            }\n        });\n      }else{\n         Ext.Msg.alert('提示','请选择一条未创建的流程实例');\n      }\n  }else{\n      Ext.Msg.alert('提示','请先保存数据');\n  }\n}"},"children":[],"expanded":false,"type":"item"}],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_submitProcess#}","hidden":"true","itemId":"itemsubmit"},"children":[{"configs":{"text":"{#wf_wfDemo_submitProcessByProcess#}","itemId":"submitProcessByProcess"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n//           Ext.Msg.alert('提示','请选择一条已创建的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytyjcjdlcsldsj#}\") ;\n      }\n    else if(Ext.isEmpty(rows[0].data.STATUS) || rows[0].data.STATUS === '起草'||rows[0].data.ATTRIBUTE10==='D'){\n        //提交流程\n        var json = {AMT\t\t:\trows[0].data.AMT,\n                    PO_DESC\t:\trows[0].data.PO_DESC,\n                    PO_NO\t:\trows[0].data.PO_NO,\n                    APP_IP\t:\t'{#appIP#}',\n                    e_org\t:\trows[0].data.ORG_ID,\n                    e_dept\t:\trows[0].data.DEPT_ID,\n                    e_business_id\t:\trows[0].data.PO_ID,\n                    e_business_code\t:\trows[0].data.PO_NO,\n                    e_business_name\t:\trows[0].data.PO_DESC,\n                    e_submitter_comment\t:\t'待办驳回重新提交'};\n        XipWf.submitInstance(rows[0].data.INST_CODE,json,function(e){\n          if(e.flag === 0){\n           app.grid1.store.reload();\n          }else if(e.flag === 1){\n//             Ext.Msg.alert('提示',e.msg);\n            Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          }else{\n          }\n        },null);\n      }\n    //撤回的流程重新提交按流程编码启动并提交\n    else if(rows[0].data.ATTRIBUTE10==='R'){\n        var json1 = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartAndSubmitByProcess(rows[0].data.INST_CODE,'XIP_WF_DEMO',json1,function(e){\n          //Ext.Msg.alert('提示',e.msg);\n          app.grid1.store.reload();\n        });\n      \n      }\n    else {\n//         Ext.Msg.alert('提示','请重新选择！');\n        Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qcxxz#}\") ;\n        return false;\n      }\n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_submitProcessByEntity#}","itemId":"submitProcessByEntity"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n//           Ext.Msg.alert('提示','请选择一条已创建的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytyjcjdlcsldsj#}\") ;\n      }else if(Ext.isEmpty(rows[0].data.STATUS) || rows[0].data.STATUS === '起草'||rows[0].data.ATTRIBUTE10==='D'){\n        //提交流程\n        var json = {AMT\t\t:\trows[0].data.AMT,\n                    PO_DESC\t:\trows[0].data.PO_DESC,\n                    PO_NO\t:\trows[0].data.PO_NO,\n                    APP_IP\t:\t'{#appIP#}',\n                    e_org\t:\trows[0].data.ORG_ID,\n                    e_dept\t:\trows[0].data.DEPT_ID,\n                    e_business_id\t:\trows[0].data.PO_ID,\n                    e_business_code\t:\trows[0].data.PO_NO,\n                    e_business_name\t:\trows[0].data.PO_DESC,\n                    e_submitter_comment\t:\t'待办驳回重新提交'};\n        XipWf.submitInstance(rows[0].data.INST_CODE,json,function(e){\n          if(e.flag === 0){\n           app.grid1.store.reload();\n          }else if(e.flag === 1){\n//             Ext.Msg.alert('提示',e.msg);\n            Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          }else{\n          }\n        },null);\n      }\n    //撤回的流程重新提交按实体编码启动并提交\n    else if(rows[0].data.ATTRIBUTE10==='R'){\n        var json1 = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartAndSubmitByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json1, function(e){\n          //Ext.Msg.alert('提示',e.msg);\n          app.grid1.store.reload();\n        });\n   }else {\n//         Ext.Msg.alert('提示','请重新选择！');\n        Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qcxxz#}\") ;\n        return false;\n      }\n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"},{"configs":{"hidden":"true","itemId":"submitProcess2","iconCls":"ok_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n          Ext.Msg.alert('提示','请选择一条已创建的流程实例的数据');\n      }else if(Ext.isEmpty(rows[0].data.STATUS) || rows[0].data.STATUS === '起草'||rows[0].data.ATTRIBUTE10==='D'){\n        //提交流程\n        var json = {AMT\t\t:\trows[0].data.AMT,\n                    PO_DESC\t:\trows[0].data.PO_DESC,\n                    PO_NO\t:\trows[0].data.PO_NO,\n                    APP_IP\t:\t'{#appIP#}',\n                    e_org\t:\trows[0].data.ORG_ID,\n                    e_dept\t:\trows[0].data.DEPT_ID,\n                    e_business_id\t:\trows[0].data.PO_ID,\n                    e_business_code\t:\trows[0].data.PO_NO,\n                    e_business_name\t:\trows[0].data.PO_DESC,\n                    e_submitter_comment\t:\t'待办驳回重新提交'};\n        XipWf.submitInstance(rows[0].data.INST_CODE,json,function(e){\n          if(e.flag === 0){\n           app.grid1.store.reload();\n          }else if(e.flag === 1){\n            Ext.Msg.alert('提示',e.msg);\n          }else{\n          }\n        },null);\n      }else {\n        Ext.Msg.alert('提示','请重新选择！');\n        return false;\n      }\n  }else{\n      Ext.Msg.alert('提示','请先保存数据');\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"按实体编码提交流程","hidden":"true","itemId":"submitProcess3","iconCls":"ok_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n          Ext.Msg.alert('提示','请选择一条已创建的流程实例的数据');\n      }else if(Ext.isEmpty(rows[0].data.STATUS) || rows[0].data.STATUS === '起草'||rows[0].data.ATTRIBUTE10==='D'){\n        //提交流程\n        var json = {AMT\t\t:\trows[0].data.AMT,\n                    PO_DESC\t:\trows[0].data.PO_DESC,\n                    PO_NO\t:\trows[0].data.PO_NO,\n                    APP_IP\t:\t'{#appIP#}',\n                    e_org\t:\trows[0].data.ORG_ID,\n                    e_dept\t:\trows[0].data.DEPT_ID,\n                    e_business_id\t:\trows[0].data.PO_ID,\n                    e_business_code\t:\trows[0].data.PO_NO,\n                    e_business_name\t:\trows[0].data.PO_DESC,\n                    e_submitter_comment\t:\t'待办驳回重新提交'};\n        XipWf.submitInstance(rows[0].data.INST_CODE,json,function(e){\n          if(e.flag === 0){\n           app.grid1.store.reload();\n          }else if(e.flag === 1){\n            Ext.Msg.alert('提示',e.msg);\n          }else{\n          }\n        },null);\n      }else {\n        Ext.Msg.alert('提示','请重新选择！');\n        return false;\n      }\n  }else{\n      Ext.Msg.alert('提示','请先保存数据');\n  }\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"item"},{"configs":{"text":"{#wf_wfDemo_startAndsubmitProcess#}","itemId":"item8"},"children":[{"configs":{"text":"按流程编码启动并提交流程","hidden":"true","itemId":"startAndsubmitProcessByProcess","iconCls":"check_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null|| rows[0].data.INST_CODE === ''){\n          //按实体编码启动并提交流程\n         var json = {\n             AMT\t\t\t:\trows[0].data.AMT,\n           \t APP_IP\t\t\t:\t'{#appIP#}',\n             PO_DESC\t\t:\trows[0].data.PO_DESC,\n             PO_NO\t\t\t:\trows[0].data.PO_NO,\n             e_org\t\t\t:\trows[0].data.ORG_ID,\n             e_dept\t\t\t:\trows[0].data.DEPT_ID,\n             e_business_id\t:\trows[0].data.PO_ID,\n             e_business_code:\trows[0].data.PO_NO,\n             e_business_name:\trows[0].data.PO_DESC\n         };\n        \n        XipWf.startAndSubmitByProcess('XIP_WF_DEMO',json,function(e){\n          if(e.flag === 0){\n             Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,LAST_UPDATED_BY:'{#userId#}',INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n          }else if(e.flag === 1){\n            Ext.Msg.alert(\"提示\",e.msg) ;\n          }else{\n          }\n        });\n        \n        /*XipWf.startAndSubmitByEntity('XIP_DEMO',json,function(e){\n          if(e.flag === 0){\n//              var pjson = {\n//                  PO_ID\t\t\t\t:\trows[0].data.PO_ID,\n//                  LAST_UPDATED_BY\t:\t'{#userId#}',\n//                  INST_CODE\t\t\t:\te.instanceCode\n//              } ;\n//              saveInstanceCode_ajax.request(pjson);\n             Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,LAST_UPDATED_BY:'{#userId#}',INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n          }else if(e.flag === 1){\n            Ext.Msg.alert(\"提示\",e.msg) ;\n          }else{\n          }\n        });*/\n        \n      }else{\n         Ext.Msg.alert('提示','此订单已启动流程,请确认！');\n      }\n  }else{\n      Ext.Msg.alert('提示','请保存订单数据信息后再启动流程！');\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"按实体编码启动并提交流程","hidden":"true","itemId":"startAndsubmitProcess","iconCls":"check_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null|| rows[0].data.INST_CODE === ''){\n          //按实体编码启动并提交流程\n         var json = {\n             AMT\t\t\t:\trows[0].data.AMT,\n           \t APP_IP\t\t\t:\t'{#appIP#}',\n             PO_DESC\t\t:\trows[0].data.PO_DESC,\n             PO_NO\t\t\t:\trows[0].data.PO_NO,\n             e_org\t\t\t:\trows[0].data.ORG_ID,\n             e_dept\t\t\t:\trows[0].data.DEPT_ID,\n             e_business_id\t:\trows[0].data.PO_ID,\n             e_business_code:\trows[0].data.PO_NO,\n             e_business_name:\trows[0].data.PO_DESC\n         };\n        \n        XipWf.startAndSubmitByEntity('XIP_DEMO',json,function(e){\n          if(e.flag === 0){\n//              var pjson = {\n//                  PO_ID\t\t\t\t:\trows[0].data.PO_ID,\n//                  LAST_UPDATED_BY\t:\t'{#userId#}',\n//                  INST_CODE\t\t\t:\te.instanceCode\n//              } ;\n//              saveInstanceCode_ajax.request(pjson);\n             Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,LAST_UPDATED_BY:'{#userId#}',INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n          }else if(e.flag === 1){\n            Ext.Msg.alert(\"提示\",e.msg) ;\n          }else{\n          }\n        });\n        \n      }else{\n         Ext.Msg.alert('提示','此订单已启动流程,请确认！');\n      }\n  }else{\n      Ext.Msg.alert('提示','请保存订单数据信息后再启动流程！');\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_startAndsubmitByProcess#}","itemId":"startAndsubmitByProcess"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null|| rows[0].data.INST_CODE === ''){\n          //按实体编码启动并提交流程\n         var json = {\n             AMT\t\t\t:\trows[0].data.AMT,\n             APP_IP\t\t\t:\t'{#appIP#}',\n             PO_DESC\t\t:\trows[0].data.PO_DESC,\n             PO_NO\t\t\t:\trows[0].data.PO_NO,\n             e_org\t\t\t:\trows[0].data.ORG_ID,\n             e_dept\t\t\t:\trows[0].data.DEPT_ID,\n             e_business_id\t:\trows[0].data.PO_ID,\n             e_business_code:\trows[0].data.PO_NO,\n             e_business_name:\trows[0].data.PO_DESC,\n             USERS: ''\n         };\n        \n        XipWf.startAndSubmitByProcess('XIP_WF_DEMO',json,function(e){\n          if(e.flag === 0){\n             Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,LAST_UPDATED_BY:'{#userId#}',INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n          }else if(e.flag === 1){\n//             Ext.Msg.alert(\"提示\",e.msg) ;\n            Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          }else{\n          }\n        });\n        \n        /*XipWf.startAndSubmitByEntity('XIP_DEMO',json,function(e){\n          if(e.flag === 0){\n//              var pjson = {\n//                  PO_ID\t\t\t\t:\trows[0].data.PO_ID,\n//                  LAST_UPDATED_BY\t:\t'{#userId#}',\n//                  INST_CODE\t\t\t:\te.instanceCode\n//              } ;\n//              saveInstanceCode_ajax.request(pjson);\n             Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,LAST_UPDATED_BY:'{#userId#}',INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n          }else if(e.flag === 1){\n            Ext.Msg.alert(\"提示\",e.msg) ;\n          }else{\n          }\n        });*/\n        \n      }\n    \n    else{\n        //撤回的流程重新提交按流程编码启动并提交\n      if(rows[0].data.ATTRIBUTE10==='R'){\n        var json1 = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartAndSubmitByProcess(rows[0].data.INST_CODE,'XIP_WF_DEMO',json1,function(e){\n          //Ext.Msg.alert('提示',e.msg);\n          app.grid1.store.reload();\n        });\n      } else if(Ext.isEmpty(rows[0].data.STATUS) || rows[0].data.STATUS === '起草'||rows[0].data.ATTRIBUTE10==='D'){\n      //提交流程\n        var json = {AMT\t\t:\trows[0].data.AMT,\n                    PO_DESC\t:\trows[0].data.PO_DESC,\n                    PO_NO\t:\trows[0].data.PO_NO,\n                    APP_IP\t:\t'{#appIP#}',\n                    e_org\t:\trows[0].data.ORG_ID,\n                    e_dept\t:\trows[0].data.DEPT_ID,\n                    e_business_id\t:\trows[0].data.PO_ID,\n                    e_business_code\t:\trows[0].data.PO_NO,\n                    e_business_name\t:\trows[0].data.PO_DESC,\n                    e_submitter_comment\t:\t'待办驳回重新提交'};\n        XipWf.submitInstance(rows[0].data.INST_CODE,json,function(e){\n          if(e.flag === 0){\n           app.grid1.store.reload();\n          }else if(e.flag === 1){\n//             Ext.Msg.alert('提示',e.msg);\n            Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          }else{\n          }\n        },null);\n      \n      } else{\n//          Ext.Msg.alert('提示','此订单已启动流程,请确认！');\n        Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_cddyqdlcqqr#}\") ;\n      }\n      }\n  }else{\n//       Ext.Msg.alert('提示','请保存订单数据信息后再启动流程！');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qbcddsjxxhzqdlc#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_startAndsubmitByEntity#}","itemId":"startAndsubmitByEntity"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null|| rows[0].data.INST_CODE === ''){\n          //按实体编码启动并提交流程\n         var json = {\n             AMT\t\t\t:\trows[0].data.AMT,\n           \t APP_IP\t\t\t:\t'{#appIP#}',\n             PO_DESC\t\t:\trows[0].data.PO_DESC,\n             PO_NO\t\t\t:\trows[0].data.PO_NO,\n             e_org\t\t\t:\trows[0].data.ORG_ID,\n             e_dept\t\t\t:\trows[0].data.DEPT_ID,\n             e_business_id\t:\trows[0].data.PO_ID,\n             e_business_code:\trows[0].data.PO_NO,\n             e_business_name:\trows[0].data.PO_DESC\n         };\n        \n        XipWf.startAndSubmitByEntity('XIP_DEMO',json,function(e){\n          if(e.flag === 0){\n//              var pjson = {\n//                  PO_ID\t\t\t\t:\trows[0].data.PO_ID,\n//                  LAST_UPDATED_BY\t:\t'{#userId#}',\n//                  INST_CODE\t\t\t:\te.instanceCode\n//              } ;\n//              saveInstanceCode_ajax.request(pjson);\n             Wb.request({\n                    url: 'm?xwl=xip/wf/wfDemo/DATA/saveInstanceCode', \n                    params: Wb.apply({\n                       array: [{PO_ID:rows[0].data.PO_ID,LAST_UPDATED_BY:'{#userId#}',INST_CODE:e.instanceCode}]\n                    }),\n                    success: function() {\n                       app.grid1.store.reload();\n                    }\n                 });\n          }else if(e.flag === 1){\n//             Ext.Msg.alert(\"提示\",e.msg) ;\n            Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          }else{\n          }\n        });\n        \n      }else{\n       //撤回的流程重新提交按流程编码启动并提交\n      if(rows[0].data.ATTRIBUTE10==='R'){\n        var json1 = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n       XipWf.restartAndSubmitByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json1, function(e){\n          //Ext.Msg.alert('提示',e.msg);\n          app.grid1.store.reload();\n        });\n      }else if(Ext.isEmpty(rows[0].data.STATUS) || rows[0].data.STATUS === '起草'||rows[0].data.ATTRIBUTE10==='D'){\n      //提交流程\n        var json = {AMT\t\t:\trows[0].data.AMT,\n                    PO_DESC\t:\trows[0].data.PO_DESC,\n                    PO_NO\t:\trows[0].data.PO_NO,\n                    APP_IP\t:\t'{#appIP#}',\n                    e_org\t:\trows[0].data.ORG_ID,\n                    e_dept\t:\trows[0].data.DEPT_ID,\n                    e_business_id\t:\trows[0].data.PO_ID,\n                    e_business_code\t:\trows[0].data.PO_NO,\n                    e_business_name\t:\trows[0].data.PO_DESC,\n                    e_submitter_comment\t:\t'待办驳回重新提交'};\n        XipWf.submitInstance(rows[0].data.INST_CODE,json,function(e){\n          if(e.flag === 0){\n           app.grid1.store.reload();\n          }else if(e.flag === 1){\n//             Ext.Msg.alert('提示',e.msg);\n            Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          }else{\n          }\n        },null);\n      \n      }else{\n//          Ext.Msg.alert('提示','此订单已启动流程,请确认！');\n        Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_cddyqdlcqqr#}\") ;\n      }\n      }\n      \n  }else{\n//       Ext.Msg.alert('提示','请保存订单数据信息后再启动流程！');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qbcddsjxxhzqdlc#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"item"},{"configs":{"text":"{#wf_wfDemo_resetProcess#}","hidden":"true","itemId":"item6"},"children":[{"configs":{"text":"根据流程编码重启流程","hidden":"true","itemId":"resetProcessByProcess","iconCls":"resume_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n          Ext.Msg.alert('提示','请选择一条已撤销的流程实例的数据');\n        \n      }else{\n        \n       var json = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartInstanceByProcess(rows[0].data.INST_CODE,'S01',function(){});\n        \n       // XipWf.restartInstanceByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json, function(){});\n        \n        /*XipWf.getProcessIdByEntity('XIP_DEMO',json,function(e){\n              if(e.flag == \"0\"){\n                    XipWf.restartInstanceSubmit(rows[0].data.INST_CODE,e.processId,json,function(data){\n                          app.grid1.store.load();\n                    });\n              }else if(e.flag == \"1\"){\n                 Ext.Msg.alert('提示',e.msg);\n              }\n        });*/\n      } \n  }else{\n      Ext.Msg.alert('提示','请先保存数据');\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"根据实体编码重启流程","hidden":"true","itemId":"resetProcessByEntity","iconCls":"resume_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Ext.Msg.alert('提示','请选择一条订单信息');\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n          Ext.Msg.alert('提示','请选择一条已撤销的流程实例的数据');\n        \n      }else{\n        \n       var json = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartInstanceByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json, function(){});\n        \n        /*XipWf.getProcessIdByEntity('XIP_DEMO',json,function(e){\n              if(e.flag == \"0\"){\n                    XipWf.restartInstanceSubmit(rows[0].data.INST_CODE,e.processId,json,function(data){\n                          app.grid1.store.load();\n                    });\n              }else if(e.flag == \"1\"){\n                 Ext.Msg.alert('提示',e.msg);\n              }\n        });*/\n      } \n  }else{\n      Ext.Msg.alert('提示','请先保存数据');\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_resetByProcess#}","itemId":"resetByProcess"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n//           Ext.Msg.alert('提示','请选择一条已撤销的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytycxdlcsldsj#}\") ;\n        \n      }else{\n        //驳回结束和正常结束的流程都不可重新启动\n        if(rows[0].data.ATTRIBUTE10==='D'||rows[0].data.ATTRIBUTE10==='E'){\n//           Ext.Msg.alert('提示','不可重新启动!');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_bkcxqd#}\") ;\n          return;\n        }\n        \n       var json = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartInstanceByProcess(rows[0].data.INST_CODE,'S01',function(e){\n          if(e.flag==='0'){\n              //将改变状态\n              var updateJson = {po_id:rows[0].data.PO_ID};\n              Wb.request({\n                 url :'m?xwl=xip/wf/wfDemo/DATA/updateStatus',\n                 params: updateJson,\n                 success:function(){\n                   app.grid1.store.load();\n                 }\n              });\n          }\n          \n        });\n        \n       // XipWf.restartInstanceByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json, function(){});\n        \n        /*XipWf.getProcessIdByEntity('XIP_DEMO',json,function(e){\n              if(e.flag == \"0\"){\n                    XipWf.restartInstanceSubmit(rows[0].data.INST_CODE,e.processId,json,function(data){\n                          app.grid1.store.load();\n                    });\n              }else if(e.flag == \"1\"){\n                 Ext.Msg.alert('提示',e.msg);\n              }\n        });*/\n      } \n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_resetByEntity#}","itemId":"resetByEntity"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n//           Ext.Msg.alert('提示','请选择一条已撤销的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytycxdlcsldsj#}\") ;\n        \n      }else{\n        //驳回结束和正常结束的流程都不可重新启动\n        if(rows[0].data.ATTRIBUTE10==='D'||rows[0].data.ATTRIBUTE10==='E'){\n//           Ext.Msg.alert('提示','不可重新启动!');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_bkcxqd#}\") ;\n          return;\n        }\n       var json = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartInstanceByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json, function(e){\n            if(e.flag==='0'){\n              //将改变状态\n              var updateJson = {po_id:rows[0].data.PO_ID};\n              Wb.request({\n                 url :'m?xwl=xip/wf/wfDemo/DATA/updateStatus',\n                 params: updateJson,\n                 success:function(){\n                   app.grid1.store.load();\n                 }\n              });\n            }\n        });\n        \n        /*XipWf.getProcessIdByEntity('XIP_DEMO',json,function(e){\n              if(e.flag == \"0\"){\n                    XipWf.restartInstanceSubmit(rows[0].data.INST_CODE,e.processId,json,function(data){\n                          app.grid1.store.load();\n                    });\n              }else if(e.flag == \"1\"){\n                 Ext.Msg.alert('提示',e.msg);\n              }\n        });*/\n      } \n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"item"},{"configs":{"text":"{#wf_wfDemo_item17#}","hidden":"true","itemId":"item17"},"children":[{"configs":{"text":"{#wf_wfDemo_resetAndSummitByProcess#}","itemId":"resetAndSummitByProcess"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n//           Ext.Msg.alert('提示','请选择一条已撤销的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytycxdlcsldsj#}\") ;\n        \n      }else{\n        \n       var json = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartAndSubmitByProcess(rows[0].data.INST_CODE,'XIP_WF_DEMO',json,function(e){\n          //Ext.Msg.alert('提示',e.msg);\n          app.grid1.store.reload();\n        });\n      } \n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#wf_wfDemo_resetAndSummitByEntity#}","itemId":"resetAndSummitByEntity"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE===''){\n//           Ext.Msg.alert('提示','请选择一条已撤销的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytycxdlcsldsj#}\") ;\n        \n      }else{\n        \n       var json = {\n         AMT\t\t\t:\trows[0].data.AMT,\n         APP_IP\t\t\t:\t'{#appIP#}',\n         PO_DESC\t\t:\trows[0].data.PO_DESC,\n         PO_NO\t\t\t:\trows[0].data.PO_NO,\n         e_org\t\t\t:\trows[0].data.ORG_ID,\n         e_dept\t\t\t:\trows[0].data.DEPT_ID,\n         e_business_id\t:\trows[0].data.PO_ID,\n         e_business_code:\trows[0].data.PO_NO,\n         e_business_name:\trows[0].data.PO_DESC};\n        \n        XipWf.restartAndSubmitByEntity(rows[0].data.INST_CODE, 'XIP_DEMO', json, function(e){\n          //Ext.Msg.alert('提示',e.msg);\n          app.grid1.store.reload();\n        });\n      } \n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"item"},{"configs":{"text":"{#wf_wfDemo_revokeProcess#}","itemId":"revokeProcess","iconCls":"cancel_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n  return false ;\n}\nif(rows[0].data.ID !== ''){\n      if(rows[0].data.INST_CODE === null||rows[0].data.INST_CODE ===''){\n//           Ext.Msg.alert('提示','此订单未启动流程,请确认!');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_cddlcwqdqqr#}\") ;\n          return false ;\n      }else if(rows[0].data.ATTRIBUTE10 === 'A'){\n//         Ext.Msg.alert('提示','该订单的流程未提交,请重新选择!');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_gddlcwtjqcxxz#}\") ;\n        return false;\n      }else{\n         //撤回流程\n        XipWf.revokeByInstance(rows[0].data.INST_CODE,function(e){\n//           Ext.Msg.alert('提示',e.msg);\n          Ext.Msg.alert('{#wf_wfDemo_prompt#}',e.msg);\n          app.grid1.store.reload();\n        });\n      }\n  }else{\n//       Ext.Msg.alert('提示','请先保存订单信息,再启动流程!');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qbcddsjxxhzqdlc#}\") ;\n  }\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_openProcessMonitor#}","itemId":"openProcessMonitor","iconCls":"viewport_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!=1){\n//   Ext.Msg.alert('提示','请选择一条订单信息');\n  Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytddxx#}\") ;\n}else{\n  if(rows[0].data.PO_ID !== ''){\n      if(rows[0].data.INST_CODE === null){\n//           Ext.Msg.alert('提示','请选择一条已创建的流程实例的数据');\n          Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxzytyjcjdlcsldsj#}\") ;\n      }else{\n          //提交流程\n        XipWf.showMonitorPage(rows[0].data.INST_CODE);\n      }   \n  }else{\n//       Ext.Msg.alert('提示','请先保存数据');\n      Ext.Msg.alert(\"{#wf_wfDemo_prompt#}\",\"{#wf_wfDemo_qxbcsj#}\") ;\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#wf_wfDemo_setColumnSort#}","hidden":"true","itemId":"setColumnSort","iconCls":"sort_by_name_icon"},"events":{"click":"initColumnMoveSortWin(app.grid1);"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PO_ID#}","hidden":"true","dataIndex":"PO_ID","itemId":"PO_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PO_NO#}","width":"150","dataIndex":"PO_NO","itemId":"PO_NO_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PO_DESC#}","width":"150","dataIndex":"PO_DESC","itemId":"PO_DESC_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_VENDOR#}","dataIndex":"VENDOR","itemId":"VENDOR_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_ORG_ID#}","hidden":"true","dataIndex":"ORG_ID","itemId":"ORG_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_ORG_NAME_01#}","dataIndex":"ORG_NAME","itemId":"ORG_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_DEPT_ID#}","hidden":"true","dataIndex":"DEPT_ID","itemId":"DEPT_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_DEPT_NAME_01#}","dataIndex":"DEPT_NAME","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_BUYER#}","dataIndex":"BUYER","itemId":"BUYER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_AMT_01#}","dataIndex":"AMT","itemId":"AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_PO_DATE#}","dataIndex":"PO_DATE","itemId":"PO_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#wf_wfDemo_status#}","dataIndex":"STATUS","itemId":"STATUS_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/wf/wfDemo/DATA/listStore"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"grid"}],"expanded":false,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}