{"inframe":false,"title":"个人设置","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/pub/navigator/portalCommon\");\nrequest.setAttribute(\"contextPath\",request.getContextPath());\nvar userObj = request.getSession().getAttribute(\"XzSessionVars\");\nvar ctxPath = request.getContextPath() ;\nif(userObj !== null){\n  var userId = request.getSession().getAttribute(\"XzSessionVars\").get('userId');\n  var userName = request.getSession().getAttribute(\"XzSessionVars\").get('userName');\n  var empName = request.getSession().getAttribute(\"XzSessionVars\").get('empName');\n  var authModel = request.getSession().getAttribute(\"XzSessionVars\").get('AUTH_MODAL');\n  var roleId = request.getSession().getAttribute(\"XzSessionVars\").get('roleId');\n  var roleName = request.getSession().getAttribute(\"XzSessionVars\").get('roleName');\n  var roleCode = request.getSession().getAttribute(\"XzSessionVars\").get('roleCode');\n  request.setAttribute(\"userId\",userId);\n  request.setAttribute(\"userName\",userName);\n  request.setAttribute(\"empName\",empName);\n\n  request.setAttribute(\"authModel\",authModel);\n  request.setAttribute(\"roleId\",roleId);\n  request.setAttribute(\"roleName\",roleName);\n  request.setAttribute(\"roleCode\",roleCode);\n  request.setAttribute(\"contextPath\",ctxPath);\n}","itemId":"module"},"events":{"finalize":"var skinValue = '';\nvar navigatorValue = '';\n\nExt.Ajax.request({\n  url : '{#contextPath#}' +'/m?xwl=xip/pub/navigator/data/getPersonalset',\n  async: false, //发送同步请求\n  method: 'POST',\n  success: function(response,options){\n    var resp = Ext.JSON.decode(response.responseText);\n\tvar val = resp.VAL;\n    \n    //{skin:'classic', navigator:'menu'}\n    if(!Ext.isEmpty(val)){\n      eval('var retuJson = ' + val);\n\n      if(!Ext.isEmpty(retuJson.skin)){\n        skinValue = retuJson.skin;\n        app.skinCombox.setValue(skinValue);\n      }\n\n      if(!Ext.isEmpty(retuJson.navigator)){\n        navigatorValue = retuJson.navigator;\n        app.navigatorCombox.setValue(navigatorValue);\n      }\n    }\n  },\n  failure: function(response,options){\n  }\n});","initialize":"Ext.apply(app, {\n  initWin : function(params) {\n    app.personalSetWin.show();\n  }\n});"},"children":[{"configs":{"title":"{#lang_person_set_title#}","autoShow":"false","height":"'{#authModel#}'=='ROLE'?195:165","width":"350","layout":"fit","buttonAlign":"center","dialog":"false","itemId":"personalSetWin","modal":"true"},"children":[{"configs":{"frame":"true","layout":"form","bodyPadding":"20 30 20 20","itemId":"personalSetForm"},"children":[{"configs":{"labelWidth":"{#lang_pwd_label_width#}","pickList":"[['classic','{#lang_person_skin_classic#}'],['gray','{#lang_person_skin_gray#}'],['neptune','{#lang_person_skin_neptune#}']]","labelAlign":"right","itemId":"skinCombox","fieldLabel":"{#lang_person_set_outlook#}"},"children":[],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"{#lang_pwd_label_width#}","pickList":" [['menu','{#lang_navitor_menu_model#}'],['tree','{#lang_navitor_tree_model#}'],['accordion','{#lang_navitor_accordion_model#}']]","labelAlign":"right","itemId":"navigatorCombox","fieldLabel":"{#lang_person_navi_model#}"},"children":[],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"{#lang_pwd_label_width#}","displayField":"ROLE_NAME","hidden":"'{#authModel#}'=='ROLE'?false:true","valueField":"ROLE_ID","labelAlign":"right","itemId":"defaultRoleCombox","fieldLabel":"{#lang_person_default_role#}"},"children":[{"configs":{"autoLoad":"'{#authModel#}'=='ROLE'?true:false","itemId":"store","url":"m?xwl=xip/pub/navigator/data/getRole"},"events":{"load":"for(var i=0; i<store.getCount(); i++){\n  var reocrd = store.getAt(i);\n  if(reocrd.get('ISDEFAUT') == 'Y'){\n    app.defaultRoleCombox.setValue(reocrd.get('ROLE_ID'));\n    break;\n  }\n}","beforeload":"store.getProxy().extraParams.userId = '{#userId#}';"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"form"},{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#lang_common_save_btn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"var skin = app.skinCombox.getValue();\nvar navigator = app.navigatorCombox.getValue();\n\nif(Ext.isEmpty(skin)){\n  skin = '';\n}\n\nif(Ext.isEmpty(navigator)){\n  navigator = '';\n}\n\nvar val = \"{skin:'\"+skin+\"', navigator:'\"+navigator+\"'}\";\n\nExt.Msg.wait('{#lang_person_saving_msg#}');\n\nif(!Ext.isEmpty(app.defaultRoleCombox.getValue())){\n  // 提交请求\n  Ext.Ajax.request({\n    url : '{#contextPath#}' + '/frameAction.do?method=saveDefaultRole',\n    params  : {\n      'roleId' : app.defaultRoleCombox.getValue()\n    },\n    async:false,\n    method  : 'post',\n    timeout : 3600000,\n    success : function(response, options) {\n      /*var response =Ext.JSON.decode(response.responseText);\n      if(response.flag==1){\n        if('true'===isResetPassword||'true'===isIneffective){\n          window.location.href=\"{#contextPath#}/m?xwl=xip/login/modifyPasswordWithoutValidate&url=\"+enUrl;\t\n        }else{\n          window.location.href=url;\t\n        }\n      }else{\n        Ext.Msg.alert(\"提示\", response.msg);\n      }*/\n      \n      if(Ext.isEmpty(skin) && Ext.isEmpty(navigator)){\n        Ext.Msg.hide();\n        window.location = '{#contextPath#}/frame/navigator.jsp';\n        return;\n      }\n      \n    },\n    failure : function(reponse, options) {\n    }\n  });\n}\n\nif(Ext.isEmpty(skin) && Ext.isEmpty(navigator)){\n  Ext.Msg.hide();\n  return;\n}\n\nExt.Ajax.request({\n  url: '{#contextPath#}/m?xwl=xip/pub/navigator/data/savePersonlSet',\n  method: 'POST',\n  params:{'skin':skin, 'navigator':navigator, 'val':val},\n  success: function(response,options){\n    Ext.Msg.hide();\n    window.location = '{#contextPath#}/frame/navigator.jsp';\n   \n  },\n  failure: function(response,options){\n    Ext.Msg.hide();\n    Wb.info('{#lang_person_server_response#}');\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#lang_common_cancel_btn#}","itemId":"cleanBtn","iconCls":"delete_icon"},"events":{"click":"Ext.Msg.wait('{#lang_person_clear_tip#}');\nExt.Ajax.request({\n  url: '{#contextPath#}/m?xwl=xip/pub/navigator/data/cleanPersonalSet',\n  method: 'POST',\n  success: function(response,options){\n    Ext.Msg.hide();\n    window.location = '{#contextPath#}/frame/navigator.jsp';\n  },\n  failure: function(response,options){\n    Ext.Msg.hide();\n    Wb.info('{#lang_person_server_response#}');\n  }\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}