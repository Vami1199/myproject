{"inframe":false,"title":"创建自定义组件","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"com.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","loginRequired":"false","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/pub/navigator/portalNavigator/portalExplorer\");","itemId":"module"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"defineGridStore","url":"m?xwl=xip/pub/navigator/portalNavigator/data/getAllDefineUnits"},"events":{"beforeload":"if(Ext.isEmpty(app.queryName.getValue())){\n  store.getProxy().extraParams.WHERESQL=' AND 1=1';\n}else{\n  store.getProxy().extraParams.WHERESQL=' AND DEIFNE_UNIT_NAME LIKE \\'%'+app.queryName.getValue()+'%\\'';\n}"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"defineColumns"},"children":[{"configs":{"align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"DEIFNE_ROW_NUM"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"DEIFNE_UNIT_ID","itemId":"DEFINE_UNIT_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#lang_define_unit_name#}","dataIndex":"DEIFNE_UNIT_NAME","itemId":"DEFINE_UNIT_NAME","flex":"5"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#lang_define_necessary_desc#}","dataIndex":"DEIFNE_UNIT_DESC","itemId":"DEFINE_UNIT_DESC","flex":"6"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#lang_define_nor_type#}","dataIndex":"DEIFNE_UNIT_TYPE","itemId":"DEFINE_UNIT_TYPE","flex":"4"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#lang_define_nor_height#}","dataIndex":"DEIFNE_UNIT_HEIGHT","itemId":"DEFINE_UNIT_HEIGHT","flex":"4"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#lang_define_nor_level#}","dataIndex":"DEIFNE_UNIT_LEVEL","itemId":"DEFINE_UNIT_LEVEL","renderer":"if(value === 'S'){\n  return '{#lang_define_sys_level#}';\n}else{\n  return '{#lang_define_def_leve#}';\n}","flex":"4"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#lang_define_nor_enable#}","dataIndex":"DEFINE_UNIT_ENABLE","itemId":"DEFINE_UNIT_ENABLE","renderer":"if(value === 'Y'){\n  return '<font color=\"green\">{#lang_define_y#}<\/font>';\n}else{\n  return '<font color=\"red\">{#lang_define_n#}<\/font>';\n}","flex":"2"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"layout":"border","itemId":"viewport"},"children":[{"configs":{"region":"north","frame":"true","height":"80","style":"border-width:0px","layout":"fit","border":"false","itemId":"componentForm"},"children":[{"configs":{"title":"{#lang_define_condition_title#}","style":"padding-top:8px","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"{#lang_define_label_width#}","labelAlign":"right","itemId":"queryName","fieldLabel":"{#lang_define_unit_name#}"},"events":{"specialkey":"if(e.getKey() === 13){\n  app.defineGridStore.load();\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#lang_define_query_btn#}","itemId":"queryBtn","iconCls":"seek_icon","x":"5"},"events":{"click":"app.defineGridStore.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#lang_define_reset_btn#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"10"},"events":{"click":"app.componentForm.getForm().reset();\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","store":"app.defineGridStore","columns":"app.defineColumns","itemId":"defineGrid"},"events":{"itemdblclick":"app.modifyItemBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#lang_define_add_btn#}","itemId":"addItemBtn","iconCls":"new_icon"},"events":{"click":" var win = new Ext.window.Window(app._detailWin);\n Wb.setTitle(win, '{#lang_define_add_title#}');\n win.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#lang_define_edit_btn#}","itemId":"modifyItemBtn","iconCls":"table_edit_icon"},"events":{"click":"var _selRecord = app.defineGrid.getSelectionModel().getSelection();\nif(_selRecord.length !== 1){\n  Wb.info('{#lang_define_record_sel#}');\n  return ;\n}\nvar win = new Ext.window.Window(app._detailWin);\nvar flag = _selRecord[0].data.DEFINE_UNIT_ENABLE;\nif(flag=='N'){\n  flag = '{#lang_define_n#}';\n}else{\n  flag = '{#lang_define_y#}';\n}\nWb.setTitle(win, '{#lang_define_edit_title#}');\nvar _editJson ={ unitId  :_selRecord[0].data.DEIFNE_UNIT_ID,\n                 unitName:_selRecord[0].data.DEIFNE_UNIT_NAME,\n                 unitDesc:_selRecord[0].data.DEIFNE_UNIT_DESC,\n                 unitType:_selRecord[0].data.DEIFNE_UNIT_TYPE,\n                 unitHeight:_selRecord[0].data.DEIFNE_UNIT_HEIGHT,\n                 unitConfig:_selRecord[0].data.DEIFNE_UNIT_CONFIG,\n                 unitLevel :_selRecord[0].data.DEIFNE_UNIT_LEVEL,\n                 unitEnable:flag\n               };\nWb.setValue(win,_editJson);\nwin.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":true,"type":"item"},{"configs":{"text":"{#lang_define_del_btn#}","itemId":"delItemBtn","iconCls":"delete_icon"},"events":{"click":"var rows = app.defineGrid.getSelectionModel().getSelection();\nif(rows.length === 0){\n  Wb.info('{#lang_define_delete_sel#}');\n  return ;\n}\nvar hasSystemUnit = false;\nvar delUnitIds = '';\nExt.each(rows,function(item){\n  if(item.data.DEIFNE_UNIT_LEVEL === 'S'){\n    hasSystemUnit = true;\n  }else{\n    delUnitIds +='\\''+item.data.DEIFNE_UNIT_ID+'\\',';\n  }\n});\nif(hasSystemUnit){\n  Wb.info('{#lang_define_no_del#}');\n}else{\n  Wb.confirm('{#lang_define_no_del#}',function(){\n    delUnitIds = delUnitIds.substring(0,delUnitIds.length-1);\n  Wb.request({\n    url:'m?xwl=xip/pub/navigator/portalNavigator/data/deleteDefineUnit',\n    message:'{#waitingMsg#}',\n    params:{'IDS':delUnitIds},\n    success:function(){\n      Wb.info('{#lang_define_del_success#}',function(){\n                 app.defineGridStore.load();\n              });\n    },\n    failure:function(){\n       Wb.error('{#lang_define_del_failure#}');\n    }\n  });\n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"},{"configs":{"height":"270","width":"400","layout":"fit","buttonAlign":"center","dialog":"false","border":"false","itemId":"detailWin","modal":"true","createInstance":"false"},"events":{"afterrender":"if(app.unitLevel.getValue() === 'S'){\n  app.unitSaveBtn.disable();\n}","close":"app.defineGridStore.load();"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#lang_define_save_btn#}","itemId":"unitSaveBtn","iconCls":"save_icon"},"events":{"click":"if(app.detailForm.getForm().isValid() === false){\n  Wb.warn('{#lang_define_all_required#}');\n  return ;\n}\nvar paramsJson ={\n      DEIFNE_UNIT_NAME:app.unitName.getValue(),\n      DEIFNE_UNIT_DESC:app.unitDesc.getValue(),\n      DEIFNE_UNIT_TYPE:app.unitType.getValue(),\n      DEIFNE_UNIT_HEIGHT:app.unitHeight.getValue(),\n      DEIFNE_UNIT_CONFIG:app.unitConfig.getValue(),\n      DEFINE_UNIT_ENABLE:app.unitEnable.getValue(),\n      DEFINE_UNIT_DUPLICATE:'{#lang_define_duplicate#}'\n  };\nif(Ext.isEmpty(app.unitId.getValue())){\n  Wb.request({\n  url:'m?xwl=xip/pub/navigator/portalNavigator/data/insertDefineUnits',\n  message:'{#lang_define_saveing#}',\n  params: paramsJson,\n  success:function(response){\n    var tmpJson = Wb.decode(response.responseText);\n    app.unitId.setValue(tmpJson.primaryKey);\n    app.detailWin.setTitle('{#lang_define_edit_title#}');\n    Wb.info('{#lang_define_save_success#}');\n  }\n});\n}else{\n  paramsJson.DEFINE_UNIT_ID = app.unitId.getValue();\n  Wb.request({\n    url:'m?xwl=xip/pub/navigator/portalNavigator/data/updateDefineUnits',\n    message:'{#lang_define_saveing#}',\n    params: paramsJson,\n    success:function(response){\n     Wb.info('{#lang_define_save_success#}');\n    }\n  });\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#lang_define_cancel_btn#}","itemId":"unitCancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.detailWin.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"frame":"true","style":"border-width:0px","layout":"form","padding":"20px","border":"false","itemId":"detailForm"},"children":[{"configs":{"labelWidth":"{#lang_define_label_width#}","allowBlank":"false","labelAlign":"right","itemId":"unitName","fieldLabel":"{#lang_define_unit_name_n#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"{#lang_define_label_width#}","labelAlign":"right","itemId":"unitDesc","fieldLabel":"{#lang_define_unit_desc#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"{#lang_define_label_width#}","allowBlank":"false","labelAlign":"right","itemId":"unitType","fieldLabel":"{#lang_define_unit_type#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"{#lang_define_label_width#}","allowBlank":"false","minValue":"0","value":"400","labelAlign":"right","itemId":"unitHeight","fieldLabel":"{#lang_define_unit_height#}"},"children":[],"expanded":false,"type":"number"},{"configs":{"labelWidth":"{#lang_define_label_width#}","allowBlank":"false","value":"Y","pickList":"[['Y','{#lang_define_y#}'],['N`','{#lang_define_n#}']]","labelAlign":"right","itemId":"unitEnable","fieldLabel":"{#lang_define_unit_enable#}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"{#lang_define_label_width#}","labelAlign":"right","itemId":"unitConfig","fieldLabel":"{#lang_define_attr_set#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"unitId"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"unitLevel"},"children":[],"expanded":false,"type":"hidden"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}