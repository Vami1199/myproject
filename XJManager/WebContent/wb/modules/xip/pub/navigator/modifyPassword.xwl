{"inframe":false,"title":"修改密码","hidden":true,"roles":{"default":1},"children":[{"configs":{"title":"{#lang_modify_pwd_title#}","loginRequired":"false","initScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/pub/navigator/portalCommon\");\nvar ctxPath = request.getContextPath() ;\nrequest.setAttribute(\"contextPath\",ctxPath);\n\nvar pwdLenLimit= com.xzsoft.xip.platform.util.PlatformUtil.getSystemParamVal(\"PW_LEN_LIMIT\");\nrequest.setAttribute(\"PW_LEN_LIMIT\",pwdLenLimit);\n\nvar pwdIncludeChar =  com.xzsoft.xip.platform.util.PlatformUtil.getSystemParamVal(\"PW_INCLUDE_CHAR\");\nrequest.setAttribute(\"PW_INCLUDE_CHAR\",pwdIncludeChar);","itemId":"module"},"events":{"initialize":"Ext.apply(app, {\n  initWin : function(params) {\n    Ext.apply(app, params);\n    app.modifyPwdWin = new Ext.window.Window(app.modifyPwdWin);\n    app.modifyPwdWin.setTitle(params.title);\n    app.modifyPwdWin.show();\n  }\n});"},"children":[{"configs":{"autoShow":"false","title":"{#lang_modify_pwd_title#}","height":"200","width":"380","layout":"fit","resizable":"false","closeAction":"hide","buttonAlign":"center","border":"false","dialog":"false","itemId":"modifyPwdWin","modal":"true"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#lang_common_save_btn#}","itemId":"pwdSaveBtn","iconCls":"save_icon"},"events":{"click":"var op = app.oldPwd.getValue(); \nif(op === null || op === \"\" || op === \"undefined\"){\n  Wb.info('{#lang_old_pwd_need#}') ;\n  return false;\n}\t\t\t\t\t\nvar np = app.newPwd.getValue(); \nif(np === null || np === \"\" || np === \"undefined\"){\n  Wb.info('{#lang_new_pwd_need#}') ;\n  return false;\n}\nvar cnp = app.confirmNewPwd.getValue();\nvar _tmpLen = '{#PW_LEN_LIMIT#}';\nif(cnp === null || cnp === \"\" || cnp === \"undefined\"){\n  Wb.info('{#lang_confirm_pwd_need#}') ;\n  return false;\t\t\t\t\n}\n\nif(!app.pwdModifyForm.getForm().isValid()){\n  Wb.info('{#lang_pwd_length_error#}') ;\n  return false;\n}\n\nif('{#PW_INCLUDE_CHAR#}'=='Y'){\n  var re = new RegExp(\"[A-Za-z\\x21-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7e]\");\n  if(!re.test(np)){\n    Wb.info('{#lang_valid_pwd_error#}');\n    return;\n  }\n}\nif(!app.pwdModifyForm.getForm().isValid()){\n  if(Ext.isEmpty(_tmpLen) || _tmpLen===0){\n  Wb.warn('{#lang_pwd_less_length#}');\n    return false;\n  }else{\n      Wb.warn('{#lang_pwd_define_length#}'.replace(/\\XAXA/g,_tmpLen));\n    return false;\n  }\n}\n\nif(np != cnp){\n  Wb.info('{#lang_pwd_no_match#}') ;\n  return false;\t\t\t\t\t\n}\n\nExt.Msg.wait('{#lang_pwd_request_process#}');\n\n// 提交请求\nExt.Ajax.request({\n  url :'{#contextPath#}' + '/frameAction.do?method=modifyUserPassword',\n  params: {\n    'oldPwd'  :\tXip.getMD5(op),\n    'password': Xip.getMD5(cnp)\n  },\n  method : 'post',\n  //timeout : 3600000,\n  success : function(response, options) {\n    //Ext.Msg.hide();\n    var resp = Ext.JSON.decode(response.responseText);\n    \n    if(resp.flag == 1){\n      var logoutUrl = resp.logoutUrl ;\n      var callbackUrl = resp.callbackUrl ;\n      // 对于open , window.opener\n      Wb.info('{#lang_pwd_modify_success#}',function(){\n      app.modifyPwdWin.hide();\n      });\n    }else{\n      Wb.info(resp.msg);\n    }\n  },\n  failure : function(reponse, options) {\n    Ext.Msg.hide();\n    var response = Ext.JSON.decode(response.responseText);\n    Wb.info(response.msg);\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#lang_common_close_btn#}","itemId":"pwdCancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.pwdModifyForm.getForm().reset();\napp.modifyPwdWin.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"height":"200","style":"border-width:0px","width":"400","layout":"fit","border":"false","itemId":"pwdModifyForm"},"children":[{"configs":{"frame":"true","border":"false","padding":"18px 30px 0px 20px ","itemId":"pwdModifyPanel"},"children":[{"configs":{"labelWidth":"{#lang_pwd_label_width#}","allowBlank":"false","inputType":"password","labelAlign":"right","itemId":"oldPwd","fieldLabel":"{#lang_modify_old_pwd#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"{#lang_pwd_label_width#}","allowBlank":"false","minLength":"('{#PW_LEN_LIMIT#}'==0 || '{#PW_LEN_LIMIT#}'==null) ? 6: '{#PW_LEN_LIMIT#}'","inputType":"password","labelAlign":"right","itemId":"newPwd","fieldLabel":"{#lang_modify_new_pwd#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"{#lang_pwd_label_width#}","allowBlank":"false","minLength":"('{#PW_LEN_LIMIT#}'==0 || '{#PW_LEN_LIMIT#}'==null) ? 6: '{#PW_LEN_LIMIT#}'","inputType":"password","labelAlign":"right","itemId":"confirmNewPwd","fieldLabel":"{#lang_modify_confirm_pwd#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}