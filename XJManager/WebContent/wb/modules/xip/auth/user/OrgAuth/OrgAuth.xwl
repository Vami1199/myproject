{"inframe":false,"title":"组织授权","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","initScript":"request.setAttribute(\"contextPath\",request.getContextPath());\nrequest.setAttribute(\"delImageSrc\",request.getContextPath()+\"/xip/images/cut.gif\");\n\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/auth/user/OrgAuth/OrgAuth\");","itemId":"module"},"events":{"finalize":"//选中父节点的下的所有子节点\nfunction setChildChecked(parentNode,checked){\n  parentNode.expand();\n  //选中自己\n  parentNode.set({checked:checked});\n  if(parentNode.data.NODE_TYPE === 'F' && checked === true){\n    var tempJson={TARGET_ID:parentNode.get('ID'),ANAME:parentNode.get('text'),TYPE:'F'};\n    app.ADFUgrid.store.add(tempJson);\n  }\n  if(parentNode.data.NODE_TYPE === 'F' && checked === false){\n    var record = app.ADFUgrid.store.findRecord('TARGET_ID',parentNode.get('ID'));\n    app.ADFUgrid.store.remove(record);\n  }\n  //计算选择的数\n \n  allcount1();\n \n  if(parentNode.hasChildNodes){\n    parentNode.eachChild(function(childNode){\n      setChildChecked(childNode,checked);\n    });\n  }\n}\n\n//选中子节点的时候，同时选中父节点\nfunction setParentChecked(childNode,checked){\n  childNode.set({checked:checked});\n  var parentNode = childNode.parentNode;\n  if(parentNode){\n    var flag = false;\n    parentNode.eachChild(function(node){\n      if(node.data.checked === true){\n        flag = true;\n      }\n    });\n    //取消选中时\n    if(checked === false){\n      if(!flag){\n        setParentChecked(parentNode,checked);\n      }  \n    }else{\n      if(flag){\n        setParentChecked(parentNode,checked);\n      }\n    }  \n  }\n  \n}\n\n\n//=============实现树的模糊查找================\nfunction filterBy(text,by,menuFunTree) { \n   clearFilter(menuFunTree);\n    var view = menuFunTree.getView(),\n        me = menuFunTree,\n        nodesAndParents = [];\n    // 找到匹配的节点并展开.\n    // 添加匹配的节点和他们的父节点到nodesAndParents数组.\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n       this.expand();\n        var currNode = this;\n        if (currNode && currNode.data[by] && currNode.data[by].toString().toLowerCase().indexOf(text.toLowerCase()) > -1) {\n            menuFunTree.expandPath(currNode.getPath());\n            while (currNode.parentNode) {\n                nodesAndParents.push(currNode.id);\n                currNode = currNode.parentNode;\n            }\n        }\n    }, null, [menuFunTree, view]);\n\n    // 将不在nodesAndParents数组中的节点隐藏\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n        this.expand();\n        var uiNode = view.getNodeByRecord(this);\n        if (uiNode && !Ext.Array.contains(nodesAndParents, this.id)) {\n            Ext.get(uiNode).setDisplayed('none');\n        }\n    }, null, [menuFunTree, view]);\n}\n\nfunction clearFilter(menuFunTree){\n    var view = menuFunTree.getView();\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n       this.expand();\n        var uiNode = view.getNodeByRecord(this);\n        if (uiNode) {\n            Ext.get(uiNode).setDisplayed('table-row');\n        }\n    }, null, [menuFunTree, view]);\n}\n\n\n","initialize":"var statusO;\nvar statusA;\nvar statusD;\nvar statusU;\nvar statusF;\n//删除右弹框数据\napp.deleteCopyAllFun= function (){ \n  var record=app.ADFUgrid.getSelectionModel().getSelection();\n\n  var type = record[0].get('TYPE');\n\n  app.ADFUgrid.store.remove(record);\n\n  //取出类型进行判断\n  //判断应用\n  var rid=record[0].data.TARGET_ID;\n  if(type=='A'){\n    //点击删除 去掉勾选的对号\n    for(var j=0;j<app.appgrid.store.getCount();j++){\n      var r_id=app.appgrid.store.getAt(j).get('APP_ID');\n      if(rid===r_id){\n\n        app.appgrid.getSelectionModel().deselect(app.appgrid.store.getAt(j));\n        break;\n      }\n\n    }\t\n  }\n  //判断功能树\n  if(type=='F'){\n    var selectLength = app.menuFunctionTree.getChecked().length;\n    for(var f=0;f<selectLength;f++){     \n      var res=app.menuFunctionTree.getChecked();\n      var type1=res[f].get('NODE_TYPE');\n      if(type1=='F'){\n        //alert('rrr'+res[j].get('ID'));\n\n        if(rid===res[f].get('ID')){\n          res[f].set('checked',false);\n          res[f].commit();\n          app.menuFunctionTree.getView().refresh();\n\n          break;\n\n        }\n      }\n    }\n  }\n  //判部角色\n  if(type=='D'){\n    for(var d=0;d<app.rolegrid.store.getCount();d++){\n      var r_id2=app.rolegrid.store.getAt(d).get('ROLE_ID');\n      if(rid===r_id2){\n\n        app.rolegrid.getSelectionModel().deselect(app.rolegrid.store.getAt(d));\n        break;\n      }\n\n    }\t\n  }\n\n  //判部用户\n  if(type=='U'){\n    for(var p=0;p<app.usergrid.store.getCount();p++){\n      var r_id1=app.usergrid.store.getAt(p).get('USER_ID');\n      if(rid===r_id1){\n\n        app.usergrid.getSelectionModel().deselect(app.usergrid.store.getAt(p));\n        break;\n      }\n    }\t\n  }\n  allcount1();\n};\n\n//删除全部已选的用户、部门、岗位\napp.deleteAlludp =   function (){\n  Ext.Msg.confirm('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_qdscqbyxdyygnjsyh#}',function(btn){ /* '提示','确定删除全部已选的应用、功能、角色、用户?*/\n    if(btn == 'yes'){\n      app.ADFUgrid.store.removeAll();\n      var allCheckedNodes = app.menuFunctionTree.getChecked();\n      for(var i=0; i<allCheckedNodes.length; i++){\n        allCheckedNodes[i].set('checked',false);\n        allCheckedNodes[i].commit();\n      }\n      allcount1();\n      app.menuFunctionTree.getView().refresh();\n      app.appgrid.getSelectionModel().deselectAll();\n\n      app.rolegrid.getSelectionModel().deselectAll();\n      app.usergrid.getSelectionModel().deselectAll();\n\n      \n    }\n  });\n};\n//删除左弹框数据\n app.deleteCopyOrg=function (){ \n \n    var record=app.Orggridcopy.getSelectionModel().getSelection();\n\n     app.Orggridcopy.store.remove(record);\n \n       var rid=record[0].data.ORG_ID;\n\n \n \n    for(var j=0;j<app.orggrid.store.getCount();j++){\n      var r_id=app.orggrid.store.getAt(j).get('ORG_ID');\n       if(rid===r_id){\n        \n        app.orggrid.getSelectionModel().deselect(app.orggrid.store.getAt(j));\n         \n         break;\n       }\n  \n      }\t\n  \n  };\n\n // 删除全部已选的功能\napp.deleteAllFuns=  function (){\n    Ext.Msg.confirm('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_qdscqbyxdzz#}',function(btn){/*'提示','确定删除全部已选的组织?'*/\n      if(btn == 'yes'){\n        app.Orggridcopy.store.removeAll();\n        app.orggrid.getSelectionModel().deselectAll();\n      }\n    });\n  };"},"children":[{"configs":{"footerScript":"function allcount()\n{ \n  var count=app.Orggridcopy.store.getCount();\n // var count=row.length;\n\n       \n  \t\tif(count===0){\n   \t\t\t document.getElementById(\"fun\").innerHTML = \"{#xip_auth_user_orgAuth_seletedOrg#} (\"+count+\")\"; \n  \t\t\t\t}else{\n    \t\t\t document.getElementById(\"fun\").innerHTML = \"{#xip_auth_user_orgAuth_seletedOrg#}(\"+count+\")\"; \n  \t\t\t}\n \n\n \n\n}\n","itemId":"countleftfun"},"children":[],"expanded":false,"type":"clientscript"},{"configs":{"footerScript":"function allcount1()\n{ \n \n  var row=app.appgrid.getSelection();\n   var row1=app.rolegrid.getSelection();\n   var row2=app.usergrid.getSelection();\n // var row3=Wb.getSelRec(postgrid);\n  var count=row.length;\n  var count1=row1.length;\n   var count2=row2.length;\n//   var count3=row3.length;\n   var s=app.ADFUgrid.store.getModifiedRecords().length;\n//判断UDPgrid用户部门岗位的的个数\n\n   var a=0;\n  var b=0;\n  var c=0;\n   var d=0;\n                   for(var k=0;k<s;k++){\n                    \n    \t\t\t\t\tvar type=app.ADFUgrid.store.getAt(k).get('TYPE');\n                   \n                     if(type==='A'){      \n                       a++;  \n                      \n                     }\t\n                       if(type==='F'){      \n                       b++;       \n                       \n                     }\t\n                       if(type==='D'){      \n                       c++;       \n                       \n                     }\t\n                     if(type==='U'){      \n                       d++;      \n                       \n                     }\t\n                   }\n  \n  \t\t\t\n   \n     //功能树个数\n  \n  \n\n     if(b===0){\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     else{\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     \n    \n  \n    \n    \n        \n  //alert(c);//应用个数\n  if(count===0){\n  \n   if(statusA===false){\n    \n     if(a===0){\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     else{\n        document.getElementById(\"all\").innerHTML =\"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     \n    }\n   else{\n\n      document.getElementById(\"all\").innerHTML =\"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n   }\n    \n    \n }else{\n\n    document.getElementById(\"all\").innerHTML =\"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n  }\n  //角色个数\n  if(count1===0){\n   if(statusD===false){\n    \n     if(c===0){\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     else{\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     \n    }\n   else{\n\n      document.getElementById(\"all\").innerHTML =  \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n   }\n    \n    \n }else{\n\n    document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n  } \n  //用户个数\n   if(count2===0){\n   if(statusU===false){\n    \n     if(d===0){\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     else{\n        document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n     }\n     \n    }\n   else{\n\n      document.getElementById(\"all\").innerHTML = \"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n   }\n    \n    \n }else{\n\n    document.getElementById(\"all\").innerHTML =\"{#xip_auth_user_orgAuth_seletedapp#}(\"+a+\"){#xip_auth_user_orgAuth_seletedapp#}(\"+b+\"){#xip_auth_user_orgAuth_role#}(\"+c+\"){#xip_auth_user_orgAuth_user#}(\"+d+\")\"; \n  } \n  \n\n  \n  \n \n \n\n}","itemId":"countrightfun"},"children":[],"expanded":false,"type":"clientscript"},{"configs":{"itemId":"WinBtn"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_auth#}","itemId":"authorizebtn","iconCls":"insert_icon"},"events":{"click":"// 类型 ：A-应用，D-职责，F-功能，U-用户 \n//获取应用和组织ID\nif(app.Orggridcopy.store.getCount()===0 || app.ADFUgrid.store.getCount()===0){\n   Wb.warn('{#xip_auth_user_orgAuth_qxzysqddx#}'); /*请选择要授权的对象*/\n   return ;\n  } \n\n//====================定义筛选变量====================\nvar _matchIdsAttay = [];\nvar _matchStr = '';\nvar _tmpFunId = '';\nvar _tmpTargetId = '';\napp.Orggridcopy.store.each(function(funRecord){\n  _tmpFunId +=\"'\"+funRecord.data.ORG_ID+\"',\";\n  app.ADFUgrid.store.each(function(grantRecord){\n    _matchStr=funRecord.data.ORG_ID+','+grantRecord.data.TARGET_ID+','+grantRecord.data.TYPE;//组织,应用,类型   格式\n    _matchIdsAttay.push(_matchStr);    \n  });\n});\napp.ADFUgrid.store.each(function(tmp){\n  _tmpTargetId +=\"'\"+tmp.data.TARGET_ID+\"',\";\n});\n//=============获取要授权的对象============================\n_tmpFunId = _tmpFunId.substring(0,_tmpFunId.length-1);\n_tmpTargetId = _tmpTargetId.substring(0,_tmpTargetId.length-1);\nvar _existGrant = '';\n//==============筛选已经授权的数据===========================\napp.gridAllFunhiden.store.load({params:{ORG_IDS:_tmpFunId,TARGET_IDS:_tmpTargetId},callback:function(){\n  app.gridAllFunhiden.store.each(function(a){\n    _existGrant = a.data.ORG_ID+','+a.data.TARGET_ID+','+a.data.TYPE;\n    if(Ext.Array.contains(_matchIdsAttay,_existGrant)){\n    Ext.Array.remove(_matchIdsAttay,_existGrant); \n    }\n  });\n//=================得到最终需要授权的记录====================\n if(_matchIdsAttay.length === 0){\n   Wb.warn('{#xip_auth_user_orgAuth_sxzddxyjsqwbqcxxz#}');/*所选择的对象已经授权完毕，请重新选择*/\n   return false;\n }  \n   var tmpGrantAttayVar='';\n   var arrayGrantIds = [];\n   var jsonVar;\n   Ext.each(_matchIdsAttay,function(tmpItem){\n     tmpGrantAttayVar = tmpItem.split(',');\n     jsonVar= {ORG_SEC_ID:'',ORG_ID:tmpGrantAttayVar[0],TARGET_ID:tmpGrantAttayVar[1],TYPE:tmpGrantAttayVar[2]};\n     arrayGrantIds.push(jsonVar);\n   });\n  //=====================执行授权操作=============================\n \n Wb.request({\n           url: 'm?xwl=xip/auth/user/OrgAuth/data/batchAddOrgSec', \n           params: Wb.apply({\n                newArray:Ext.JSON.encode(arrayGrantIds)\n           }),\n           success: function() {\n               Ext.Msg.alert('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_sqcg#}');/*'提示','授权成功'*/\n               app.grid1.store.load();\n           }\n        }); \n}});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_orgAuth_revoke#}","itemId":"revokebtn","iconCls":"remove_icon"},"events":{"click":"if(app.Orggridcopy.store.getCount()===0 || app.ADFUgrid.store.getCount()===0){\n  Wb.warn('{#xip_auth_user_orgAuth_qcxxzyqxsqddx#}'); /*请选择要取消授权的对象*/\n  return;\n}\n\n//删除所选择的授权\nvar delArrayVar = [];\nvar delJson ;\napp.ADFUgrid.store.each(function(a){\n  app.Orggridcopy.store.each(function(b){\n    delJson = {ORG_ID:b.data.ORG_ID,TARGET_ID:a.data.TARGET_ID};\n    delArrayVar.push(delJson);\n  });  \n});\nWb.request({\n  url :'m?xwl=xip/auth/user/OrgAuth/data/deleteOrgSecBack',\n  params:Wb.apply({array:Ext.JSON.encode(delArrayVar)}),\n  success:function(response){\n    Ext.Msg.alert('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_cxsqcg#}');/*'提示','撤销授权成功'*/\n    app.grid1.store.load();\n  }\n});\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_orgAuth_close#}","itemId":"closebtn","iconCls":"cancel_icon"},"events":{"click":"app.window.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"maximized":"true","title":"{#xip_auth_user_orgAuth_orgAuth#}","height":"500","frame":"true","layout":"border","width":"950","closeAction":"destroy","buttonAlign":"center","buttons":"app.WinBtn","dialog":"false","itemId":"window","modal":"true","maximizable":"true"},"events":{"close":"app.Orggridcopy.store.removeAll();\napp.ADFUgrid.store.removeAll();"},"children":[{"configs":{"region":"west","style":"border-width:0px","layout":"border","width":"'48%'","itemId":"orgpanel"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"orgform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"orgN","fieldLabel":"{#xip_auth_user_orgAuth_orgName#}"},"events":{"specialkey":"app.orgQueryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_orgAuth_query#}","itemId":"orgQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.orggrid.store.load({params:{orgN:app.orgN.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"hidden":"true","itemId":"FLAG"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ARRID"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"orggrid","simpleSelect":"true"},"events":{"selectionchange":"var flag = app.FLAG.getValue();\nvar row = app.orggrid.getSelection();\nvar sm = app.orggrid.getSelectionModel();\nvar records = sm.getSelection();\n\nif(flag===null||flag===''){\n  \n}\nelse{\n  if(row.length<flag && statusO===false){\n    //获取当前页中已勾选的ID(取消勾选时)\n    var abl;\n    var arrayid = app.ARRID.getValue().split(',');\n    for(var i=0;i<arrayid.length;i++){\n        var aid = arrayid[i];\n        for(var v=0;v<row.length;v++){\n          var idN = records[v].get('ORG_ID');\n          if(aid===idN){\n            abl=1;\n            break;\n          }else{\n            abl=0;\n          }\n            \n        }\n        if(abl!==1){\n          //在弹出的WIN中删掉ID为该ID的数据\n               for(var k=0;k<app.Orggridcopy.store.getCount();k++){\n                  var  user_id3 = app.Orggridcopy.store.getAt(k).get('ORG_ID');\n                  if(aid===user_id3){\n                  app.Orggridcopy.store.removeAt(k);\n               \n                  }\n              }\n          \n        \n        }\n    }\n   \n   }\n}\nallcount();\n","tagEvents":"select:function(record, index, eOpts){\n    var row = app.orggrid.getSelection();\n    var sm = app.orggrid.getSelectionModel();\n    var records = sm.getSelection();\n    //获取当前页中已勾选的ID，拼接成字符串放到一个隐藏的文本框中\n    var arrid = '';\n    for(var v=0 ;v<row.length; v++){\n      var idNu = records[v].get('ORG_ID');\n      arrid = arrid+','+idNu;\n    }\n    app.ARRID.setValue(arrid.substring(1,arrid.length));\n    if(row.length===1){\n          //不在userStore中才添加\n          var blll;\n          for(var j=0;j<app.Orggridcopy.store.getCount();j++){\n             var uuid = app.Orggridcopy.store.getAt(j).get('ORG_ID');\n             if(records[0].get('ORG_ID')===uuid){\n              blll=1;\n              break;\n\n            }\n\n          }\n          if(blll!==1){\n         \n           var json={ORG_ID:records[0].get('ORG_ID'),ORG_CODE:records[0].get('ORG_CODE'),ORG_NAME:records[0].get('ORG_NAME')};\n         \n            app.Orggridcopy.store.add(json);\n\n          }\n\n\n\n    }else{\n      //不在userStore中才添加\n      var bl;\n      for(var i=0;i<app.Orggridcopy.store.getCount();i++){\n        var user_id=app.Orggridcopy.store.getAt(i).get('ORG_ID');\n        if(records[row.length-1].get('ORG_ID')===user_id){\n          bl=1;\n          break;\n        }\n        else{\n          bl=0;\n        }\n      }\n      if(bl!==1){\n          var json={ORG_ID:records[row.length-1].get('ORG_ID'),ORG_CODE:records[row.length-1].get('ORG_CODE'),ORG_NAME:records[row.length-1].get('ORG_NAME')};\n         \n            app.Orggridcopy.store.add(json);\n        }\n\n    }\n\n    app.FLAG.setValue(row.length);\n    allcount();\n\n}"},"children":[{"configs":{"pageSize":"25","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectOrg"},"events":{"load":"var arr=[];\nfor(var i=0;i<app.Orggridcopy.store.getCount();i++){\n  var uid = app.Orggridcopy.store.getAt(i).get('ORG_ID');\n  for(var j=0;j<app.orggrid.store.getCount();j++){\n    if(uid===app.orggrid.store.getAt(j).get('ORG_ID')){\n      arr.push(app.orggrid.store.getAt(j));\n      break;\n    }  \n  }\n}\n\napp.orggrid.getSelectionModel().select(arr);\n\nstatusO=false;","beforeload":"statusO = true;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ORG_ID","hidden":"true","dataIndex":"ORG_ID","itemId":"ORG_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_orgCode#}","dataIndex":"ORG_CODE","itemId":"ORG_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_orgName#}","dataIndex":"ORG_NAME","itemId":"ORG_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"panel"},{"configs":{"region":"east","width":"'48%'","activeTab":"apppanel","itemId":"funtabPanel"},"children":[{"configs":{"title":"{#xip_auth_user_orgAuth_app#}","style":"border-width:0px","layout":"border","border":"false","itemId":"apppanel"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"appform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"appN","fieldLabel":"{#xip_auth_user_orgAuth_app#}"},"events":{"specialkey":"app.appQueryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_orgAuth_query#}","itemId":"appQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.appgrid.store.load({params:{appN:app.appN.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"hidden":"true","itemId":"FLAG1"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ARRID1"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"appgrid","simpleSelect":"true"},"events":{"selectionchange":"\nvar flag = app.FLAG1.getValue();\n\nvar row = app.appgrid.getSelection();\n\nvar sm = app.appgrid.getSelectionModel();\n\nvar records = sm.getSelection();\n\nif(flag===null||flag===''){\n  \n}\nelse{\n  if(row.length<flag && statusA===false){\n    //获取当前页中已勾选的ID(取消勾选时)\n    var abl;\n    var arrayid = app.ARRID1.getValue().split(',');\n    for(var i=0;i<arrayid.length;i++){\n        var aid = arrayid[i];\n        for(var v=0;v<row.length;v++){\n          var idN = records[v].get('APP_ID');\n          if(aid===idN){\n            abl=1;\n            break;\n          }else{\n            abl=0;\n          }\n            \n        }\n        if(abl!==1){\n          //在弹出的WIN中删掉ID为该ID的数据\n        \n               for(var k=0;k<app.ADFUgrid.store.getCount();k++){\n                  var  user_id3 = app.ADFUgrid.store.getAt(k).get('TARGET_ID');\n                  if(aid===user_id3){\n                  app.ADFUgrid.store.removeAt(k);\n               \n                  }\n              }\n          \n        \n        }\n    }\n   \n   }\n}\nallcount1();\n","tagEvents":"select:function(record, index, eOpts){\n    var row = app.appgrid.getSelection();\n    var sm = app.appgrid.getSelectionModel();\n    var records = sm.getSelection();\n    //获取当前页中已勾选的ID，拼接成字符串放到一个隐藏的文本框中\n    var arrid = '';\n    for(var v=0 ;v<row.length; v++){\n      var idNu = records[v].get('APP_ID');\n      arrid = arrid+','+idNu;\n    }\n    app.ARRID1.setValue(arrid.substring(1,arrid.length));\n    if(row.length===1){\n          //不在userStore中才添加\n          var blll;\n          for(var j=0;j<app.ADFUgrid.store.getCount();j++){\n             var uuid = app.ADFUgrid.store.getAt(j).get('TARGET_ID');\n             if(records[0].get('APP_ID')===uuid){\n              blll=1;\n              break;\n\n            }\n\n          }\n          if(blll!==1){\n          \n           var json={TARGET_ID:records[0].get('APP_ID'),ANAME:records[0].get('APP_NAME'),TYPE:'A'};\n         \n            app.ADFUgrid.store.add(json);\n\n          }\n\n\n\n    }else{\n      //不在userStore中才添加\n      var bl;\n      for(var i=0;i<app.ADFUgrid.store.getCount();i++){\n        var user_id=app.ADFUgrid.store.getAt(i).get('TARGET_ID');\n        if(records[row.length-1].get('APP_ID')===user_id){\n          bl=1;\n          break;\n        }\n        else{\n          bl=0;\n        }\n      }\n      if(bl!==1){\n          var json={TARGET_ID:records[row.length-1].get('APP_ID'),ANAME:records[row.length-1].get('APP_NAME'),TYPE:'A'};\n          app.ADFUgrid.store.add(json);\n        }\n\n    }\n\n    app.FLAG1.setValue(row.length);\n    allcount1();\n\n}"},"children":[{"configs":{"pageSize":"25","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectApp"},"events":{"load":"\nvar arr=[];\nfor(var i=0;i<app.ADFUgrid.store.getCount();i++){\n  var uid = app.ADFUgrid.store.getAt(i).get('TARGET_ID');\n  for(var j=0;j<app.appgrid.store.getCount();j++){\n    if(uid===app.appgrid.store.getAt(j).get('APP_ID')){\n      arr.push(app.appgrid.store.getAt(j));\n      break;\n    }  \n  }\n}\n\napp.appgrid.getSelectionModel().select(arr);\nstatusA = false;","beforeload":"statusA = true;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO2"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"APP_ID","hidden":"true","dataIndex":"APP_ID","itemId":"APP_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_appName#}","dataIndex":"APP_NAME","itemId":"APP_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_appDesc#}","hidden":"true","dataIndex":"APP_DESC","itemId":"APP_DESC_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"panel"},{"configs":{"title":"{#xip_auth_user_orgAuth_fun#}","style":"border-width:0px","layout":"border","border":"false","itemId":"funpanel"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"funform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"funN","fieldLabel":"{#xip_auth_user_orgAuth_fun#}"},"events":{"specialkey":"app.userQueryBtn1.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_orgAuth_query#}","itemId":"userQueryBtn1","iconCls":"seek_icon","x":"10"},"events":{"click":"filterBy(app.funN.getValue(),'text', app.menuFunctionTree);"},"children":[],"expanded":false,"type":"button"},{"configs":{"hidden":"true","itemId":"FLAG2"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ARRID2"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"rootVisible":"false","region":"center","animate":"false","root":"{id:'rootNode',text:'{#xip_auth_user_orgAuth_gncd#}',expanded:true} /*功能菜单*/\n","itemId":"menuFunctionTree","viewConfig":"{\n  plugins : {\n    pluginId: 'ddPlug',\n    ptype: 'treeviewdragdrop'\n  },\n  listeners : {\n    beforedrop: function(node,data,overModel,dropPosition,dropFunction,options){\n      return false;\n    },\n    drop: function(node,data,overModel,dropPosition,options){\n      return false;\n    }\n  }\n}"},"events":{"checkchange":"//递归调用选中子节点与父节点（选中父节点，同时选中父节点下的所有子节点，选中子节点，同时选中父节点）\nsetChildChecked(node,checked);\nsetParentChecked(node,checked);\n"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/getMenuFunctionsTree"},"events":{"load":"app.menuFunctionTree.expandAll();\n\napp.menuFunctionTree.collapseAll();","beforeload":"operation.params.parentID=operation.node.get('ID');"},"children":[],"expanded":false,"type":"treestore"}],"expanded":true,"type":"tree"}],"expanded":false,"type":"panel"},{"configs":{"title":"{#xip_auth_user_orgAuth_role#}","style":"border-width:0px","layout":"border","border":"false","itemId":"rolepanel"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"roleform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"roleN","fieldLabel":"{#xip_auth_user_orgAuth_role#}"},"events":{"specialkey":"app.userQueryBtn2.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_orgAuth_query#}","itemId":"userQueryBtn2","iconCls":"seek_icon","x":"10"},"events":{"click":"\napp.rolegrid.store.load({params:{roleN:app.roleN.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"hidden":"true","itemId":"FLAG3"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ARRID3"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"rolegrid","simpleSelect":"true"},"events":{"tagEvents":"select:function(record, index, eOpts){\n    var row = app.rolegrid.getSelection();\n    var sm = app.rolegrid.getSelectionModel();\n    var records = sm.getSelection();\n    //获取当前页中已勾选的ID，拼接成字符串放到一个隐藏的文本框中\n    var arrid = '';\n    for(var v=0 ;v<row.length; v++){\n      var idNu = records[v].get('ROLE_ID');\n      arrid = arrid+','+idNu;\n    }\n    app.ARRID3.setValue(arrid.substring(1,arrid.length));\n    if(row.length===1){\n          //不在userStore中才添加\n          var blll;\n          for(var j=0;j<app.ADFUgrid.store.getCount();j++){\n             var uuid = app.ADFUgrid.store.getAt(j).get('TARGET_ID');\n             if(records[0].get('ROLE_ID')===uuid){\n              blll=1;\n              break;\n\n            }\n\n          }\n          if(blll!==1){\n          \n           var json={TARGET_ID:records[0].get('ROLE_ID'),ANAME:records[0].get('ROLE_NAME'),TYPE:'D'};\n         \n            app.ADFUgrid.store.add(json);\n\n          }\n\n\n\n    }else{\n      //不在userStore中才添加\n      var bl;\n      for(var i=0;i<app.ADFUgrid.store.getCount();i++){\n        var user_id=app.ADFUgrid.store.getAt(i).get('TARGET_ID');\n        if(records[row.length-1].get('ROLE_ID')===user_id){\n          bl=1;\n          break;\n        }\n        else{\n          bl=0;\n        }\n      }\n      if(bl!==1){\n          var json={TARGET_ID:records[row.length-1].get('ROLE_ID'),ANAME:records[row.length-1].get('ROLE_NAME'),TYPE:'D'};\n          app.ADFUgrid.store.add(json);\n        }\n\n    }\n\n    app.FLAG3.setValue(row.length);\n    allcount1();\n\n}","selectionchange":"var flag = app.FLAG3.getValue();\nvar row = app.rolegrid.getSelection();\nvar sm = app.rolegrid.getSelectionModel();\nvar records = sm.getSelection();\n\nif(flag===null||flag===''){\n  \n}\nelse{\n  if(row.length<flag && statusD===false){\n    //获取当前页中已勾选的ID(取消勾选时)\n    var abl;\n    var arrayid = app.ARRID3.getValue().split(',');\n    for(var i=0;i<arrayid.length;i++){\n        var aid = arrayid[i];\n        for(var v=0;v<row.length;v++){\n          var idN = records[v].get('ROLE_ID');\n          if(aid===idN){\n            abl=1;\n            break;\n          }else{\n            abl=0;\n          }\n            \n        }\n        if(abl!==1){\n          //在弹出的WIN中删掉ID为该ID的数据\n               for(var k=0;k<app.ADFUgrid.store.getCount();k++){\n                  var  user_id3 = app.ADFUgrid.store.getAt(k).get('TARGET_ID');\n                  if(aid===user_id3){\n                  app.ADFUgrid.store.removeAt(k);\n               \n                  }\n              }\n          \n        \n        }\n    }\n   \n   }\n}\nallcount1();\n"},"children":[{"configs":{"pageSize":"25","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectRole"},"events":{"load":"var arr=[];\nfor(var i=0;i<app.ADFUgrid.store.getCount();i++){\n  var uid = app.ADFUgrid.store.getAt(i).get('TARGET_ID');\n  for(var j=0;j<app.rolegrid.store.getCount();j++){\n    if(uid===app.rolegrid.store.getAt(j).get('ROLE_ID')){\n      arr.push(app.rolegrid.store.getAt(j));\n      break;\n    }  \n  }\n}\n\napp.rolegrid.getSelectionModel().select(arr);\nstatusD = false;","beforeload":"statusD = true;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO3"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ROLE_ID","hidden":"true","dataIndex":"ROLE_ID","itemId":"ROLE_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_roleName#}","width":"100","dataIndex":"ROLE_NAME","itemId":"ROLE_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_roleDesc#}","dataIndex":"DESCRIPTION","itemId":"DESCRIPTION_COL2","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"panel"},{"configs":{"title":"{#xip_auth_user_orgAuth_user#}","style":"border-width:0px","layout":"border","border":"false","itemId":"userpanel"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"userform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"orgPanel"},"children":[{"configs":{"labelWidth":"80","queryMode":"local","displayField":"NAME","width":"345","valueField":"CODE","emptyText":"{#xip_auth_user_orgAuth_selOrg#}","labelAlign":"right","itemId":"orgcomboBox","fieldLabel":"{#xip_auth_user_orgAuth_Org#}","editable":"true"},"events":{"select":"app.orgcomboBox.focus();\nvar dept_id = app.depcomboBox.getValue();\nif(dept_id===null||dept_id===''){\n  \n  var ORG_ID = app.orgcomboBox.getValue();\n \n  app.depcomboBox.store.load({params:{ORG_ID:ORG_ID}});\n}else{\n \n  var ORG_ID = app.orgcomboBox.getValue();\n  app.depcomboBox.store.load({params:{ORG_ID:ORG_ID}});\n  app.depcomboBox.clearValue();\n}\nvar ORG_ID = app.orgcomboBox.getValue();\napp.usergrid.store.load();"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/userfunAuth/data/selectOrg"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"deptPanel"},"children":[{"configs":{"labelWidth":"80","queryMode":"local","displayField":"DEPT_NAME","width":"345","valueField":"DEPT_ID","emptyText":"{#xip_auth_user_orgAuth_selDept#}","labelAlign":"right","itemId":"depcomboBox","fieldLabel":"{#xip_auth_user_orgAuth_dept#}"},"events":{"select":"var DEPT_ID = app.depcomboBox.getValue();\napp.usergrid.store.load();\n","focus":"var DEPT_ID = app.depcomboBox.getValue();\nif(DEPT_ID===null || DEPT_ID===''){\n  if(app.orgcomboBox.getValue()===null){\n    app.depcomboBox.store.removeAll();\n  }\n}\n"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xip/auth/role/DATA/selectDept"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"userN","fieldLabel":"{#xip_auth_user_orgAuth_username#}"},"events":{"specialkey":"app.usergrid.store.load({params:{userN:app.userN.getValue()}});"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_orgAuth_query#}","itemId":"userQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.usergrid.store.load({params:{userN:app.userN.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_orgAuth_reset#}","itemId":"userResetBtn","iconCls":"refresh_icon","x":"25"},"events":{"click":"app.orgcomboBox.clearValue();\napp.depcomboBox.clearValue();\napp.userN.setValue('');\napp.usergrid.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"hidden":"true","itemId":"FLAG4"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ARRID4"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"usergrid","simpleSelect":"true"},"events":{"tagEvents":"select:function(record, index, eOpts){\n    var row = app.usergrid.getSelection();\n    var sm = app.usergrid.getSelectionModel();\n    var records = sm.getSelection();\n    //获取当前页中已勾选的ID，拼接成字符串放到一个隐藏的文本框中\n    var arrid = '';\n    for(var v=0 ;v<row.length; v++){\n      var idNu = records[v].get('USER_ID');\n      arrid = arrid+','+idNu;\n    }\n    app.ARRID4.setValue(arrid.substring(1,arrid.length));\n    if(row.length===1){\n          //不在userStore中才添加\n          var blll;\n          for(var j=0;j<app.ADFUgrid.store.getCount();j++){\n             var uuid = app.ADFUgrid.store.getAt(j).get('TARGET_ID');\n             if(records[0].get('USER_ID')===uuid){\n              blll=1;\n              break;\n\n            }\n\n          }\n          if(blll!==1){\n          \n           var json={TARGET_ID:records[0].get('USER_ID'),ANAME:records[0].get('USER_NAME'),TYPE:'U'};\n         \n            app.ADFUgrid.store.add(json);\n\n          }\n\n\n\n    }else{\n      //不在userStore中才添加\n      var bl;\n      for(var i=0;i<app.ADFUgrid.store.getCount();i++){\n        var user_id=app.ADFUgrid.store.getAt(i).get('TARGET_ID');\n        if(records[row.length-1].get('USER_ID')===user_id){\n          bl=1;\n          break;\n        }\n        else{\n          bl=0;\n        }\n      }\n      if(bl!==1){\n          var json={TARGET_ID:records[row.length-1].get('USER_ID'),ANAME:records[row.length-1].get('USER_NAME'),TYPE:'U'};\n          app.ADFUgrid.store.add(json);\n        }\n\n    }\n\n    app.FLAG4.setValue(row.length);\n   allcount1();\n\n}","selectionchange":"var flag = app.FLAG4.getValue();\nvar row = app.usergrid.getSelection();\nvar sm = app.usergrid.getSelectionModel();\nvar records = sm.getSelection();\nif(flag===null||flag===''){\n  \n}\nelse{\n  if(row.length<flag && statusU===false){\n    //获取当前页中已勾选的ID(取消勾选时)\n    var abl;\n    var arrayid = app.ARRID4.getValue().split(',');\n    for(var i=0;i<arrayid.length;i++){\n        var aid = arrayid[i];\n        for(var v=0;v<row.length;v++){\n          var idN = records[v].get('USER_ID');\n          if(aid===idN){\n            abl=1;\n            break;\n          }else{\n            abl=0;\n          }\n            \n        }\n        if(abl!==1){\n          //在弹出的WIN中删掉ID为该ID的数据\n               for(var k=0;k<app.ADFUgrid.store.getCount();k++){\n                  var  user_id3 = app.ADFUgrid.store.getAt(k).get('TARGET_ID');\n                  if(aid===user_id3){\n                  app.ADFUgrid.store.removeAt(k);\n               \n                  }\n              }\n          \n        \n        }\n    }\n   \n   }\n}\nallcount1();\n"},"children":[{"configs":{"pageSize":"25","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/userfunAuth/data/noOrgDeptUser"},"events":{"load":"var arr=[];\nfor(var i=0;i<app.ADFUgrid.store.getCount();i++){\n  var uid = app.ADFUgrid.store.getAt(i).get('TARGET_ID');\n  for(var j=0;j<app.usergrid.store.getCount();j++){\n    if(uid===app.usergrid.store.getAt(j).get('USER_ID')){\n      arr.push(app.usergrid.store.getAt(j));\n      break;\n    }  \n  }\n}\napp.usergrid.getSelectionModel().select(arr);\nstatusU = false;","beforeload":"var whereSql= ' AND 1=1';\nif(Ext.isEmpty(app.orgcomboBox.getValue()) && Ext.isEmpty(app.depcomboBox.getValue())){\n  store.getProxy().url='m?xwl=xip/auth/user/userfunAuth/data/noOrgDeptUser';  //noOrgDeptUser\n}else{\n  store.getProxy().url='m?xwl=xip/auth/user/userfunAuth/data/selectOrgDeptUser';  //selectOrgDeptUser\n}\nif(!Ext.isEmpty(app.orgcomboBox.getValue())){ \n  whereSql +=' AND b.ORG_ID =\\''+app.orgcomboBox.getValue()+'\\'';\n}\nif(!Ext.isEmpty(app.depcomboBox.getValue())){\n  whereSql +=' AND b.DEPT_ID =\\''+app.depcomboBox.getValue()+'\\'';\n}\nstore.getProxy().extraParams.WHERESQL = whereSql;\nstatusU = true;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO4"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"USER_ID","hidden":"true","dataIndex":"USER_ID","itemId":"USER_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_username#}","width":"150","dataIndex":"USER_NAME","itemId":"USER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_empName#}","dataIndex":"EMP_NAME","itemId":"EMP_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_type#}","hidden":"true","dataIndex":"type","itemId":"type_col","renderer":"var str = \"U\";\nreturn str;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"panel"}],"expanded":false,"type":"tab"},{"configs":{"region":"south","height":"'8%'","frame":"false","style":"border-width:0px","layout":"border","border":"false","itemId":"southpanel"},"children":[{"configs":{"region":"west","frame":"true","height":"30","style":"border-width:0px","width":"'48%'","layout":"border","border":"false","itemId":"westFormS"},"children":[{"configs":{"region":"west","frame":"true","style":"border-width:0px","width":"'40%'","columnWidth":".3","border":"false","itemId":"panel_west"},"children":[],"expanded":true,"type":"panel"},{"configs":{"region":"center","frame":"true","style":"border-width:0px","width":"'45%'","columnWidth":".2","border":"false","itemId":"panel_center"},"children":[{"configs":{"html":"<!DOCTYPE html>\n<html>\n<head>\n<\/head>\n<body>\n<a href=\"javascript:void(0)\"  onclick = \"app.SelectOrgWin.show()\"  style=\"text-decoration:none;color:black;font-weight:bold;\" id=\"fun\" >{#xip_auth_user_orgAuth_yxzz0#}<\/a>\n<\/body>\n<\/html>\n\t","itemId":"label1"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"region":"east","frame":"true","style":"border-width:0px","width":"30","columnWidth":".2","border":"false","itemId":"panel_east"},"children":[{"configs":{"html":"<!DOCTYPE html>\n<html>\n<head>\n<\/head>\n<body>\n<a href=\"javascript:void(0)\"  onclick = \"app.deleteAllFuns();\" title=\"{#xip_auth_user_orgAuth_scqbyxgn#}\" style=\"text-decoration:none;color:black;font-weight:bold;\" id=\"fun\" ><image src=\"{#delImageSrc#}\"><\/image><\/a>\n  <\/body>\n<\/html>\n\t","itemId":"deleteAllRolesLabel"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"east","frame":"true","height":"30","style":"border-width:0px","width":"'48%'","layout":"border","border":"false","itemId":"eastFormS"},"children":[{"configs":{"region":"west","frame":"true","style":"border-width:0px","width":"'40%'","border":"false","itemId":"panel_west1"},"children":[],"expanded":true,"type":"panel"},{"configs":{"region":"center","height":"30","frame":"true","style":"border-width:0px","width":"'45%'","border":"false","itemId":"panel_center1"},"children":[{"configs":{"html":"<!DOCTYPE html>\n<html>\n<head>\n<\/head>\n<body>\n<a href=\"javascript:void(0)\"  onclick =\"app.SelectADFUWin.show()\" style=\"text-decoration:none;color:black;font-weight:bold;\" id=\"all\" >{#xip_auth_user_orgAuth_yxyy0gn0js0yh0#}<\/a>\n<\/body>\n<\/html>\n\t","itemId":"label2"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"region":"east","frame":"true","style":"border-width:0px","width":"30","border":"false","itemId":"panel_east1"},"children":[{"configs":{"html":"<!DOCTYPE html>\n<html>\n<head>\n<\/head>\n<body>\n<a href=\"javascript:void(0)\"  onclick = \"app.deleteAlludp();\" title=\"{#xip_auth_user_orgAuth_scqbyxsj#}\" style=\"text-decoration:none;color:black;font-weight:bold;\" id=\"fun\" ><image src=\"{#delImageSrc#}\"><\/image><\/a>\n  <\/body>\n<\/html>\n\t","itemId":"deleteAllUsersLabel"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":false,"type":"panel"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_orgAuth_seletedOrg#}","height":"360","frame":"true","layout":"border","width":"480","closeAction":"hide","border":"false","itemId":"SelectOrgWin","modal":"true"},"children":[{"configs":{"region":"center","selType":"rowmodel","height":"340","width":"480","itemId":"Orggridcopy","simpleSelect":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectLeftCopy"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","itemId":"XUHAO5"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ORG_ID","hidden":"true","dataIndex":"ORG_ID","itemId":"ORG_ID_COLUMN"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_orgCode#}","dataIndex":"ORG_CODE","itemId":"ORG_CODE_COLUMN","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_orgName#}","dataIndex":"ORG_NAME","itemId":"ORG_NAME_COLUMN","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"width":"50","itemId":"Rdelete","renderer":"var str = \"<a href=\\\"javascript:app.deleteCopyOrg();\\\"> {#xip_auth_user_orgAuth_delete#} <\/a>\";\nreturn str;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_orgAuth_seletedData#}","height":"360","frame":"true","layout":"border","width":"480","closeAction":"hide","border":"false","itemId":"SelectADFUWin","modal":"true"},"children":[{"configs":{"region":"center","selType":"rowmodel","height":"340","width":"480","itemId":"ADFUgrid","simpleSelect":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectRightCopy"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"目标id","hidden":"true","dataIndex":"TARGET_ID","itemId":"TID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_authObj#}","width":"180","dataIndex":"ANAME","itemId":"ANAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_type#}","width":"50","dataIndex":"TYPE","itemId":"TYPE_COL","renderer":"if(value === \"A\"){\n  return \"{#xip_auth_user_orgAuth_app#}\";\n}else if(value === \"F\"){\n  return \"{#xip_auth_user_orgAuth_fun#}\";\n}else if(value === \"D\"){\n  return \"{#xip_auth_user_orgAuth_role#}\";\n}else if(value === \"U\"){\n  return \"{#xip_auth_user_orgAuth_user#}\";\n}else{\n  return value;\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"itemId":"Rdelete1","renderer":"var str = \"<a href=\\\"javascript:app.deleteCopyAllFun();\\\"> {#xip_auth_user_orgAuth_delete#} <\/a>\";\nreturn str;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"height":"260","width":"380","layout":"border","itemId":"windowhiden"},"children":[{"configs":{"region":"center","height":"260","hidden":"true","width":"380","itemId":"gridAllFunhiden"},"children":[{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectOrgFunHiden"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"功能id","hidden":"true","dataIndex":"ORG_SEC_ID","itemId":"yonghuid2"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"用户功能id","hidden":"true","dataIndex":"ORG_ID","itemId":"gongnid2"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"目标id","hidden":"true","dataIndex":"TARGET_ID","itemId":"ufid3"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"type","hidden":"true","dataIndex":"TYPE","itemId":"typecol"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"80","frame":"true","style":"border-width:0px","layout":"fit","border":"false","itemId":"form1"},"children":[{"configs":{"title":"{#xip_auth_user_orgAuth_queryConditions#}","frame":"true","style":"padding-top:8px","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"zzmc","fieldLabel":"{#xip_auth_user_orgAuth_orgName#}"},"events":{"specialkey":"app.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"bmmc","fieldLabel":"{#xip_auth_user_orgAuth_authObjName#}"},"events":{"specialkey":"app.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","pickList":"[['A','{#xip_auth_user_orgAuth_app#}'],['F','{#xip_auth_user_orgAuth_fun#}'],['D','{#xip_auth_user_orgAuth_role#}'],['U','{#xip_auth_user_orgAuth_user#}']]\n/*[['A','应用'],['F','功能'],['D','角色'],['U','用户']]*/","labelAlign":"right","itemId":"comboBox1","fieldLabel":"{#xip_auth_user_orgAuth_authType#}"},"events":{"select":"app.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"combo"},{"configs":{"text":"{#xip_auth_user_orgAuth_query#}","itemId":"queryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"var zzmc = app.zzmc.getValue();\nvar bmmc = app.bmmc.getValue();\nvar comboBox1 = app.comboBox1.getValue();\n\napp.grid1.store.load({params:{\n         zzmc : zzmc,\n         bmmc  : bmmc,\n         comboBox1 : comboBox1\n}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_orgAuth_reset#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"25"},"events":{"click":"app.form1.getForm().reset();\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid1","simpleSelect":"true"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_orgAuth_orgAuth#}","itemId":"orgroot","iconCls":"key_icon"},"events":{"click":"var win = new Ext.window.Window(app._window);\nwin.show();\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_orgAuth_delete#}","itemId":"deletebtn","iconCls":"record_delete_icon"},"events":{"click":"var rows = app.grid1.getSelection();\nif(Ext.isEmpty(rows)){\n  Ext.MessageBox.alert('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_nmyxzrhsj#}');/*'提示','您没有选中任何数据！'*/\n}\nelse{\n   Ext.Msg.confirm('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_nqdysc#}',function(a){ /* '提示','您确定要删除？'*/\n    if(a=='yes'){\n      Wb.request({\n         url : 'm?xwl=xip/auth/user/OrgAuth/data/deleteOrgSec',\n         params : Wb.apply({destory: Wb.getData(rows)}),\n         success :function(response){\n           Ext.Msg.alert('{#xip_auth_user_orgAuth_prompt#}','{#xip_auth_user_orgAuth_sccg#}');/*提示 删除成功*/\n            Wb.remove(app.grid1,rows);\n           \n         }\n      });\n    }\n   });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"pageSize":"25","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/OrgAuth/data/selectOrgFun"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_orgAuth_serialNum#}","width":"45","align":"center","xtype":"rownumberer","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"组织授权id","hidden":"true","dataIndex":"ORG_SEC_ID","itemId":"orgauthid"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"组织id","hidden":"true","dataIndex":"ORG_ID","itemId":"orgidcol"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"目标id","hidden":"true","dataIndex":"TARGET_ID","itemId":"targetid"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_orgName#}","width":"300","dataIndex":"ORG_NAME","itemId":"orgname_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_authObjName#}","width":"350","dataIndex":"TARGET","itemId":"TARGET_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_orgAuth_authType#}","dataIndex":"TYPE","itemId":"qxlx","renderer":"if(value === \"A\"){\n  return \"{#xip_auth_user_orgAuth_app#}\";\n}else if(value === \"F\"){\n  return \"{#xip_auth_user_orgAuth_fun#}\";\n}else if(value === \"D\"){\n  return \"{#xip_auth_user_orgAuth_role#}\";\n}else if(value === \"U\"){\n  return \"{#xip_auth_user_orgAuth_user#}\";\n}else{\n  return value;\n}"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}