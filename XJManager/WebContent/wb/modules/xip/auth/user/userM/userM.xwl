{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","initScript":"var ctxPath = request.getContextPath() ;\nrequest.setAttribute(\"contextPath\",ctxPath);\nvar sysMode = request.getSession().getAttribute(\"XzSessionVars\");\nrequest.setAttribute(\"AUTH_MODAL\",sysMode.get(\"AUTH_MODAL\"));\n//----------------------重系统参数中获取配置的用户初始密码------------------\nvar userPwd = com.xzsoft.xip.platform.util.PlatformUtil.getParamVal(\"DEFAULT_PASSWORD\", \"P\", \"P\");\nrequest.setAttribute(\"userPwd\",userPwd);\n\nvar godMoadl = request.getSession().getAttribute(\"XzSessionVars\").get('godMode');\nrequest.setAttribute(\"godMoadl\",godMoadl);\n\nvar dbType = com.xzsoft.xip.platform.util.PlatformUtil.getDbType();\nrequest.setAttribute(\"dbType\", dbType);\n\ncom.xzsoft.xip.platform.util.XipUtil.checkUserFunSec(request,response);","jsLinks":"[\"xip/js/xip-debug.js\"]","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/auth/user/userM/userM\");","itemId":"module"},"events":{"finalize":"//=============实现树的模糊查找================\nfunction filterBy(text,by,menuFunTree) { \n   clearFilter(menuFunTree);\n    var view = menuFunTree.getView(),\n        me = menuFunTree,\n        nodesAndParents = [];\n    // 找到匹配的节点并展开.\n    // 添加匹配的节点和他们的父节点到nodesAndParents数组.\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n       this.expand();\n        var currNode = this;\n        if (currNode && currNode.data[by] && currNode.data[by].toString().toLowerCase().indexOf(text.toLowerCase()) > -1) {\n            menuFunTree.expandPath(currNode.getPath());\n            while (currNode.parentNode) {\n                nodesAndParents.push(currNode.id);\n                currNode = currNode.parentNode;\n            }\n        }\n    }, null, [menuFunTree, view]);\n\n    // 将不在nodesAndParents数组中的节点隐藏\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n        this.expand();\n        var uiNode = view.getNodeByRecord(this);\n        if (uiNode && !Ext.Array.contains(nodesAndParents, this.id)) {\n            Ext.get(uiNode).setDisplayed('none');\n        }\n    }, null, [menuFunTree, view]);\n}\n\nfunction clearFilter(menuFunTree){\n    var view = menuFunTree.getView();\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n       this.expand();\n        var uiNode = view.getNodeByRecord(this);\n        if (uiNode) {\n            Ext.get(uiNode).setDisplayed('table-row');\n        }\n    }, null, [menuFunTree, view]);\n}\n","initialize":"function getuuid() {\n var s = [];\n var hexDigits = \"0123456789abcdef\";\n for (var i = 0; i < 36; i++) {\n s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n }\n s[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n s[8] = s[13] = s[18] = s[23] = \"-\";\n\nvar uuid = s.join(\"\");\n return uuid;\n}\nfunction isChn(str){ \nvar reg =/[^\\x00-\\xff]/g; \n if(!reg.test(str)){\n   return   true ;\n }     \n return false;\n}"},"children":[{"configs":{"itemId":"staticstore"},"children":[{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"userGrantedFunStore","url":"m?xwl=xip/auth/user/userM/fundata/userGrantedFunStore"},"children":[],"expanded":false,"type":"store"},{"configs":{"pageSize":"-1","itemId":"userGrantedRoleStore","url":"m?xwl=xip/auth/user/userM/fundata/userGrantedRoleStore"},"children":[],"expanded":false,"type":"store"},{"configs":{"pageSize":"-1","itemId":"userGrantedOrgStore","url":"m?xwl=xip/auth/user/userM/fundata/userGrantedoRGStore"},"children":[],"expanded":false,"type":"store"},{"configs":{"pageSize":"-1","itemId":"userGrantedAppStore","url":"m?xwl=xip/auth/user/userM/fundata/userGrantedAppStore"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"folder"},{"configs":{"itemId":"buttons"},"children":[{"configs":{"itemId":"window1btn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_save#}","itemId":"saveWin","iconCls":"save_icon"},"events":{"click":"// 为员工创建登录信息 \nvar _userName = app.USER_NAME.getValue();\t// 登录名\nvar _empId = app.EMP_ID.getValue();      // 员工标识(ID)\nvar _userId = app.USER_ID.getValue();    // 用户标识(ID)\nvar _attribute = app.ATTRIBUTE1.getValue();\t// 说明\nvar _userType = app.USER_TYPE.getValue();    // 用户类型\nvar _startDate = app.START_DATE.getValue();\nvar _endDate = app.END_DATE.getValue();\nif(!app.form.getForm().isValid()){\n  Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qtxsybtx#}'); //'提示','请填写所有必填项！'\n  return false;\n}\n\nvar ischinese =isChn(_userName);\n\nif(ischinese===false ){\n  Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_dlyhzbnyhz#}'); // '提示','登录用户中不能有汉字'\n  return false;\n}\n\n\nif(_endDate !== null && _endDate!==''&&_endDate!=='null'){\n  if(_endDate<_startDate){\n    Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_jssjydykssj#}\") ; // \"提示\",\"结束时间应大于开始时间！\"\n    return false ;\n  }\n}\nvar _password = Xip.getMD5('11111'); // md5加密\nif('{#userPwd#}'!==null&&'{#userPwd#}'!==\"\"){\n  _password = Xip.getMD5('{#userPwd#}');\n}\n\nvar json = {\n  userId:'',\n  userName:_userName,\n  password:_password,\n  empId:_empId,\n  userType:_userType,\n  startDate:_startDate,\n  endDate: _endDate,\n  attribute:_attribute\n};\n\nvar jsonuser = {\n  userId:'',\n  userName:_userName,\n  password:_password,\n  empId:_empId,\n  userType:_userType,\n  startDate:app.START_DATE.getRawValue(),\n  endDate:  app.END_DATE.getRawValue(),\n  attribute1:_attribute\n} ; \n\nif(Ext.isEmpty(_userId)){//新增\n  json.userId = getuuid(); \n  jsonuser.userId = getuuid(); \n\n  app.USER_ID.setValue(json.userId);\n\n\n  Ext.Ajax.request({\n    url: '{#contextPath#}'+'/hrAction.do?method=insertUser',\n    method: 'POST',\n    //sync: false,\n    timeout: 300000,\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    jsonData: Ext.JSON.encode(jsonuser),\n    success: function(res, opts) {\n\n      var rep = Ext.JSON.decode(res.responseText);\n      var flag = rep.flag;\n      var msg = rep.msg;\n\n      if(flag==\"0\"){\n\n        app.grid1.store.load( {  params:{text1Upper:app.text1.getValue().toUpperCase(), text2:app.text2.getValue()}} );\n\n        //为新增用户增加默认权限\n        Ext.Ajax.request({ \n          url:'{#contextPath#}'+'/platformAction.do?method=defaultUserRoleFun',\n          params: { userId:json.userId,\n                   AUTH_MODAL:'{#AUTH_MODAL#}'\n                  },\t\t\n          method: 'POST',\t\t\n          success: function(response, options) {  \n            Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_bccg#}'); // '提示','保存成功！'\n          },\n          failure: function(response, options) {\n\n          }\n        });\n      }else{\n\n        Ext.Msg.alert('{#xip_auth_user_userM_prompt#}',msg); // 提示\n\n      }\n\n\n\n    }\n  });\n\n\n\n\n\n}else{//更新\n\n  json.userId = _userId;\n  jsonuser.userId = _userId;\n  Ext.Ajax.request({\n    url: '{#contextPath#}'+'/hrAction.do?method=updateUser',\n    method: 'POST',\n    //sync: false,\n    timeout: 300000,\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    jsonData: Ext.JSON.encode(jsonuser),\n    success: function(res, opts) {\n      var rep = Ext.JSON.decode(res.responseText);\n      var flag = rep.flag;\n      var msg = rep.msg;\n\n      if(flag==\"0\"){\n        app.grid1.store.load( {  params:{text1Upper:app.text1.getValue().toUpperCase(), text2:app.text2.getValue()}} );\n\n        Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_bccg#}'); // '提示','保存成功！'\n      }else{\n\n        Ext.Msg.alert('{#xip_auth_user_userM_prompt#}',msg); // 提示\n\n      }\n\n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_savaAndNext#}","itemId":"savenextWin"},"events":{"click":"app.USER_NAME.setReadOnly(true);\n// 为员工创建登录信息\nvar _userName = app.USER_NAME.getValue();\t// 登录名\nvar _empId = app.EMP_ID.getValue();      // 员工标识(ID)\nvar _userId = app.USER_ID.getValue();    // 用户标识(ID)\nvar _attribute = app.ATTRIBUTE1.getValue();\t// 说明\nvar _userType = app.USER_TYPE.getValue();    // 用户类型\nvar _startDate = app.START_DATE.getValue();\nvar _endDate = app.END_DATE.getValue();\nvar ischinese =isChn(_userName);\nif(ischinese===false ){\n  Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_dlyhzbnyhz#}'); // '提示','登录用户中不能有汉字'\n  return false;\n}\nif(!app.form.getForm().isValid()){\n  Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qtxsybtx#}'); // '提示','请填写所有必填项！'\n  return false;\n}\nif(_endDate !== null && _endDate!==''&&_endDate!=='null'){\n  if(_endDate<_startDate){\n    Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_jssjydykssj#}\") ; // \"提示\",\"结束时间应大于开始时间！\"\n    return false ;\n  }\n}\nvar _password = Xip.getMD5('11111'); // md5加密\nif('{#userPwd#}'!==null&&'{#userPwd#}'!==\"\"){\n  _password = Xip.getMD5('{#userPwd#}');\n}\n\nvar json = {\n  userId:'',\n  userName:_userName,\n  password:_password,\n  empId:_empId,\n  userType:_userType,\n  startDate:_startDate,\n  endDate: _endDate,\n  attribute:_attribute\n};\n\nvar jsonuser = {\n  userId:'',\n  userName:_userName,\n  password:_password,\n  empId:_empId,\n  userType:_userType,\n  startDate:app.START_DATE.getRawValue(),\n  endDate:  app.END_DATE.getRawValue(),\n  attribute1:_attribute\n} ; \n\nif(Ext.isEmpty(_userId)){//新增\n  json.userId = getuuid(); \n  jsonuser.userId = getuuid(); \n  app.USER_ID.setValue(json.userId);\n  Ext.Ajax.request({\n    url: '{#contextPath#}'+'/hrAction.do?method=insertUser',\n    method: 'POST',\n    //sync: false,\n    timeout: 300000,\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    jsonData: Ext.JSON.encode(jsonuser),\n    success: function(res, opts) {\n      var rep = Ext.JSON.decode(res.responseText);\n      var flag = rep.flag;\n      var msg = rep.msg;\n      if(flag==\"0\"){\n\n        app.form.getForm().reset();\n        app.USER_NAME.setReadOnly(false);\n        app.START_DATE.setValue(new Date());\n        app.USER_TYPE.setValue('U');\n        app.USER_ID.setValue('');\n\n        app.grid1.store.load( {  params:{text1Upper:app.text1.getValue().toUpperCase(), text2:app.text2.getValue()}} );\n        //为新增用户增加默认权限\n        Ext.Ajax.request({ \n          url:'{#contextPath#}'+'/platformAction.do?method=defaultUserRoleFun',\n          params: { userId:json.userId,\n                   AUTH_MODAL:'{#AUTH_MODAL#}'\n                  },\t\t\n          method: 'POST',\t\t\n          success: function(response, options) {  \n            Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_yhxxbccg#}\"); // \"提示\",\"用户信息保存成功!\"\n          },\n          failure: function(response, options) {\n\n          }\n        });\n\n      }else{\n\n        Ext.Msg.alert('{#xip_auth_user_userM_prompt#}',msg); // 提示\n\n      }\n    }\n  });\n\n\n}else{//更新\n\n  json.userId = _userId;\n  jsonuser.userId = _userId;\n  Ext.Ajax.request({\n    url: '{#contextPath#}'+'/hrAction.do?method=updateUser',\n    method: 'POST',\n    //sync: false,\n    timeout: 300000,\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    jsonData: Ext.JSON.encode(jsonuser),\n    success: function(res, opts) {\n      var rep = Ext.JSON.decode(res.responseText);\n      var flag = rep.flag;\n      var msg = rep.msg;\n      if(flag==\"0\"){\n        app.form.getForm().reset();\n        app.USER_NAME.setReadOnly(false);\n        app.START_DATE.setValue(new Date());\n        app.USER_TYPE.setValue('U');\n        app.USER_ID.setValue('');\n        Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_yhxxbccg#}\"); // \"提示\",\"用户信息保存成功!\"\n        app.grid1.store.load( {  params:{text1Upper:app.text1.getValue().toUpperCase(), text2:app.text2.getValue()}} );\n\n      }else{\n\n        Ext.Msg.alert('{#xip_auth_user_userM_prompt#}',msg); // 提示\n\n      }\n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_close#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.window1.close();\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"pwdWinBtn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_OK#}","itemId":"pwdBtnSave","iconCls":"ok_icon"},"events":{"click":"/*------修改用户密码------*/\nvar userId = app.userId11.getValue();  /*---用户ID---*/\nvar modifyPwd = app.newPwd.getValue();    /*---新密码---*/\nvar conPwd = app.confirmPwd.getValue();  /*---确认密码---*/\nif(modifyPwd === null || modifyPwd === \"\"){\n  Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_qszxdmm#}\") ; // \"提示\",\"请设置新的密码！\"\n  return false ;\n}\nif(conPwd === null || conPwd === \"\"){\n  Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_qqrxmm#}\") ; // \"提示\",\"请确认新密码！\"\n  return false ;\n}\nif(modifyPwd!==conPwd){\n  Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_mmsrbyz#}\") ; // \"提示\",\"密码输入不一致！\"\n  app.confirmPwd.setValue('');\n  return false ;\n}\nmodifyPwd = Xip.getMD5(modifyPwd);\n/**------执行Update操作------*/\n\n\nvar json = {newPwd:modifyPwd,uerid:userId};  \nWb.request({\n  url: 'm?xwl=xip/auth/user/userM/data/ModifyPasswoord',\n  params: json,\n  success: function(response) {\n    Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",\"{#xip_auth_user_userM_mmxgcg#}\"); // \"提示\",\"密码修改成功!\"\n    app.grid1.store.reload();\n    app.pwdwin.hide();\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_cancel#}","itemId":"pwdBtnCancel","iconCls":"cancel_icon"},"events":{"click":"app.pwdwin.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"winfunbtn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_OK#}","itemId":"savefunWin","iconCls":"ok_icon"},"events":{"click":"\n\nvar selectLength = app.menuFunctionTreeAll.getChecked().length;\nif(selectLength===0){\n  Wb.warning('{#xip_auth_user_userM_qxztjdgnsq#}'); // '请选择添加的授权功能！'\n  return;\n}  \nvar user_id=app.hiddenuserid.getValue();\n//========为用户添加授权功能================\nvar _addSelectRecord = app.menuFunctionTreeAll.getChecked();\nvar _addArray = [];\nvar _addUnit;\nfor(var i = 0;i<selectLength;i++){\n  var item = _addSelectRecord[i];\n  if(item.data.node_type === 'F'){  \n    // _addUnit = {FUN_TREE_ID:item.data.id,TARGET_ID:user_id};\n    _addUnit = {funTreeId:item.data.id,targetId:user_id};\n    _addArray.push(_addUnit);\n  } \n}\n\n\n\n//==============执行请求操作=================\n\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveUserFun',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_addArray),\n\n  success: function(res, opts) {\n    var rep = Ext.JSON.decode(res.responseText);\n    var flag = rep.flag;\n    var msg = rep.msg;\n    if(flag==\"0\"){\n\n      var _userId = app.hiddenuserid.getValue();\n      app.menuFunctionTreeAll.store.load({params:{userId:_userId,isGranted:'N'}});\n      app.menuFunctionTree.store.load({params:{userId:_userId,isGranted:'Y'}});\n      Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sqcg#}'); // '提示','授权成功'\n    }else{\n      Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg); // 提示\n    }\n  }\n}); "},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_cancel#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.winfun.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"winrolebtn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_OK#}","itemId":"saveroleWin","iconCls":"ok_icon"},"events":{"click":"//==============添加角色授权==================\nvar _userId = app.hiddenuserid.getValue();\nvar rows = app.rolegrid1.getSelection();\nif(Ext.isEmpty(rows)){\n  Wb.warn('{#xip_auth_user_userM_qxzysqdjs#}'); //请选择要授权的角色！ \n  return false;\n}\nvar _tmpJson;\nvar _addArray = [];\nExt.each(rows,function(a){\n // _tmpJson = {ROLE_ID:a.data.ROLE_ID,USER_ID:_userId};\n    _tmpJson = {roleId:a.data.ROLE_ID,userId:_userId};\n  _addArray.push(_tmpJson); \n});\n\n\n\n\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveUserRole',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_addArray),\n\n  success: function(res, opts) {\n    var rep = Ext.JSON.decode(res.responseText);\n    var flag = rep.flag;\n    var msg = rep.msg;\n     if(flag==\"0\"){\n               Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sqcg#}'); // '提示','授权成功'\n             var _userId = app.hiddenuserid.getValue();\n             app.rolegrid1.store.load({params:{USER_ID:_userId}});\n             app.rolegrid.store.load({params:{USER_ID:_userId}});\n           }else{\n              Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg); // 提示\n           }\n  }\n  \n  \n  \n        }); \n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_cancel#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.winrole.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"winorgbtn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_OK#}","itemId":"saveorgWin","iconCls":"ok_icon"},"events":{"click":"//==============添加组织授权==================\nvar _userId = app.hiddenuserid.getValue();\nvar rows = app.orggrid1.getSelection();\nif(Ext.isEmpty(rows)){\n  Wb.warn('{#xip_auth_user_userM_qxzysqdzz#}'); // 请选择要授权的组织！\n  return false;\n}\nvar _tmpJson;\nvar _addArray = [];\nExt.each(rows,function(a){\n  //_tmpJson = {ORG_ID:a.data.ORG_ID,TARGET_ID:_userId};\n  _tmpJson = {orgId:a.data.ORG_ID,targetId:_userId};\n  _addArray.push(_tmpJson); \n});\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveOrgSec',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_addArray),\n\n  success: function(res, opts) {\n    \n    var rep = Ext.JSON.decode(res.responseText);\n    var flag = rep.flag;\n    var msg = rep.msg;\n     if(flag==\"0\"){\n               Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sqcg#}'); // '提示','授权成功'\n             var _userId = app.hiddenuserid.getValue();\n             app.orggrid1.store.load({params:{USER_ID:_userId}});\n             app.orggrid.store.load({params:{USER_ID:_userId}});\n           }else{\n              Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg); // 提示\n           }\n  }\n        }); \n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_cancel#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.winorg.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"winappbtn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_OK#}","itemId":"saveappWin","iconCls":"ok_icon"},"events":{"click":"//==============添加应用授权==================\nvar _userId = app.hiddenuserid.getValue();\nvar rows = app.appgrid1.getSelection();\nif(Ext.isEmpty(rows)){\n  Wb.warn('{#xip_auth_user_userM_qxzysqdyy#}'); // 请选择要授权的应用！\n  return false;\n}\nvar _tmpJson;\nvar _addArray = [];\nExt.each(rows,function(a){\n  // _tmpJson = {APP_ID:a.data.APP_ID,USER_ID:_userId};\n  _tmpJson = {appId:a.data.APP_ID,userId:_userId};\n  _addArray.push(_tmpJson); \n});\n\n\n\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveAppSec',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_addArray),\n\n  success: function(res, opts) {\n    var rep = Ext.JSON.decode(res.responseText);\n    var flag = rep.flag;\n    var msg = rep.msg;\n    if(flag==\"0\"){\n      Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sqcg#}'); // '提示','授权成功'\n      var _userId = app.hiddenuserid.getValue();\n      app.appgrid1.store.load({params:{USER_ID:_userId}});\n      app.appgrid.store.load({params:{USER_ID:_userId}});\n    }else{\n      Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg); // 提示\n    }\n  }\n}); \n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_cancel#}","itemId":"closeWin","iconCls":"cancel_icon"},"events":{"click":"app.winapp.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"itemId":"winuserbtn"},"children":[{"configs":{"text":"{#xip_auth_user_userM_auth#}","itemId":"revokeuser","iconCls":"insert_icon"},"events":{"click":"//************************公共变量部分**************************\n//************************************************************\nvar _userRows =app.usergrid.getSelection();\nif(_userRows.length === 0){\n  Wb.warning('{#xip_auth_user_userM_qxzysqdyh#}'); // 请选择要授权的用户！\n  return false;\n}\nvar _userIds = '';\nExt.each(_userRows,function(c){\n    _userIds += '\\''+c.data.USER_ID+'\\',';\n});\n_userIds = _userIds.substring(0,_userIds.length-1);\n//************************复制功能权限**************************\n//************************************************************\nif(app.winTypeHidden.getValue() === 'FUN'){\n//==============授权的功能=======================\nvar _selectedFun = app.menuFunctionTree.getChecked();\n//==============授权的用户=======================\nvar _funIds = '';\nExt.each(_selectedFun,function(b){\n  _funIds += '\\''+b.data.id+'\\',';\n});\n_funIds = _funIds.substring(0,_funIds.length-1);\nvar _validArray = [];\nvar _validUnit= '';\nExt.each(_selectedFun,function(item){\n  if(item.data.node_type!='M'){\n     Ext.each(_userRows,function(a){\n    _validUnit = item.data.id+','+a.data.USER_ID;\n    _validArray.push(_validUnit);\n           });\n   }\n});\n //insert_user_fun_ajax.request(json);\n//================校验授权的重复性================\napp.userGrantedFunStore.load({params:{userIds:_userIds,funIds:_funIds},callback:function(){\n  app.userGrantedFunStore.each(function(d){\n    _validUnit = d.data.FUN_TREE_ID+','+d.data.TARGET_ID;\n    if(Ext.Array.contains(_validArray,_validUnit)){\n       Ext.Array.remove(_validArray,_validUnit);\n    } \n  });\n//================授权已经存在==================\n  if(_validArray.length === 0){\n   Wb.warn('{#xip_auth_user_userM_sqyczqcxxz#}'); // 授权已存在，请重新选择！\n   return false;\n }\n var _copyArray = [];\n var _tmpUnit; \n var _tmpStr;\n Ext.each(_validArray,function(tmpItem){\n     _tmpStr = tmpItem.split(',');\n    // _tmpUnit= {USER_FUN_ID:'',FUN_TREE_ID:_tmpStr[0],TARGET_ID:_tmpStr[1]};\n    _tmpUnit = {funTreeId:_tmpStr[0],targetId:_tmpStr[1],userFunId:''};\n    _copyArray.push(_tmpUnit);\n    // _copyArray.push(_tmpUnit);\n   });  \n//==============执行请求操作=================\n  \n  \n  \nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveUserFun',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_copyArray),\n\n  success: function(res, opts) {\n    var rep = Ext.JSON.decode(res.responseText);\n    var flag = rep.flag;\n    var msg = rep.msg;\n    if(flag==\"0\"){\n\n      Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qxfzcg#}'); // '','权限复制成功！'\n    }else{\n      Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg); // 提示\n    }\n  }\n}); \n// Wb.request({\n//            url: 'm?xwl=xip/auth/user/userM/fundata/insertFun', \n//            params: Wb.apply({\n//                 newArray:Ext.JSON.encode(_copyArray)\n//            }),\n//            success: function() {\n//              Ext.Msg.alert('','权限复制成功！');\n//            }\n//         });  \n}});\n}\n//************************复制角色权限**************************\n//************************************************************\nelse if(app.winTypeHidden.getValue() === 'ROLE'){\n  //==============获取授权的角色============\n  var _rows=app.rolegrid.getSelection();\n  var _roleIds ='';\n  Ext.each(_rows,function(r){\n    _roleIds +='\\''+r.data.ROLE_ID+'\\',';\n  });\n  _roleIds = _roleIds.substring(0,_roleIds.length-1);\n  //==============校验授权的重复性============\n  var roleValidStr ='';\n  var roleValidArray = [];\n  Ext.each(_userRows,function(u){\n    Ext.each(_rows,function(r){\n      roleValidStr = r.data.ROLE_ID+','+u.data.USER_ID;\n      roleValidArray.push(roleValidStr);\n    });\n  });\n  //=================load校验store============\n  app.userGrantedRoleStore.load({params:{userIds:_userIds,roleIds:_roleIds},callback:function(){\n    app.userGrantedRoleStore.each(function(role){\n      roleValidStr = role.data.ROLE_ID+','+role.data.USER_ID;\n      if(Ext.Array.contains(roleValidArray,roleValidStr)){\n        Ext.Array.remove(roleValidArray,roleValidStr);\n      }\n    });\n //=================无需授权================\n if(roleValidArray.length === 0){\n   Wb.warn('{#xip_auth_user_userM_sqyczqcxxz#}'); // '授权已存在，请重新选择！'\n   return false;\n }\n //==============校验完毕，执行角色授权复制操作==============\n  var _roleStrArray = [];\n  var _roleStr='';\n  var _roleUnit;\n Ext.each(roleValidArray,function(tmpItem){\n     _roleStr = tmpItem.split(',');\n  //   _roleUnit= {USER_ROLE_ID:'',ROLE_ID:_roleStr[0],USER_ID:_roleStr[1]};\n     _roleUnit = {roleId:_roleStr[0],userId:_roleStr[1]};\n     _roleStrArray.push(_roleUnit);\n   });  \n//==============执行请求操作=================\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveUserRole',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_roleStrArray),\n\n  success: function(res, opts) {\n              Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qxfzcg#}'); // '','权限复制成功！'\n           }\n        });       \n  }});\n }\n//************************复制组织权限**************************\n//************************************************************\nelse if(app.winTypeHidden.getValue() === 'ORG'){\n//==============授权的组织=======================\nvar _selectedOrg = app.orggrid.getSelection();\nvar _orgIds = '';\nExt.each(_selectedOrg,function(b){\n  _orgIds += '\\''+b.data.ORG_ID+'\\',';\n});\n_orgIds = _orgIds.substring(0,_orgIds.length-1);\nvar _validArray = [];\nvar _validUnit= '';\nExt.each(_selectedOrg,function(item){\n  Ext.each(_userRows,function(a){\n    _validUnit = item.data.ORG_ID+','+a.data.USER_ID;\n    _validArray.push(_validUnit);\n           });\n});\n\n//================校验授权的重复性================\napp.userGrantedOrgStore.load({params:{userIds:_userIds,orgIds:_orgIds},callback:function(){\n  app.userGrantedOrgStore.each(function(d){\n    _validUnit = d.data.ORG_ID+','+d.data.TARGET_ID;\n    if(Ext.Array.contains(_validArray,_validUnit)){\n       Ext.Array.remove(_validArray,_validUnit);\n    } \n  });\n//================授权已经存在==================\n  if(_validArray.length === 0){\n   Wb.warn('{#xip_auth_user_userM_sqyczqcxxz#}'); // '授权已存在，请重新选择！'\n   return false;\n }\n var _copyArray = [];\n var _tmpUnit; \n var _tmpStr;\n Ext.each(_validArray,function(tmpItem){\n     _tmpStr = tmpItem.split(',');\n   //  _tmpUnit= {ORG_SEC_ID:'',ORG_ID:_tmpStr[0],TARGET_ID:_tmpStr[1]};\n   _tmpUnit= {orgSecId:'',orgId:_tmpStr[0],targetId:_tmpStr[1]};\n     _copyArray.push(_tmpUnit);\n   });  \n//==============执行请求操作=================\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveOrgSec',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_copyArray),\n           success: function() {\n             Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qxfzcg#}'); // '','权限复制成功！'\n           }\n        }); \n}});    \n}\n//************************复制应用权限**************************\n//************************************************************\nelse{\n  //==============授权的应用=======================\nvar _selectedApp = app.appgrid.getSelection();\nvar _appIds = '';\nExt.each(_selectedApp,function(b){\n  _appIds += '\\''+b.data.APP_ID+'\\',';\n});\n_appIds = _appIds.substring(0,_appIds.length-1);\nvar _validArray = [];\nvar _validUnit= '';\nExt.each(_selectedApp,function(item){\n  Ext.each(_userRows,function(a){\n    _validUnit = item.data.APP_ID+','+a.data.USER_ID;\n    _validArray.push(_validUnit);\n           });\n});\n\n//================校验授权的重复性================\napp.userGrantedAppStore.load({params:{userIds:_userIds,appIds:_appIds},callback:function(){\n  app.userGrantedAppStore.each(function(d){\n    _validUnit = d.data.APP_ID+','+d.data.USER_ID;\n    if(Ext.Array.contains(_validArray,_validUnit)){\n       Ext.Array.remove(_validArray,_validUnit);\n    } \n  });\n//================授权已经存在==================\n  if(_validArray.length === 0){\n   Wb.warn('{#xip_auth_user_userM_sqyczqcxxz#}'); // '授权已存在，请重新选择！'\n   return false;\n }\n var _copyArray = [];\n var _tmpUnit; \n var _tmpStr;\n Ext.each(_validArray,function(tmpItem){\n     _tmpStr = tmpItem.split(',');\n   //  _tmpUnit= {SEC_ID:'',APP_ID:_tmpStr[0],USER_ID:_tmpStr[1]};\n     _tmpUnit= {secId:'',appId:_tmpStr[0],userId:_tmpStr[1]};\n     _copyArray.push(_tmpUnit);\n   });  \n//==============执行请求操作=================\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=saveAppSec',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_copyArray),\n           success: function() {\n              Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qxfzcg#}'); // '','权限复制成功！'\n           }\n        }); \n}}); \n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"}],"expanded":false,"type":"folder"},{"configs":{"itemId":"selectComb"},"children":[{"configs":{"pageSize":"10","itemId":"store1","url":"m?xwl=xip/auth/user/userM/data/CodeNameSelect","showMask":"false"},"events":{"load":"app.menu1.showBy(app.EMP_CODE_NAME);\napp.EMP_CODE_NAME.focus(false,true);"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"menu1"},"children":[{"configs":{"height":"260","width":"500","layout":"border","itemId":"panel1"},"children":[{"configs":{"region":"center","columnLines":"false","pagingBar":"true","store":"app.store1","scroll":"both","width":"500","forceFit":"true","border":"false","itemId":"selectGrid"},"events":{"beforeselect":"app.EMP_CODE_NAME.setValue(record.get('EMP_CODE_NAME'));\napp.EMP_ID.setValue(record.get('EMP_ID'));\napp.menu1.hide();"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"hidden":"true","dataIndex":"EMP_ID","itemId":"column1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_empCode#}","dataIndex":"EMP_CODE","itemId":"column11"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_empCodeOrName#}","dataIndex":"EMP_CODE_NAME","itemId":"column12"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"menu"}],"expanded":false,"type":"folder"},{"configs":{"itemId":"windows"},"children":[{"configs":{"height":"160","layout":"fit","width":"620","closeAction":"hide","buttons":"app.window1btn","buttonAlign":"center","dialog":"false","itemId":"window1","modal":"true"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"form"},"children":[{"configs":{"hidden":"true","itemId":"USER_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"EMP_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"120","allowBlank":"false","width":"280","labelAlign":"right","itemId":"USER_NAME","fieldLabel":"<font color='red'>*<\/font>{#xip_auth_user_userM_loginAccount#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","queryDelay":"160","allowBlank":"false","queryMode":"remote","width":"280","labelAlign":"right","itemId":"EMP_CODE_NAME","fieldLabel":"<font color='red'>*<\/font>{#xip_auth_user_userM_employee#}"},"events":{"beforequery":"app.store1.load({params:{query:plan.query}});\n","blur":"if(Ext.isEmpty(app.EMP_ID.getValue())){\n  app.EMP_CODE_NAME.setValue('');\n}"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","border":"false","itemId":"panel11"},"children":[{"configs":{"labelWidth":"120","width":"280","labelAlign":"right","itemId":"ATTRIBUTE1","fieldLabel":"{#xip_auth_user_userM_userDesc#}"},"events":{"beforerender":"  "},"children":[],"expanded":true,"type":"text"},{"configs":{"labelWidth":"120","readOnly":"true","width":"280","pickList":"[['S','{#xip_auth_user_userM_systemUser#}'],['U','{#xip_auth_user_userM_customerUser#}']]\n/*[['S','系统用户'],['U','自定义用户']]*/","labelAlign":"right","itemId":"USER_TYPE","fieldLabel":"{#xip_auth_user_userM_userType#}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","border":"false","itemId":"panel111"},"children":[{"configs":{"labelWidth":"120","allowBlank":"false","width":"280","labelAlign":"right","itemId":"START_DATE","fieldLabel":"<font color='red'>*<\/font>{#xip_auth_user_userM_startTime#}"},"children":[],"expanded":false,"type":"date"},{"configs":{"labelWidth":"120","width":"280","labelAlign":"right","itemId":"END_DATE","fieldLabel":"{#xip_auth_user_userM_endTime#}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_passwordReset#}","height":"200","layout":"fit","width":"380","closeAction":"hide","buttons":"app.pwdWinBtn","buttonAlign":"center","dialog":"false","itemId":"pwdwin","modal":"false"},"children":[{"configs":{"bodyStyle":"padding: 30px 0px 0px 20px","frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"pwdform"},"children":[{"configs":{"hidden":"true","itemId":"userId11"},"children":[],"expanded":false,"type":"text"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"100","maxLength":"10","allowBlank":"false","minLength":"6","inputType":"password","labelAlign":"right","itemId":"newPwd","fieldLabel":"<font color='red'>*<\/font>{#xip_auth_user_userM_newPassword#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"true","style":"border-width:0px;padding-top:6px","bodyCls":"my-panel-no-border","layout":"column","border":"false","itemId":"panel11"},"children":[{"configs":{"labelWidth":"100","maxLength":"10","allowBlank":"false","minLength":"6","inputType":"password","labelAlign":"right","itemId":"confirmPwd","fieldLabel":"<font color='red'>*<\/font>{#xip_auth_user_userM_surePassword#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_authDetails#}","height":"500","frame":"true","layout":"border","width":"750","closeAction":"hide","buttonAlign":"center","dialog":"false","itemId":"wincopyfun","modal":"true","maximizable":"true"},"children":[{"configs":{"region":"center","activeTab":"funpanel","itemId":"funtabPanel"},"children":[{"configs":{"title":"{#xip_auth_user_userM_function#}","frame":"false","style":"border-width:0px","layout":"border","border":"false","itemId":"funpanel"},"children":[{"configs":{"rootVisible":"true","region":"center","frame":"false","animate":"false","root":"{id:'groupRootNode',text:'{#xip_auth_user_userM_functiontree#}',expanded:true,checked:false}","buttonAlign":"center","border":"false","itemId":"menuFunctionTree"},"events":{"checkchange":"node.cascadeBy(function(n){\n    n.set('checked', checked); \n});\n    checkParent(node);\nfunction checkParent(node){\n  node = node.parentNode;\n  if(!node) return;\n  var checkP=false;\n  node.cascadeBy(function (n)\n  {\n  if (n != node) {\n  if (n.get('checked') === true) {\n  checkP = true;\n  }\n  }\n  });\n  node.set('checked', checkP);\n  checkParent(node);\n}\n\n"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"{#contextPath#}/userAuthoriseTreeCreateAction.do?method=getUserFunTreeById","fields":"[{name:'text'},{name:'id'},{name:'parent_id'},{name:'node_type'},{name:'node_order'}]\n"},"events":{"load":"app.menuFunctionTree.expandAll();"},"children":[],"expanded":false,"type":"treestore"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_new#}","itemId":"addFunbtn","iconCls":"plus_icon"},"events":{"click":"var _userId = app.hiddenuserid.getValue();\napp.menuFunctionTreeAll.store.load({params:{userId:_userId,isGranted:'N'}});\napp.winfun.show();\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_delete#}","itemId":"delFunbtn","iconCls":"minus_icon"},"events":{"click":"var selectLength = app.menuFunctionTree.getChecked().length;\nif(selectLength===0){\n  Wb.warn('{#xip_auth_user_userM_qxzscdgn#}');/*请选择删除的功能*/\n  return;\n}\nExt.MessageBox.confirm('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qdyscsxjl#}',function(a){/*提示','确定要删除所选记录？*/\n  if(a === 'yes'){\n\n    var user_id=app.hiddenuserid.getValue();\n    var _delSelectRecord = app.menuFunctionTree.getChecked();\n    var _delArray = [];\n    var _delUnit;\n    for(var i = 0;i<selectLength;i++){\n      var item = _delSelectRecord[i];\n      if(item.data.node_type === 'F'){  \n     // _delUnit = {FUN_TREE_ID:item.data.id,TARGET_ID:user_id};\n         _delUnit = {funTreeId:item.data.id,targetId:user_id};\n      _delArray.push(_delUnit);\n  } \n}\n//==============执行请求操作=================\n\nExt.Ajax.request({\n  url: '{#contextPath#}'+'/hrAction.do?method=delUserFun',\n  method: 'POST',\n  sync: false,\n  timeout: 300000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  jsonData: Ext.JSON.encode(_delArray),\n\n  success: function(res, opts) {\n    var rep = Ext.JSON.decode(res.responseText);\n    var flag = rep.flag;\n    var msg = rep.msg;\n     if(flag==\"0\"){\n          var _userId = app.hiddenuserid.getValue();\n          app.menuFunctionTree.store.load({params:{userId:_userId,isGranted:'Y'}});\n          Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sccg#}');/*删除成功*/\n     }else{\n        Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg);/*提示*/\n     }\n        }\n      });\n  }\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item31"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_copyAuth#}","itemId":"copyFunButton","iconCls":"copy_icon"},"events":{"click":"app.usergrid.store.load();\nvar selectLength = app.menuFunctionTree.getChecked().length;\nif(selectLength===0){\n  Wb.warn('{#xip_auth_user_userM_qxzyfzdgn#}');/*请选择要复制的功能*/\n  return false;\n}\napp.winuser.show();\n\napp.winTypeHidden.setValue('FUN');\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item32"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"queryFun"},"events":{"specialkey":"app.queryFunTree.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"queryFunTree","iconCls":"seek_icon"},"events":{"click":"filterBy(app.queryFun.getValue(),'text', app.menuFunctionTree);\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item321"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"tree"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#xip_auth_user_userM_role#}","style":"border-width:0px","layout":"border","border":"false","itemId":"rolepanel"},"children":[{"configs":{"region":"center","selType":"checkboxmodel","itemId":"rolegrid","simpleSelect":"true"},"children":[{"configs":{"pageSize":"25","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectRole"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_new#}","itemId":"roleAddBtn","iconCls":"plus_icon"},"events":{"click":"var _userId = app.hiddenuserid.getValue();\napp.rolegrid1.store.reload({params:{USER_ID:_userId}});\napp.winrole.show();\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_delete#}","itemId":"deletebtn","iconCls":"minus_icon"},"events":{"click":"\n\nvar recs = app.rolegrid.getSelection();\nif (!recs.length) {\n  Wb.warn('{#xip_auth_user_userM_qxzxuscdjl#}');/*请选择需要删除的记录*/\n  return false ;\n}\n\n Ext.Msg.confirm('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_nqdysc#}',function(a){/*提示','您确定要删除？*/\n    if(a=='yes'){\n      \n            var idList = \"\" ;\n      Ext.each(recs,function(r){\n        var id = \"'\" + r.data.USER_ROLE_ID + \"'\";\n        if(idList === \"\"){\n          idList = id ;\n        }else{\n          idList = idList+\",\"+id ;\n        }\n      });\n      var json = {'ids' : idList} ;\n      \n      \n      Ext.Ajax.request({\n        url: '{#contextPath#}'+'/hrAction.do?method=delUserRole',\n        method: 'POST',\n        sync: false,\n        timeout: 300000,\n\n        params: json,\n        success: function(res, opts) {\n          \n          var rep = Ext.JSON.decode(res.responseText);\n          var flag = rep.flag;\n\n          if(flag==\"0\"){\n          Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sccg#}');/*删除成功*/\n           Wb.remove(app.rolegrid,recs);\n          }else{\n            Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg);/*提示*/\n          }\n        }\n      });\n  \n    }else{\n      return false ;\n    }\n   \n   });\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item31"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_copyAuth#}","itemId":"copyRoleBtn","iconCls":"copy_icon"},"events":{"click":"app.usergrid.store.load();\nvar rows = app.rolegrid.getSelection();\nif(Ext.isEmpty(rows)){\n  Wb.warn('{#xip_auth_user_userM_qxzysqdjs#}'); /*请选择要授权的角色*/\n  return false;\n}\napp.winuser.show();\napp.winTypeHidden.setValue('ROLE');"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item32"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"queryrole"},"events":{"specialkey":"app.queryrolegird.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"queryrolegird","iconCls":"seek_icon"},"events":{"click":"app.rolegrid.store.load({params:{USER_ID:app.hiddenuserid.getValue(),queryrole:app.queryrole.getValue()}});\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item321"},"children":[],"expanded":false,"type":"item"},{"configs":{"hidden":"true","itemId":"hiddenuserid"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ROLE_ID","hidden":"true","dataIndex":"ROLE_ID","itemId":"ROLE_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_roleName1#}","dataIndex":"ROLE_NAME","itemId":"ROLE_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_roleDesc#}","dataIndex":"DESCRIPTION","itemId":"DESCRIPTION_COL2","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"USER_ROLE_ID","itemId":"userroleid"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#xip_auth_user_userM_org#}","style":"border-width:0px","layout":"border","border":"false","itemId":"orgpanel"},"children":[{"configs":{"region":"center","selType":"checkboxmodel","itemId":"orggrid","simpleSelect":"true"},"children":[{"configs":{"pageSize":"25","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectOrg"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_new#}","itemId":"addOrgBtn","iconCls":"plus_icon"},"events":{"click":"var _userId = app.hiddenuserid.getValue();\napp.orggrid1.store.load({params:{USER_ID:_userId}});\napp.winorg.show();\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_delete#}","itemId":"delOrgBtn","iconCls":"minus_icon"},"events":{"click":"var recs = app.orggrid.getSelection();\nif (!recs.length) {\n  Wb.warn('{#xip_auth_user_userM_qxzxuscdjl#}');/*请选择需要删除的记录*/\n  return false ;\n}\n Ext.Msg.confirm('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_nqdysc#}',function(a){/*提示','您确定要删除？*/\n    if(a=='yes'){\n      \n      \n       var idList = \"\" ;\n      Ext.each(recs,function(r){\n        var id = \"'\" + r.data.ORG_SEC_ID + \"'\";\n        if(idList === \"\"){\n          idList = id ;\n        }else{\n          idList = idList+\",\"+id ;\n        }\n      });\n      var json = {'ids' : idList} ;\n      \n      \n            Ext.Ajax.request({\n        url: '{#contextPath#}'+'/hrAction.do?method=delOrgSec',\n        method: 'POST',\n        sync: false,\n        timeout: 300000,\n\n        params: json,\n        success: function(res, opts) {\n          \n          var rep = Ext.JSON.decode(res.responseText);\n          var flag = rep.flag;\n      \n        if(flag==\"0\"){\n\n          Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sccg#}');/*删除成功*/\n           Wb.remove(app.orggrid,recs);\n        }else{\n            Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg);/*提示*/\n          }\n        }\n      });\n  \n    }else{\n      return false ;\n    }\n   \n   });\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item31"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_copyAuth#}","itemId":"orgCopyBtn","iconCls":"copy_icon"},"events":{"click":"app.usergrid.store.load();\nvar rows = app.orggrid.getSelection();\nif(Ext.isEmpty(rows)){\n  Wb.warn('{#xip_auth_user_userM_qxzysqdzz#}'); /*请选择要授权的组织*/\n  return false;\n}\n\napp.winuser.show();\n\napp.winTypeHidden.setValue('ORG');"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item32"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"queryorg"},"events":{"specialkey":"app.queryorggird.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"queryorggird","iconCls":"seek_icon"},"events":{"click":"app.orggrid.store.load({params:{USER_ID:app.hiddenuserid.getValue(),queryorg:app.queryorg.getValue()}});\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item321"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO4"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ORG_ID","hidden":"true","dataIndex":"ORG_ID","itemId":"ORG_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_orgCode#}","dataIndex":"ORG_CODE","itemId":"ORG_CODE_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_orgName#}","dataIndex":"ORG_NAME","itemId":"ORG_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"org_sec_id","hidden":"true","dataIndex":"ORG_SEC_ID","itemId":"ORG_SEC_ID_col"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#xip_auth_user_userM_application#}","style":"border-width:0px","layout":"border","border":"false","itemId":"apppanel"},"children":[{"configs":{"region":"center","selType":"checkboxmodel","itemId":"appgrid","simpleSelect":"true"},"children":[{"configs":{"pageSize":"25","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectApp"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_new#}","itemId":"addAppBtn","iconCls":"plus_icon"},"events":{"click":"var _userId = app.hiddenuserid.getValue();\napp.appgrid1.store.load({params:{USER_ID:_userId}});\napp.winapp.show();\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_delete#}","itemId":"delAppBtn","iconCls":"minus_icon"},"events":{"click":"var recs = app.appgrid.getSelection();\nif (!recs.length) {\n  Wb.warn('{#xip_auth_user_userM_qxzxuscdjl#}');/*请选择需要删除的记录*/\n  return false ;\n}\n Ext.Msg.confirm('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_nqdysc#}',function(a){/*提示','您确定要删除？*/\n    if(a=='yes'){\n      \n         \n       var idList = \"\" ;\n      Ext.each(recs,function(r){\n        var id = \"'\" + r.data.SEC_ID + \"'\";\n        if(idList === \"\"){\n          idList = id ;\n        }else{\n          idList = idList+\",\"+id ;\n        }\n      });\n      var json = {'ids' : idList} ;\n      \n      \n      \n            Ext.Ajax.request({\n        url: '{#contextPath#}'+'/hrAction.do?method=delAppSec',\n        method: 'POST',\n        sync: false,\n        timeout: 300000,\n\n        params: json,\n        success: function(res, opts) {\n               var rep = Ext.JSON.decode(res.responseText);\n          var flag = rep.flag;\n      \n        if(flag==\"0\"){\n          Ext.Msg.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_sccg#}');/*删除成功*/\n           Wb.remove(app.appgrid,recs);\n        }else{\n            Ext.Msg.alert(\"{#xip_auth_user_userM_prompt#}\",rep.msg);/*提示*/\n          }\n        }\n      });\n  \n    }else{\n      return false ;\n    }\n   \n   });\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item31"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_copyAuth#}","itemId":"copyAppSecBtn","iconCls":"copy_icon"},"events":{"click":"app.usergrid.store.load();\nvar rows = app.appgrid.getSelection();\nif(Ext.isEmpty(rows)){\n  Wb.warn('{#xip_auth_user_userM_qxzysqdyy#}'); /*请选择要授权的应用*/\n  return false;\n}\napp.winuser.show();\napp.winTypeHidden.setValue('APP');"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item32"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"queryapp"},"events":{"specialkey":"app.queryappgird.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"queryappgird","iconCls":"seek_icon"},"events":{"click":"app.appgrid.store.load({params:{USER_ID:app.hiddenuserid.getValue(),queryapp:app.queryapp.getValue()}});\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item321"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO2"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"SEC_ID","hidden":"true","dataIndex":"SEC_ID","itemId":"SEC_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"APP_ID","hidden":"true","dataIndex":"APP_ID","itemId":"APP_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_appName#}","dataIndex":"APP_NAME","itemId":"APP_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_appDesc#}","dataIndex":"APP_DESC","itemId":"APP_DESC_COL","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"tab"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_authUser#}","height":"400","frame":"true","layout":"border","width":"580","closeAction":"hide","buttons":"app.winuserbtn","buttonAlign":"center","border":"false","itemId":"winuser","modal":"true"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","border":"false","itemId":"userform"},"children":[{"configs":{"height":"35","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"orgPanel"},"children":[{"configs":{"labelWidth":"60","queryMode":"local","displayField":"NAME","width":"345","valueField":"CODE","emptyText":"{#xip_auth_user_userM_selectOrg#}","labelAlign":"right","itemId":"orgcomboBox","fieldLabel":"{#xip_auth_user_userM_org#}","editable":"true"},"events":{"select":"app.orgcomboBox.focus();\nvar dept_id = app.depcomboBox.getValue();\nif(dept_id===null||dept_id===''){\n  \n  var ORG_ID = app.orgcomboBox.getValue();\n \n  app.depcomboBox.store.load({params:{ORG_ID:ORG_ID}});\n}else{\n \n  var ORG_ID = app.orgcomboBox.getValue();\n  app.depcomboBox.store.load({params:{ORG_ID:ORG_ID}});\n  app.depcomboBox.clearValue();\n}\nvar ORG_ID = app.orgcomboBox.getValue();\napp.usergrid.store.load();"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectOrgs"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"height":"35","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"deptPanel"},"children":[{"configs":{"labelWidth":"60","queryMode":"local","displayField":"DEPT_NAME","width":"345","valueField":"DEPT_ID","emptyText":"{#xip_auth_user_userM_selectDept#}","labelAlign":"right","itemId":"depcomboBox","fieldLabel":"{#xip_auth_user_userM_Dept#}"},"events":{"select":"var DEPT_ID = app.depcomboBox.getValue();\napp.usergrid.store.load();\n","focus":"var DEPT_ID = app.depcomboBox.getValue();\nif(DEPT_ID===null || DEPT_ID===''){\n  if(app.orgcomboBox.getValue()===null){\n    app.depcomboBox.store.removeAll();\n  }\n}\n"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectDeptName"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"height":"35","frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"60","labelAlign":"right","itemId":"userN","fieldLabel":"{#xip_auth_user_userM_username#}"},"events":{"specialkey":"app.usergrid.store.load({params:{userN:app.userN.getValue()}});"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"userQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.usergrid.store.load({params:{userN:app.userN.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_reset#}","itemId":"userResetBtn","iconCls":"refresh_icon","x":"25"},"events":{"click":"app.orgcomboBox.clearValue();\napp.depcomboBox.clearValue();\napp.userN.setValue('');\napp.usergrid.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"itemId":"winTypeHidden"},"children":[],"expanded":false,"type":"hidden"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"usergrid","simpleSelect":"true"},"children":[{"configs":{"pageSize":"25","autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/noOrgDeptGridUser"},"events":{"beforeload":"var whereSql= ' AND 1=1';\nif(Ext.isEmpty(app.orgcomboBox.getValue()) && Ext.isEmpty(app.depcomboBox.getValue())){\n  store.getProxy().url='m?xwl=xip/auth/user/userM/fundata/noOrgDeptGridUser';  //noOrgDeptUser\n}else{\n  store.getProxy().url='m?xwl=xip/auth/user/userM/fundata/orgDeptGridUser';  //selectOrgDeptUser\n}\nif(!Ext.isEmpty(app.orgcomboBox.getValue())){ \n  whereSql +=' AND b.ORG_ID =\\''+app.orgcomboBox.getValue()+'\\'';\n}\nif(!Ext.isEmpty(app.depcomboBox.getValue())){\n  whereSql +=' AND b.DEPT_ID =\\''+app.depcomboBox.getValue()+'\\'';\n}\nstore.getProxy().extraParams.WHERESQL = whereSql;\n"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"nouser"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"USER_ID","hidden":"true","dataIndex":"USER_ID","itemId":"USER_ID_COL1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_username#}","width":"150","dataIndex":"USER_NAME","itemId":"USER_NAME_COL1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_empName#}","dataIndex":"EMP_NAME","itemId":"EMP_NAME_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_addFunction#}","height":"400","frame":"true","layout":"border","width":"580","closeAction":"hide","buttons":"app.winfunbtn","buttonAlign":"center","border":"false","itemId":"winfun","modal":"true"},"children":[{"configs":{"rootVisible":"false","region":"center","animate":"false","root":"{id:'rootNode',text:'{#xip_auth_user_userM_functionmenu#}',expanded:true}\n","itemId":"menuFunctionTreeAll","viewConfig":"{\n  plugins : {\n    pluginId: 'ddPlug',\n    ptype: 'treeviewdragdrop'\n  },\n  listeners : {\n    beforedrop: function(node,data,overModel,dropPosition,dropFunction,options){\n      return false;\n    },\n    drop: function(node,data,overModel,dropPosition,options){\n      return false;\n    }\n  }\n}"},"events":{"checkchange":"node.cascadeBy(function(n){\n    n.set('checked', checked); \n});\n    checkParent(node);\nfunction checkParent(node){\n  node = node.parentNode;\n  if(!node) return;\n  var checkP=false;\n  node.cascadeBy(function (n)\n  {\n  if (n != node) {\n  if (n.get('checked') === true) {\n  checkP = true;\n  }\n  }\n  });\n  node.set('checked', checkP);\n  checkParent(node);\n}\n"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"{#contextPath#}/userAuthoriseTreeCreateAction.do?method=getUserFunTreeById","fields":"[{name:'text'},{name:'id'},{name:'parent_id'},{name:'node_type'},{name:'node_order'}]\n"},"events":{"load":"app.menuFunctionTreeAll.expandAll();"},"children":[],"expanded":false,"type":"treestore"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"itemId":"queryFunAll"},"events":{"specialkey":"app.queryFunTreeAll.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"queryFunTreeAll","iconCls":"seek_icon"},"events":{"click":"filterBy(app.queryFunAll.getValue(),'text', app.menuFunctionTreeAll);\n\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"tree"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_addRole#}","height":"400","frame":"true","layout":"border","width":"580","closeAction":"hide","buttonAlign":"center","buttons":"app.winrolebtn","border":"false","itemId":"winrole","modal":"true"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"roleform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"roleN","fieldLabel":"{#xip_auth_user_userM_roleName2#}"},"events":{"specialkey":"app.roleQueryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"roleQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.rolegrid1.store.load({params:{USER_ID:app.hiddenuserid.getValue(),roleN:app.roleN.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"rolegrid1","simpleSelect":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectRoleAll"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO5"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ROLE_ID","hidden":"true","dataIndex":"ROLE_ID","itemId":"ROLE_ID_COL1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_roleName1#}","dataIndex":"ROLE_NAME","itemId":"ROLE_NAME_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_roleDesc#}","dataIndex":"DESCRIPTION","itemId":"DESCRIPTION_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"USER_ROLE_ID","itemId":"userroleid1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_addOrg#}","height":"400","frame":"true","layout":"border","width":"580","closeAction":"hide","buttons":"app.winorgbtn","buttonAlign":"center","border":"false","itemId":"winorg","modal":"true"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"orgform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"orgN","fieldLabel":"{#xip_auth_user_userM_orgName#}"},"events":{"specialkey":"app.orgQueryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"orgQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.orggrid1.store.load({params:{USER_ID:app.hiddenuserid.getValue(),orgN:app.orgN.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"orggrid1","simpleSelect":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectOrgAll"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO7"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ORG_ID","hidden":"true","dataIndex":"ORG_ID","itemId":"ORG_ID_COL1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_orgCode#}","dataIndex":"ORG_CODE","itemId":"ORG_CODE_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_orgName#}","dataIndex":"ORG_NAME","itemId":"ORG_NAME_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"org_sec_id","hidden":"true","dataIndex":"ORG_SEC_ID","itemId":"ORG_SEC_ID_COL1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"title":"{#xip_auth_user_userM_addApp#}","height":"400","frame":"true","layout":"border","width":"580","closeAction":"hide","buttons":"app.winappbtn","buttonAlign":"center","border":"false","itemId":"winapp","modal":"true"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","layout":"form","border":"false","itemId":"appform"},"children":[{"configs":{"frame":"true","style":"border-width:0px","layout":"column","border":"false","itemId":"tr"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"appN","fieldLabel":"{#xip_auth_user_userM_appName#}"},"events":{"specialkey":"app.appQueryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"appQueryBtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.appgrid1.store.load({params:{USER_ID:app.hiddenuserid.getValue(),appN:app.appN.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"appgrid1","simpleSelect":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/auth/user/userM/fundata/selectAppAll"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"XUHAO6"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"SEC_ID","hidden":"true","dataIndex":"SEC_ID","itemId":"SEC_ID_COL1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"APP_ID","hidden":"true","dataIndex":"APP_ID","itemId":"APP_ID_COL1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_appName#}","dataIndex":"APP_NAME","itemId":"APP_NAME_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_appDesc#}","dataIndex":"APP_DESC","itemId":"APP_DESC_COL1","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"}],"expanded":false,"type":"folder"},{"configs":{"autoScroll":"true","layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"70","frame":"true","style":"border-width:0px","layout":"fit","border":"false","itemId":"conditionForm"},"children":[{"configs":{"title":"{#xip_auth_user_userM_queryConditions#}","layout":"column","itemId":"fieldset1"},"children":[{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"text1","fieldLabel":"{#xip_auth_user_userM_loginAccount#}"},"events":{"specialkey":"app.querybtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"160","labelAlign":"right","itemId":"text2","fieldLabel":"{#xip_auth_user_userM_empCodeOrEmpName#}"},"events":{"specialkey":"app.querybtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#xip_auth_user_userM_query#}","itemId":"querybtn","iconCls":"seek_icon","x":"10"},"events":{"click":"app.grid1.store.load( {  params:{text1Upper:app.text1.getValue().toUpperCase(), text2:app.text2.getValue()}} );"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#xip_auth_user_userM_reset#}","itemId":"resetbtn","iconCls":"refresh_icon","x":"20"},"events":{"click":"app.conditionForm.getForm().reset();\napp.grid1.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","selType":"checkboxmodel","border":"true","itemId":"grid1","simpleSelect":"false"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xip/auth/user/userM/data/selelct"},"events":{"beforeload":"store.getProxy().extraParams.godMoadl = '{#godMoadl#}';"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_new#}","itemId":"addBtn","iconCls":"application_add_icon"},"events":{"click":"\nvar win = new Ext.window.Window(app._window1);\nwin.show();\napp.window1.setTitle('{#xip_auth_user_userM_xzyh#}');/*新增用户*/\napp.START_DATE.setValue(new Date());\napp.USER_TYPE.setValue('U');\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_modify#}","itemId":"editBtn","iconCls":"table_edit_icon"},"events":{"click":"var rows= app.grid1.getSelection();\nvar _userType = rows[0].data.USER_TYPE;\n// \nWb.edit(app.grid1,app.window1);\napp.USER_NAME.setReadOnly(true);\n\nvar _sysMode = '{#sysMode#}';\n// if this is a god mode\nif(_sysMode === 'Y'){\n//可以修改所有的用户  \n     app.saveWin.show();\n     \n     app.savenextWin.show();\n   \n}else{\n//S level user can not be modified\n  if(_userType === 'S'){\n  \n     app.saveWin.hide();\n     app.savenextWin.hide();\n  }else{\n   app.saveWin.show();\n     app.savenextWin.show();\n  }\n  \n}\n\napp.window1.setTitle('{#xip_auth_user_userM_bjyh#}');/*编辑用户*/\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_passwordReset#}","itemId":"modifyPwdBtn","iconCls":"user_icon"},"events":{"click":"var sm = app.grid1.getSelectionModel();\nif(!sm.hasSelection()){\n  Ext.MessageBox.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qxzyh#}');/*提示','请选择用户*/\n  return false;\n}\nvar rows = sm.getSelection();\nvar ids = '';\nExt.each(rows,function(a){\n  ids += \"'\"+a.data.USER_ID+\"',\";\n});\nids = ids.substring(0,ids.length-1);\napp.userId11.setValue(ids);\napp.pwdwin.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item31"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_authDetails#}","itemId":"copyfunbtn","iconCls":"key_icon"},"events":{"click":"var win = new Ext.window.Window(app.wincopyfun);\nvar sm = app.grid1.getSelectionModel();\nif(!sm.hasSelection() || sm.getSelection().length>1){\n  Ext.MessageBox.alert('{#xip_auth_user_userM_prompt#}','{#xip_auth_user_userM_qxzytyhxx#}');/*提示','请选择一条用户信息*/\n  return false;\n}\nvar rows = sm.getSelection();\nvar _isValid = rows[0].data.ENABLE_FLAG;\nif(_isValid <0 || _isValid ===0){\n  Wb.warn('{#xip_auth_user_userM_yhysx#}');/*用户已失效*/\n  return false;\n}\nvar _userId = rows[0].data.USER_ID;\nwin.show();\napp.hiddenuserid.setValue(_userId);\napp.menuFunctionTree.store.load({params:{userId:_userId,isGranted:'Y'}});\n\napp.orggrid.store.load({params:{USER_ID : _userId}});\napp.rolegrid.store.load({params:{USER_ID : _userId}});\napp.appgrid.store.load({params:{USER_ID : _userId}});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item32"},"children":[],"expanded":true,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_export#}","itemId":"exportBtn","iconCls":"db_export_icon"},"events":{"click":"var dbType = '{#dbType#}';\n\nif(dbType == \"mysql\"){\n  Xip.exportExcel('XIP_PUB_USERS', {userName:app.text1.getValue().toUpperCase(), empCodeName:app.text2.getValue()}, '{#xip_auth_user_userM_User#}');\n}else{\n  Xip.exportExcel('XIP_PUB_USERS_ORACLE', {userName:app.text1.getValue().toUpperCase(), empCodeName:app.text2.getValue()}, '{#xip_auth_user_userM_User#}');\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item11"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#xip_auth_user_userM_import#}","itemId":"importBtn","iconCls":"db_import_icon"},"events":{"click":"var dbType = '{#dbType#}';\n\nif(dbType == \"mysql\"){\n  Xip.importExcel('XIP_PUB_USERS', null);\n}else{\n  Xip.importExcel('XIP_PUB_USERS_ORACLE', null);\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item4"},"children":[],"expanded":false,"type":"item"}],"expanded":false,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#xip_auth_user_userM_serialNum#}","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"chartNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"用户标识","hidden":"true","dataIndex":"USER_ID","itemId":"COLUMN_USER_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"员工ID","hidden":"true","dataIndex":"EMP_ID","itemId":"COLUMN_EMP_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_loginAccount#}","width":"120","dataIndex":"USER_NAME","itemId":"COLUMN_USER_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_empName#}","hidden":"true","width":"220","dataIndex":"EMP_NAME","itemId":"COLUMN_EMP_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_empCode#}","hidden":"true","dataIndex":"EMP_CODE","itemId":"COLUMN_EMP_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_empCodeOrEmpName#}","width":"150","dataIndex":"EMP_CODE_NAME","itemId":"COLUMN_EMP_CODE_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_userDesc#}","width":"200","dataIndex":"ATTRIBUTE1","itemId":"COLUMN_ATTRIBUTE1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_userType#}","dataIndex":"USER_TYPE","itemId":"COLUMN_USER_TYPE","renderer":"if(record.get('USER_TYPE')=='S'){\n  return '{#xip_auth_user_userM_SysUser#}';\n}else if(record.get('USER_TYPE')=='U'){\n  return '{#xip_auth_user_userM_customUser#}';\n}else{\n  return record.get('USER_TYPE');\n}\n"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_startTime#}","dataIndex":"START_DATE","itemId":"COLUMN_START_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_endTime#}","dataIndex":"END_DATE","itemId":"COLUMN_END_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_status#}","align":"center","width":"80","dataIndex":"ENABLE_FLAG","titleAlign":"center","itemId":"COLUMN_ENABLE_FLAG","renderer":"if(Ext.isEmpty(record.data.END_DATE)){\n  return \"\";\n}else{\n  if(value ===0 || value <0){\n  return \"<font color='red'>{#xip_auth_user_userM_ysx#}<\/font>\";\n}else{\n  return \"\";\n}\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#xip_auth_user_userM_lastUpdatePwdTime#}","width":"150","dataIndex":"LAST_CHG_PW_DATE","itemId":"COLUMN_LAST_CHG_PW_DATE"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}