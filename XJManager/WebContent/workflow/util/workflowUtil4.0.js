var _getContextPath=function(){var c=document.location.pathname;var b=c.substr(1).indexOf("/");var a=c.substr(0,b+1);return a};var contextPath=_getContextPath();document.write('<script src="'+contextPath+'/xip/js/xip.js" type="text/javascript" ><\/script>');var WorkFlowConstants={TASK_BTN_CONSULT:"btnConsult",TASK_BTN_DELEGATE:"btnDelegate",TASK_BTN_BACK:"btnBack",TASK_BTN_CONSULT_CLOSE:"btnCloseConsult",TASK_BTN_CONSULT_REVOKE:"btnRevokeConsult",TASK_BTN_SUBMIT:"btnSubmit",TASK_BTN_CANCEL:"btnCancel",TASK_BTN_COPYTO:"btnCopyTo",TASK_BTN_REJECT:"btnReject"};function jsonToAjaxParam(c){var b="";for(var a in c){b+=a+"="+c[a]+"&"}return b}function sendRequest(a,c){var b=Ext.lib.Ajax.getConnectionObject().conn;b.open("post",a,false);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");b.send(jsonToAjaxParam(c));return b.responseText}function sendAjaxRequest(a,b,c){if(!b){b={}}Ext.Ajax.request({url:a,method:"POST",timeout:300000,params:b,success:function(d,e){Ext.Msg.hide();c(Ext.JSON.decode(d.responseText))},failure:function(d,e){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请求提交失败，可能是网络或其他原因":XipLang.xwf_lang_request_error))}})}function createInstanceByProcessId(c,d){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"根据流程Id创建流程实例....":XipLang.xwf_lang_id_create));var a=contextPath+"/workflowUtilAction.do?method=createInstanceByProcessId";var b={processId:c};sendAjaxRequest(a,b,d)}function createInstanceByProcessCode(c,d){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"根据流程Code创建流程实例....":XipLang.xwf_lang_ins_create));var a=contextPath+"/workflowUtilAction.do?method=createInstanceByProcessCode";var b={processCode:c};sendAjaxRequest(a,b,d)}function createInstanceByEntityCode(a,b,c){getProcessIdByEntityCode(a,b,function(d){if(d.flag!=0){if(c){c(d)}Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),d.msg);return}var e=d.processId;createInstanceByProcessId(e,c)})}function getProcessIdByEntityCode(e,f,g){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"正在根据流程实体编码查询可执行流程....":XipLang.xwf_lang_pro_code_query));var a=contextPath+"/workflowUtilAction.do?method=getProcessIdByEntityCodeOld";if(!f){f={}}else{if(typeof(f)!="object"){try{f=Ext.JSON.decode(f)}catch(c){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),c);return}}}var b={entityCode:e,entityAttJson:f};var d=Ext.JSON.encode(b);Ext.Ajax.request({url:a,method:"POST",async:true,scope:this,timeout:300000,headers:{"Content-Type":"application/json"},jsonData:d,success:function(r,j){Ext.Msg.hide();var t=Ext.JSON.decode(r.responseText);if(t.flag==0){var l=t.processId;var m=f.e_instance_code;if(m!=null&&m!=""&&m!="undefined"){restartInstanceSubmit(m,l,f,g)}else{if(g){g(t)}}}else{if(t.flag==1){var s={flag:1,msg:t.msg};Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"寻找可执行流程失败：":XipLang.xwf_lang_pro_effective)+t.msg,function(){g(s)})}else{var q=new Array();for(var n=0;n<t.data.length;n++){var p=t.data[n];var u={processId:p.processId,processCode:p.processCode,processName:p.processName};q[n]=u}function k(){var v=h.getSelectionModel().getSelection();if(v.length==1){var i=v[0];Ext.MessageBox.confirm((Ext.isEmpty(XipLang)==true?"确认流程":XipLang.xwf_lang_confirm_pro),(Ext.isEmpty(XipLang)==true?"已选择流程：":XipLang.xwf_lang_confirm_pro)+"【"+i.get("processName")+"】,"+(Ext.isEmpty(XipLang)==true?"确定继续吗？":XipLang.wf_util_process_continue),function(w){if(w=="yes"){f.flag=0;f.processId=i.get("processId");f.processCode=i.get("processCode");f.processName=i.get("processName");o.close();g(f)}})}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请先选中一条流程！":XipLang.xwf_lang_one_choose))}}var h=Ext.create("Ext.grid.Panel",{store:{data:q,fields:[{name:"processId",type:"string"},{name:"processCode",type:"string"},{name:"processName",type:"string"}]},selModel:{showHeaderCheckbox:false,selType:"checkboxmodel",mode:"SINGLE"},columns:[new Ext.grid.RowNumberer(),{text:"ID",dataIndex:"processId",hidden:true},{text:(Ext.isEmpty(XipLang)==true?"流程编码":XipLang.xwf_lang_process_code),dataIndex:"processCode",width:130},{text:(Ext.isEmpty(XipLang)==true?"流程名称":XipLang.xwf_lang_process_name),dataIndex:"processName",width:180}],height:200,width:400,listeners:{rowdblclick:k}});var o=new Ext.Window({width:440,height:400,layout:"fit",buttonAlign:"center",items:[h],modal:true,closeAction:"close",title:(Ext.isEmpty(XipLang)==true?"找到多个流程,请选择一条":XipLang.wf_util_find_many_pro),buttons:[{text:(Ext.isEmpty(XipLang)==true?"确定":XipLang.xwf_lang_btn_confirm),handler:k},{text:(Ext.isEmpty(XipLang)==true?"取消":XipLang.xwf_lang_btn_cancel),handler:function(){o.close()}}]});o.show()}}},failure:function(h,i){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请求提交失败，可能是网络或其他原因":XipLang.xwf_lang_request_error))}})}function submitInstance(d,f,g){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"'流程实例提交中....":XipLang.xwf_lang_ins_submit));if(!f){f={}}else{if(typeof(f)!="object"){try{f=Ext.JSON.decode(f)}catch(c){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),c);return}}}var a=contextPath+"/workflowUtilAction.do?method=submitProcessOld";var b={instanceCode:d,entityAttJson:f};var e=Ext.JSON.encode(b);Ext.Ajax.request({url:a,method:"POST",scope:this,timeout:300000,headers:{"Content-Type":"application/json"},jsonData:e,success:function(q,i){Ext.Msg.hide();var s=Ext.decode(q.responseText);if(s.flag==0){var r={flag:0,instanceCode:d};g(r)}else{if(s.flag==1){var r={flag:1,msg:s.msg};g(r)}else{var k=s.data;var m=s.multiselect;var l="";if(k.length>0){l='<font color="red">【'+k[0].actName+"】</font>"}var o=Ext.create("Ext.selection.CheckboxModel",{showHeaderCheckbox:m=="Y"?true:false,selType:"checkboxmodel",mode:m=="Y"?"MULTI":"SINGLE"});var p=Ext.create("Ext.form.field.Text",{id:"selUserId",width:250,inputType:"text",labelSeparator:":",fieldLabel:(Ext.isEmpty(XipLang)==true?"用户名":XipLang.xwf_lang_user_name),labelWidth:80,labelAlign:"right",listeners:{specialkey:function(v,u){if(u.getKey()==u.ENTER){var t=p.getValue();store.filterBy(function(w,y){var x=w.get("empName");return(x.indexOf(t)!=-1)})}}}});function j(){var u=h.getSelectionModel().getSelection();if(u.length>0){var w="";var x="";for(var v=0;v<u.length;v++){var t=u[v];w+=""+t.get("userId")+",";x+=t.get("empName")+"("+t.get("userName")+"),"}w=w.substring(0,w.length-1);x=x.substring(0,x.length-1);Ext.MessageBox.confirm((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"确认审批人":XipLang.xwf_lang_confirm_auditor)+":【"+x+"】？",function(B){if(B=="yes"){n.close();var y=contextPath+"/workflowUtilAction.do?method=submitProcessOld";var z={instanceCode:d,entityAttJson:f,userIds:w};var A=Ext.JSON.encode(z);Ext.Ajax.request({url:y,method:"POST",sync:"",scope:this,timeout:300000,headers:{"Content-Type":"application/json"},jsonData:A,success:function(D,E){var C=Ext.decode(D.responseText);if(C.flag==0){var F={flag:0,instanceCode:d};g(F)}else{if(C.flag==1){var F={flag:1,msg:C.msg};g(F)}}},failure:function(C,D){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请求提交失败，可能是网络或其他原因":XipLang.xwf_lang_request_error))}})}})}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请先选择审批人":XipLang.xwf_lang_auditor_choose))}}var h=new Ext.grid.GridPanel({selModel:o,store:{data:k,fields:["userId","actName","userName","empName","orgName"]},columns:[new Ext.grid.RowNumberer(),{text:"ID",dataIndex:"userId",hidden:true},{text:"actName",dataIndex:"actName",hidden:true,width:200},{text:(Ext.isEmpty(XipLang)==true?"用户名":XipLang.xwf_lang_user_name),dataIndex:"userName",width:120},{text:(Ext.isEmpty(XipLang)==true?"员工名":XipLang.xwf_lang_emp_name),dataIndex:"empName",width:100},{text:(Ext.isEmpty(XipLang)==true?"组织名":XipLang.xwf_lang_org_name),dataIndex:"orgName",width:200}],listeners:{rowdblclick:j}});var n=new Ext.Window({width:700,height:400,layout:"fit",items:[h],buttonAlign:"center",modal:true,closeAction:"close",title:(Ext.isEmpty(XipLang)==true?"请选择节点审批人":XipLang.wf_global_audtior_title)+":"+l,buttons:[{text:(Ext.isEmpty(XipLang)==true?"确定":XipLang.xwf_lang_btn_confirm),handler:j},{text:(Ext.isEmpty(XipLang)==true?"取消":XipLang.xwf_lang_btn_cancel),handler:function(){n.close()}}]});Ext.Msg.hide();n.show();o.select(ds.first())}}},failure:function(h,i){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请求提交失败，可能是网络或其他原因":XipLang.xwf_lang_request_error))}})}function startAndSubmitProcess(c,b,d){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"根据流程Id创建流程实例....":XipLang.xwf_lang_id_create));if(!b){b={processId:c}}else{if(typeof(b)!="object"){try{b=Ext.JSON.decode(b)}catch(a){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),a);return}}b.processId=c}Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=createInstanceByProcessId",method:"POST",timeout:300000,params:b,success:function(e,g){Ext.Msg.hide();var h=Ext.JSON.decode(e.responseText);if(h.flag!=0){d(h);return}else{var f=h.instanceCode;submitInstance(f,b,d)}},failure:function(e,f){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请求提交失败，可能是网络或其他原因":XipLang.xwf_lang_request_error))}})}function revokeByInstanceCode(b,d){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"流程撤回中....":XipLang.xwf_lang_pro_recall));var a=contextPath+"/workflowUtilAction.do?method=revokeByInsCode";var c={instanceCode:b};sendAjaxRequest(a,c,d)}function startAndSubmitByEntityCode(e,f,g){Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"正在根据流程实体编码查询可执行流程....":XipLang.xwf_lang_pro_code_query));var a=contextPath+"/workflowUtilAction.do?method=getProcessIdByEntityCodeOld";if(!f){f={}}else{if(typeof(f)!="object"){try{f=Ext.JSON.decode(f)}catch(c){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),c);return}}}var b={entityCode:e,entityAttJson:f};var d=Ext.JSON.encode(b);Ext.Ajax.request({url:a,method:"POST",sync:"",scope:this,timeout:300000,headers:{"Content-Type":"application/json"},jsonData:d,success:function(q,k){Ext.Msg.hide();var s=Ext.decode(q.responseText);if(s.flag==0){var j=s.processId;startAndSubmitProcess(j,f,g)}else{if(s.flag==1){var r={flag:1,msg:s.msg};Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"寻找可执行流程失败":XipLang.xwf_lang_pro_effective)+s.msg,function(){g(r)})}else{var p=new Array();for(var m=0;m<s.data.length;m++){var o=s.data[m];var t={processId:o.processId,processCode:o.processCode,processName:o.processName};p[m]=t}var h=Ext.create("Ext.grid.Panel",{store:{data:p,fields:[{name:"processId",type:"string"},{name:"processCode",type:"string"},{name:"processName",type:"string"}]},selModel:{showHeaderCheckbox:false,selType:"checkboxmodel",mode:"SINGLE"},columns:[new Ext.grid.RowNumberer(),{text:"ID",dataIndex:"processId",hidden:true},{text:(Ext.isEmpty(XipLang)==true?"流程编码":XipLang.xwf_lang_process_code),dataIndex:"processCode",width:130},{text:(Ext.isEmpty(XipLang)==true?"流程名称":XipLang.xwf_lang_process_name),dataIndex:"processName",width:180}],height:200,width:400,listeners:{rowdblclick:l}});var n=new Ext.Window({width:440,height:400,layout:"fit",buttonAlign:"center",items:[h],modal:true,closeAction:"close",title:(Ext.isEmpty(XipLang)==true?"找到多个流程,请选择一条":XipLang.wf_util_find_many_pro),buttons:[{text:(Ext.isEmpty(XipLang)==true?"确定":XipLang.xwf_lang_btn_confirm),handler:l},{text:(Ext.isEmpty(XipLang)==true?"取消":XipLang.xwf_lang_btn_cancel),handler:function(){n.close()}}]});Ext.Msg.hide();n.show();function l(){var u=h.getSelectionModel().getSelection();if(u.length==1){var i=u[0];Ext.MessageBox.confirm((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"已选择流程：":XipLang.xwf_lang_confirm_pro)+"【"+i.get("processName")+"】,"+(Ext.isEmpty(XipLang)==true?"确定继续吗？":XipLang.wf_util_process_continue),function(v){if(v=="yes"){n.close();var w=i.get("processId");startAndSubmitProcess(w,f,g)}})}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请先选中一条流程！":XipLang.xwf_lang_one_choose))}}}}},failure:function(h,i){xt.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请求提交失败，可能是网络或其他原因":XipLang.xwf_lang_request_error))}})}function restartInstance(b,d,e){(Ext.isEmpty(XipLang)==true?"流程重启中....":XipLang.xwf_lang_pro_restart);var a=contextPath+"/workflowUtilAction.do?method=restartInstance";var c={instanceCode:b,processId:d};sendAjaxRequest(a,c,e)}function restartInstanceSubmit(a,c,b,d){restartInstance(a,c,function(e){if(e.flag!=0){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg,function(){d(e)});return}submitInstance(a,b,d)})}function showMonitorPage(a){if(a==null||a=="undefined"||a==""){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请指定实例编码！":XipLang.xwf_lang_appoint_code));return}var c=contextPath+"/workflow/monitor/extMonitorFrame.jsp?insCode="+a;var b={title:(Ext.isEmpty(XipLang)==true?"流程监控":XipLang.xwf_lang_pro_monitor),url:c,isMax:true};Xip.showExtWindow(b)}function doCancel(a,c){var b=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=revokeProcess",params:{taskId:a},method:"post",timeout:3600000,success:function(d,e){b.hide();var d=Ext.JSON.decode(d.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),d.msg,function(){window.parent.close();try{c()}catch(f){}},this)},failure:function(f,e){b.hide();var d=Ext.JSON.decode(d.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),d.msg)}})}function doConsult(a,c,b){chooseAllUsers(a,WorkFlowConstants.TASK_BTN_CONSULT,c,b)}function doDelegate(a,c,b){chooseAllUsers(a,WorkFlowConstants.TASK_BTN_DELEGATE,c,b)}function closeConsult(a,d,c){if(d==null||d==""||d=="undefined"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请在审批意见框中填写征询反馈意见!":XipLang.xwf_lang_consultation));return false}var b=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=closeConsultTask",params:{taskId:a,comment:d},method:"post",timeout:3600000,success:function(e,f){b.hide();var e=Ext.JSON.decode(e.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg,function(){window.parent.close();try{c()}catch(g){}},this)},failure:function(g,f){b.hide();var e=Ext.JSON.decode(e.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg)}})}function revokeConsult(a,d,c){var b=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=revokeConsultTask",params:{taskId:a,comment:d},method:"post",timeout:3600000,success:function(e,f){b.hide();var e=Ext.JSON.decode(e.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg,function(){window.parent.close();try{c()}catch(g){}},this)},failure:function(g,f){b.hide();var e=Ext.JSON.decode(e.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg)}})}function doBack(c,e,d){if(e==null||e==""){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请输入回退意见!":XipLang.xwf_lang_back_comment));return}var b=getGlobalData(contextPath+"/workflowUtilAction.do?method=getBackActivityList",c);if(b.flag==0){var a=b.data;chooseBackActivity(a,c,e,d)}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),b.msg);return false}}function doReject(a,d,c){if(d==null||d==""||d=="undefined"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请填写驳回意见！":XipLang.xwf_lang_reject_comment));return false}var b=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=rejectProcess",params:{taskId:a,comment:d},method:"post",timeout:3600000,success:function(e,f){b.hide();var e=Ext.JSON.decode(e.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg,function(){window.parent.close();try{c()}catch(g){}},this)},failure:function(g,f){b.hide();var e=Ext.JSON.decode(e.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),e.msg)}})}function closeCopyTo(a,c){var b=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=closeCopyToTask",params:{taskId:a},method:"post",timeout:3600000,success:function(d,e){b.hide();var d=Ext.JSON.decode(d.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),d.msg,function(){window.parent.close();try{c()}catch(f){}},this)},failure:function(f,e){b.hide();var d=Ext.JSON.decode(d.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),d.msg)}})}function completeTask(b,d,f,e){if(f&&f!=""){f=encodeURI(f)}else{f=""}Ext.Msg.wait((Ext.isEmpty(XipLang)==true?"正在完成待办....":XipLang.xwf_lang_complete_task));var a=contextPath+"/workflowUtilAction.do?method=completeWorkItem";var c={taskId:b,lineCode:d,comment:f};sendAjaxRequest(a,c,function(q){if(q.flag==0){var p={flag:0,taskId:b};Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"待办处理成功！":XipLang.wf_util_task_finished),function(){if(e){e()}})}else{if(q.flag==1){var p={flag:1,msg:q.msg};Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"待办处理失败,失败原因:":XipLang.wf_util_task_failure)+q.msg,function(){if(e){e()}})}else{var j=new Array();for(var l=0;l<q.data.length;l++){var n=q.data[l];var r={userId:n.userId,userName:n.userName,empName:n.empName,orgName:n.orgName};j[l]=r}var k=q.multiselect;var o=Ext.create("Ext.selection.CheckboxModel",{showHeaderCheckbox:k=="Y"?true:false,mode:k=="Y"?"MULTI":"SINGLE"});var g=new Ext.grid.GridPanel({selModel:o,store:{data:j,fields:[{name:"userId",type:"string"},{name:"userName",type:"string"},{name:"empName",type:"string"},{name:"orgName",type:"string"}]},columns:[new Ext.grid.RowNumberer(),{text:"ID",dataIndex:"userId",hidden:true},{header:(Ext.isEmpty(XipLang)==true?"用户名":XipLang.xwf_lang_user_name),width:80,dataIndex:"userName"},{header:(Ext.isEmpty(XipLang)==true?"员工名":XipLang.xwf_lang_emp_name),width:100,dataIndex:"empName"},{header:(Ext.isEmpty(XipLang)==true?"组织名":XipLang.xwf_lang_org_name),width:170,dataIndex:"orgName"}],listeners:{rowdblclick:h}});var m=new Ext.Window({width:440,height:400,layout:"fit",items:[g],buttonAlign:"center",modal:true,closeAction:"close",title:(Ext.isEmpty(XipLang)==true?"请选择节点审批人":XipLang.wf_global_audtior_title),buttons:[{text:(Ext.isEmpty(XipLang)==true?"确定":XipLang.xwf_lang_btn_confirm),handler:h},{text:(Ext.isEmpty(XipLang)==true?"取消":XipLang.xwf_lang_btn_cancel),handler:function(){m.close()}}]});Ext.Msg.hide();m.show();o.select(ds.first());function h(){var t=g.getSelectionModel().getSelection();if(t.length>0){var v="";var w="";for(var u=0;u<t.length;u++){var s=t[u];v+=""+s.get("userId")+",";w+=s.get("empName")+"("+s.get("userName")+"),"}v=v.substring(0,v.length-1);w=w.substring(0,w.length-1);Ext.MessageBox.confirm((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"确认选择审批人":XipLang.wf_confirm_sel_auditor)+":【"+w+"】",function(y){if(y=="yes"){m.close();var x=c;if(!x){x={}}var i=contextPath+"/workflowUtilAction.do?method=completeWorkItem";x.approvers=v;sendAjaxRequest(i,x,function(z){if(z.flag==0){var A={flag:0,taskId:b};Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"待办处理成功！":XipLang.wf_util_task_finished),function(){if(e){e()}})}else{if(z.flag==1){var A={flag:1,msg:z.msg};Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"待办处理失败,失败原因:":XipLang.wf_util_task_failure)+z.msg,function(){if(e){e()}})}}})}})}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请先选择审批人":XipLang.xwf_lang_auditor_choose))}}}}})}function complateConsult(b,a,e,d){if(e==null||e==""||e=="undefined"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请填写征询备注信息！":XipLang.task_util_consulte_comment));return false}var c=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=doConsult",params:{taskId:b,userId:a,comment:e},method:"post",timeout:3600000,success:function(f,g){c.hide();var f=Ext.JSON.decode(f.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),f.msg,function(){window.parent.close();try{d()}catch(h){}},this)},failure:function(h,g){c.hide();var f=Ext.JSON.decode(f.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),f.msg)}})}function complateDelegate(b,a,e,d){if(e==null||e==""||e=="undefined"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请填写备注信息！":XipLang.xwf_lang_note_comment));return false}var c=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=doDelegate",params:{taskId:b,userId:a,comment:e},method:"post",timeout:3600000,success:function(f,g){c.hide();var f=Ext.JSON.decode(f.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),f.msg,function(){window.parent.close();try{d()}catch(h){}},this)},failure:function(h,g){c.hide();var f=Ext.JSON.decode(f.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),f.msg)}})}function complateBack(b,e,a,d){if(e==null||e==""||e=="undefined"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请填写回退意见!":XipLang.wf_global_back_comment));return false}var c=Ext.MessageBox.show({title:(Ext.isEmpty(XipLang)==true?"请等待":XipLang.xwf_lang_wait_tip),msg:(Ext.isEmpty(XipLang)==true?"正在提交请求.......":XipLang.xwf_lang_submit_request),width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=doBack",params:{taskId:b,backToActivityId:a,comment:e},method:"post",timeout:3600000,success:function(f,g){c.hide();var f=Ext.JSON.decode(f.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),f.msg,function(){window.parent.close();try{d()}catch(h){}},this)},failure:function(h,g){c.hide();var f=Ext.JSON.decode(f.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),f.msg)}})}function getButtonsByTaskId(a){var b=[];Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=getButtonsByTaskId",params:{taskId:a},method:"post",timeout:3600000,async:false,success:function(c,d){b=Ext.JSON.decode(c.responseText)},failure:function(e,d){var c=Ext.JSON.decode(c.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),c.msg)}});return b}function chooseAllUsers(l,a,j,n){if(j==null||j==""||j=="undefined"){if(a=="btnConsult"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请填写征询备注信息！":XipLang.task_util_consulte_comment))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请审批意见框中填写委派备注信息！":XipLang.xwf_lang_appointer))}return false}Ext.define("User",{extend:"Ext.data.Model",fields:[{name:"userId",type:"string"},{name:"userName",type:"string"},{name:"empCode",type:"string"},{name:"empName",type:"string"},{name:"orgName",type:"string"}]});Ext.define("User",{extend:"Ext.data.Model",fields:[{name:"userId",mapping:"userId"},{name:"userName",mapping:"userName"},{name:"empCode",mapping:"empCode"},{name:"empName",mapping:"empName"},{name:"orgName",mapping:"orgName"}]});var m=Ext.create("Ext.data.Store",{model:"User",pageSize:10,proxy:{type:"ajax",url:contextPath+"/workflowUtilAction.do?method=getUsersForConsultOrDelegate4Ext",reader:{type:"json",root:"dataList",totalProperty:"totalProperty"}},listeners:{beforeload:function(){var o={taskId:l,condition:d.getValue()};Ext.apply(m.proxy.extraParams,o)}}});var d=Ext.create("Ext.form.field.Text",{width:250,inputType:"text",labelSeparator:":",fieldLabel:(Ext.isEmpty(XipLang)==true?"名称":XipLang.xwf_lang_name),labelWidth:40,labelAlign:"right",listeners:{specialkey:function(p,o){if(o.getKey()==o.ENTER){m.load({params:{start:0,limit:10}})}}}});var e=Ext.create("Ext.toolbar.Toolbar",{items:[d]});var g=Ext.create("Ext.grid.Panel",{store:m,selModel:{showHeaderCheckbox:false,selType:"checkboxmodel",mode:"SINGLE"},tbar:e,columns:[new Ext.grid.RowNumberer({header:(Ext.isEmpty(XipLang)==true?"序号":XipLang.xwf_lang_number),width:35}),{header:"用户ID",hidden:true,dataIndex:"userId"},{header:(Ext.isEmpty(XipLang)==true?"用户名称":XipLang.xwf_lang_user_name),width:120,dataIndex:"userName"},{header:(Ext.isEmpty(XipLang)==true?"员工编码":XipLang.xwf_lang_emp_code),width:120,dataIndex:"empCode"},{header:(Ext.isEmpty(XipLang)==true?"员工姓名":XipLang.xwf_lang_emp_name),width:120,dataIndex:"empName"},{header:(Ext.isEmpty(XipLang)==true?"组织名称":XipLang.xwf_lang_org_name),width:290,dataIndex:"orgName"}],width:400,height:125,loadMask:{msg:(Ext.isEmpty(XipLang)==true?"数据加载中...":XipLang.xwf_lang_data_loading)},listeners:{render:function(){m.load({callback:function(){g.getSelectionModel().select(m.first())}})}},dockedItems:[{xtype:"pagingtoolbar",store:m,dock:"bottom",displayInfo:true}]});var h="请选择征询人";var f="请选择委派人";if(!Ext.isEmpty(XipLang)){h=XipLang.xwf_lang_asker;f=XipLang.xwf_lang_signer}var b=(a=="btnConsult"?h:f);var c=Ext.create("Ext.Button",{text:(Ext.isEmpty(XipLang)==true?"选择":XipLang.xwf_lang_selecting),handler:function(){var o=g.getSelectionModel().getSelection();if(o.length==0){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),b);return false}else{var p="";Ext.each(o,function(q){p=q.get("userId")});k.hide();if(a=="btnConsult"){complateConsult(l,p,j,n)}else{if(a=="btnDelegate"){complateDelegate(l,p,j,n)}else{}}}}});var i=Ext.create("Ext.Button",{text:(Ext.isEmpty(XipLang)==true?"取消":XipLang.xwf_lang_btn_cancel),handler:function(){k.hide()}});var k=Ext.create("Ext.window.Window",{title:'<div style="padding:7 "><span style="color:blue;">'+b+"</span></div>",width:750,height:400,modal:true,layout:"fit",autoScroll:true,constrain:true,shadow:false,onEsc:function(){k.hide()},items:[g],buttonAlign:"right",buttons:[c,i]});k.show()}function chooseBackActivity(c,g,e,i){if(e==null||e==""||e=="undefined"){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请填写回退意见！":XipLang.xwf_lang_back_comment));return false}var h=Ext.create("Ext.data.JsonStore",{data:c,fields:["activityId","activityCode","activityName"]});var a=Ext.create("Ext.grid.Panel",{store:h,selModel:{showHeaderCheckbox:false,selType:"checkboxmodel",mode:"SINGLE"},columns:[new Ext.grid.RowNumberer({header:(Ext.isEmpty(XipLang)==true?"序号":XipLang.xwf_lang_number),width:35}),{header:"节点ID",hidden:true,dataIndex:"activityId"},{header:(Ext.isEmpty(XipLang)==true?"节点编码":XipLang.xwf_lang_node_code),width:200,dataIndex:"activityCode"},{header:(Ext.isEmpty(XipLang)==true?"节点名称":XipLang.xwf_lang_node_name),width:300,dataIndex:"activityName"}],width:"100%",height:"100%",loadMask:{msg:(Ext.isEmpty(XipLang)==true?"数据加载中...":XipLang.xwf_lang_data_loading)},dockedItems:[{xtype:"pagingtoolbar",store:h,dock:"bottom",displayInfo:true}]});var b=Ext.create("Ext.Button",{text:(Ext.isEmpty(XipLang)==true?"选择":XipLang.xwf_lang_selecting),handler:function(){var j=a.getSelectionModel().getSelection();if(j.length==0){Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"请选择回退至的节点":XipLang.xwf_lang_back_node));return false}else{var k="";Ext.each(j,function(l){k=l.get("activityId")});f.hide();complateBack(g,e,k,i)}}});var d=Ext.create("Ext.Button",{text:(Ext.isEmpty(XipLang)==true?"取消":XipLang.xwf_lang_btn_cancel),handler:function(){f.hide()}});var f=Ext.create("Ext.window.Window",{title:'<div style="padding:7 "><span style="color:blue;">'+(Ext.isEmpty(XipLang)==true?"请选择回退至的节点":XipLang.xwf_lang_back_node)+"</span></div>",width:600,height:400,modal:true,layout:"fit",autoScroll:true,constrain:true,shadow:false,items:[a],buttonAlign:"right",buttons:[b,d]});f.show()}function getGlobalData(a,b){var c=[];Ext.Ajax.request({url:a,params:{taskId:b},method:"post",timeout:3600000,async:false,success:function(d,e){c=Ext.JSON.decode(d.responseText)},failure:function(f,e){var d=Ext.JSON.decode(d.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),d.msg)}});return c}function createButtonsByTaskId(m,f,b,o){var g=getButtonsByTaskId(m);var n=g.data;var h=new Array();var p=new Array();for(var k=0;k<n.length;k++){var l=n[k];var d=l.id;var c=l.code;var a=l.name;var j=l.disable;if(j=="N"){var e=new Ext.Button({text:a});if(c==WorkFlowConstants.TASK_BTN_CANCEL){e.setHandler(function(){Ext.MessageBox.confirm((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"您确定要撤回流程吗？":XipLang.process_recall_confirm),function(r){if(r=="yes"){var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_CANCEL,b,o);if(q==null){doCancel(m,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CANCEL,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){doCancel(m,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CANCEL,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}}else{return false}})})}else{if(c==WorkFlowConstants.TASK_BTN_CONSULT){e.setHandler(function(){var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT,b,o);var r=f.getValue();if(q==null){chooseAllUsers(m,WorkFlowConstants.TASK_BTN_CONSULT,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){chooseAllUsers(m,WorkFlowConstants.TASK_BTN_CONSULT,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}})}else{if(c==WorkFlowConstants.TASK_BTN_CONSULT_CLOSE){e.setHandler(function(){var r=f.getValue();var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_CLOSE,b,o);if(q==null){closeConsult(m,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_CLOSE,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){closeConsult(m,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_CLOSE,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}})}else{if(c==WorkFlowConstants.TASK_BTN_CONSULT_REVOKE){e.setHandler(function(){var r=f.getValue();var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_REVOKE,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_REVOKE,b,o));if(q==null){revokeConsult(m,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_REVOKE,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){revokeConsult(m,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_CONSULT_REVOKE,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}})}else{if(c==WorkFlowConstants.TASK_BTN_DELEGATE){e.setHandler(function(){var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_DELEGATE,b,o);var r=f.getValue();if(q==null){chooseAllUsers(m,WorkFlowConstants.TASK_BTN_DELEGATE,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_DELEGATE,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){chooseAllUsers(m,WorkFlowConstants.TASK_BTN_DELEGATE,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_DELEGATE,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}})}else{if(c==WorkFlowConstants.TASK_BTN_BACK){e.setHandler(function(){var s=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_BACK,b,o);if(s==null){var q=getGlobalData(contextPath+"/workflowUtilAction.do?method=getBackActivityList",m);if(q.flag==0){var i=q.data;var t=f.getValue();chooseBackActivity(i,m,t,afterHandlerEvent(WorkFlowConstants.TASK_BTN_BACK,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),q.msg);return false}}else{var r=Ext.JSON.decode(s);if(r.flag==0){var q=getGlobalData(contextPath+"/workflowUtilAction.do?method=getBackActivityList",m);if(q.flag==0){var i=q.data;var t=f.getValue();chooseBackActivity(i,m,t,afterHandlerEvent(WorkFlowConstants.TASK_BTN_BACK,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),q.msg);return false}}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+r.msg);return false}}})}else{if(c==WorkFlowConstants.TASK_BTN_REJECT){e.setHandler(function(){var r=f.getValue();var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_REJECT,b,o);if(q==null){doReject(m,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_REJECT,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){doReject(m,r,afterHandlerEvent(WorkFlowConstants.TASK_BTN_REJECT,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}})}else{if(c==WorkFlowConstants.TASK_BTN_COPYTO){e.setHandler(function(){var q=beforeHandlerEvent(WorkFlowConstants.TASK_BTN_COPYTO,b,o);if(q==null){closeCopyTo(m,afterHandlerEvent(WorkFlowConstants.TASK_BTN_COPYTO,b,o))}else{var i=Ext.JSON.decode(q);if(i.flag==0){closeCopyTo(m,afterHandlerEvent(WorkFlowConstants.TASK_BTN_COPYTO,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+i.msg);return false}}})}else{p.push(e.getId()+";"+c);e.setHandler(function(t){var u="";for(var r=0;r<p.length;r++){var i=p[r].split(";");if(i[0]==t.id){u=i[1];break}}var v=f.getValue();var s=beforeHandlerEvent(u,b,o);if(s==null){completeTask(m,u,v,afterHandlerEvent(u,b,o))}else{var q=Ext.JSON.decode(s);if(q.flag==0){completeTask(m,u,v,afterHandlerEvent(u,b,o))}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),(Ext.isEmpty(XipLang)==true?"执行失败，原因：":XipLang.xwf_lang_execute_failure)+q.msg);return false}}})}}}}}}}}h.push(e)}}return h}function getProcessIdByCode(b){var a;Ext.Ajax.request({url:contextPath+"/workflowUtilAction.do?method=getProcIdByCode",params:{processCode:b},method:"post",timeout:3600000,async:false,success:function(c,d){var c=Ext.JSON.decode(c.responseText);if(c.flag=="0"){a=c.msg}else{Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),c.msg)}},failure:function(e,d){var c=Ext.JSON.decode(c.responseText);Ext.Msg.alert((Ext.isEmpty(XipLang)==true?"提示":XipLang.xwf_lang_notice),c.msg)}});return a};