function doSubmit(contextPath,taskId,userIds,buttonCode,insCode,bizId){var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=submitProcess",params:{"taskId":taskId,"userIds":userIds},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);if(response.flag=="0"){Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)}else{if(response.flag=="1"){Ext.Msg.alert("提示",response.msg);return false}else{if(response.multiselect=="Y"){chooseApprover(contextPath,response.data,false,taskId,null,buttonCode,insCode,bizId)}else{chooseApprover(contextPath,response.data,true,taskId,null,buttonCode,insCode,bizId)}}}},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function doCancel(contextPath,taskId,buttonCode,insCode,bizId){var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=revokeProcess",params:{"taskId":taskId},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function doConsult(contextPath,taskId,userId,buttonCode,insCode,bizId,comment){if(comment==null||comment==""||comment=="undefined"){Ext.Msg.alert("提示","请填写征询备注信息!");return false}var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=doConsult",params:{"taskId":taskId,"userId":userId,"comment":comment},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function closeConsult(contextPath,taskId,comment,buttonCode,insCode,bizId){if(comment==null||comment==""||comment=="undefined"){Ext.Msg.alert("提示","请在审批意见框中填写征询反馈意见!");return false}var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=closeConsultTask",params:{"taskId":taskId,"comment":comment},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function revokeConsult(contextPath,taskId,comment,buttonCode,insCode,bizId){var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=revokeConsultTask",params:{"taskId":taskId,"comment":comment},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function doDelegate(contextPath,taskId,userId,buttonCode,insCode,bizId,comment){if(comment==null||comment==""||comment=="undefined"){Ext.Msg.alert("提示","请填写备注信息!");return false}var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=doDelegate",params:{"taskId":taskId,"userId":userId,"comment":comment},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function doBack(contextPath,taskId,comment,backToActivityId,buttonCode,insCode,bizId){if(comment==null||comment==""||comment=="undefined"){Ext.Msg.alert("提示","请填写回退意见!");return false}var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=doBack",params:{"taskId":taskId,"backToActivityId":backToActivityId,"comment":comment},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function doReject(contextPath,taskId,comment,buttonCode,insCode,bizId){if(comment==null||comment==""||comment=="undefined"){Ext.Msg.alert("提示","请填写驳回意见!");return false}var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=rejectProcess",params:{"taskId":taskId,"comment":comment},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function closeCopyTo(contextPath,taskId,buttonCode,insCode,bizId){var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=closeCopyToTask",params:{"taskId":taskId},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})}function completeTask(contextPath,taskId,comment,userIds,buttonCode,insCode,bizId){if(comment==null||comment==""||comment=="undefined"){Ext.Msg.alert("提示","请填写审批意见!");return false}var msg=Ext.MessageBox.show({title:"请等待",msg:"正在提交请求.......",width:240,wait:true,progress:true,closable:false});Ext.Ajax.request({url:contextPath+"/workItemAction.do?method=completeWorkItem",params:{"taskId":taskId,"comment":comment,"userIds":userIds,"lineCode":buttonCode},method:"post",timeout:3600000,success:function(response,options){msg.hide();var response=Ext.JSON.decode(response.responseText);if(response.flag=="0"){Ext.Msg.alert("提示",response.msg,function(){window.parent.close();afterHandlerEvent(buttonCode,insCode,bizId)},this)}else{if(response.flag=="1"){Ext.Msg.alert("提示",response.msg);return false}else{if(response.multiselect=="Y"){chooseApprover(contextPath,response.data,false,taskId,comment,buttonCode,insCode,bizId)}else{chooseApprover(contextPath,response.data,true,taskId,comment,buttonCode,insCode,bizId)}}}},failure:function(reponse,options){msg.hide();var response=Ext.JSON.decode(response.responseText);Ext.Msg.alert("提示",response.msg)}})};