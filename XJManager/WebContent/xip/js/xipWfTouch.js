var XipWf={createButtonsByTaskId:function(b,c,a,d){Ext.Ajax.request({url:"workItemAction.do?method=getButtonsByTaskId",params:{taskId:a},method:"POST",async:false,success:function(m,t){var s=m.responseText;var o=Ext.JSON.decode(s);if(o.flag=="0"){var r=o.data;c.removeAll();var l=new Array();for(var p=0;p<r.length;p++){var q=r[p];var j=q.id;var h=q.code;var f=q.name;var n=q.disable;if(n=="N"){var k=new Ext.Button({text:f});if(h==XipWfPrivate.xip_wf_consultCode){k.setHandler(function(){XipWfPrivate.doConsult(b,a,d.getValue())})}else{if(h==XipWfPrivate.xip_wf_delegateCode){k.setHandler(function(){XipWfPrivate.doDelegate(b,a,d.getValue())})}else{if(h==XipWfPrivate.xip_wf_goBackCode){k.setHandler(function(){XipWfPrivate.doBack(b,a,d.getValue())})}else{if(h==XipWfPrivate.xip_wf_consultCloseCode){k.setHandler(function(){XipWfPrivate.closeConsult(b,a,d.getValue())})}else{if(h==XipWfPrivate.xip_wf_consultRevokeCode){k.setHandler(function(){XipWfPrivate.revokeConsult(b,a,d.getValue())})}else{if(h==XipWfPrivate.xip_wf_cancelCode){k.setHandler(function(){XipWfPrivate.doCancle(a)})}else{if(h==XipWfPrivate.xip_wf_copyToCode){k.setHandler(function(){XipWfPrivate.closeCopyTo(b,a)})}else{if(h==XipWfPrivate.xip_wf_rejectCode){k.setHandler(function(){XipWfPrivate.doReject(b,a,d.getValue())})}else{l.push(k.getId()+";"+h);k.setHandler(function(v){var w="";for(var u=0;u<l.length;u++){var i=l[u].split(";");if(i[0]==v.id){w=i[1];break}}XipWfPrivate.completeTask(b,a,d.getValue(),w)})}}}}}}}}c.add(k)}}var e="";Ext.Ajax.request({url:"workflowUtilAction.do?method=getMobileFormUrlByTaskId",params:{taskId:a},method:"post",async:false,timeout:3600000,success:function(i,u){var v=Ext.util.JSON.decode(i.responseText);if(v.flag=="0"){e=v.formUrl}else{e=""}},failure:function(u,i){var v=Ext.util.JSON.decode(m.responseText);e=""}});if(e!=""){var g=new Ext.Button({text:XipLang.xwf_lang_business_info});g.setHandler(function(){var i=new Ext.Container({title:XipLang.xwf_lang_business_info,layout:"fit",xtype:"container",html:'<iframe scrolling="auto" frameborder=0 width="100%" height="1000"  src="'+e+'"></iframe>'});b.push(i)});c.add(g)}else{var g=new Ext.Button({text:XipLang.xwf_lang_business_info});g.setHandler(function(){var i=new Ext.Container({title:XipLang.xwf_lang_business_info,layout:"fit",xtype:"container",html:"<p>"+XipLang.xwf_lang_no_page+"</p>"});b.push(i)});c.add(g)}}},failure:function(e,f){Ext.Msg.alert(XipLang.xwf_lang_error,XipLang.xwf_lang_server_no_response)}})},createInstanceByProcess:function(a,b){Ext.Ajax.request({url:"workflowUtilAction.do?method=createInstanceByProcessCode",params:{processCode:a},method:"post",async:false,timeout:3600000,success:function(c,d){var e=Ext.util.JSON.decode(c.responseText);if(e.flag=="0"){b({flag:0,instanceCode:e.instanceCode})}else{b({flag:1,msg:e.msg})}},failure:function(d,c){b({flag:1,msg:XipLang.xwf_lang_request_error})}})},createInstanceByEntity:function(a,c,d,b){XipWfPrivate.choosePorcessByEntity(a,c,d,function(e){if(e.flag==0){var f=e.processId;XipWfPrivate.createInstanceByProcessId(f,b)}else{b(e)}})},submitInstance:function(b,a,d,c){Ext.Ajax.request({url:"workflowUtilAction.do?method=submitProcess",params:{instanceCode:a,entityAttJson:d},method:"POST",async:false,success:function(e,f){var g=Ext.JSON.decode(e.responseText);if(g.flag=="0"){c({flag:0,instanceCode:a})}else{if(g.flag=="1"){c({flag:1,msg:g.msg})}else{XipWfPrivate.chooseApprover(b,g.multiselect,g.actName,g.data,function(h){Ext.Ajax.request({url:"workflowUtilAction.do?method=submitProcess",params:{instanceCode:a,entityAttJson:d,userIds:h.userIds},method:"POST",async:false,success:function(i,j){var k=Ext.JSON.decode(i.responseText);if(k.flag=="0"){c({flag:0,instanceCode:a})}else{if(k.flag==1){c({flag:1,msg:k.msg})}}},failure:function(i,j){c({flag:1,msg:XipLang.xwf_lang_request_error})}})})}}},failure:function(e,f){c({flag:1,msg:XipLang.xwf_lang_request_error})}})},restartInstanceByProcess:function(a,c,b){Ext.Ajax.request({url:"workflowUtilAction.do?method=restartInstance",params:{instanceCode:a,processId:c},method:"post",async:false,timeout:3600000,success:function(d,e){var f=Ext.util.JSON.decode(d.responseText);b({flag:0,msg:f.msg})},failure:function(e,d){b({flag:1,msg:XipLang.xwf_lang_request_error})}})},restartInstanceByEntity:function(b,a,d,e,c){XipWfPrivate.choosePorcessByEntity(b,d,e,function(f){if(f.flag==0){var g=f.processId;XipWf.restartInstanceByProcess(a,g,c)}else{c(f)}})},restartAndSubmitByProcess:function(b,a,e,d,c){Ext.Ajax.request({url:"workflowUtilAction.do?method=restartInstance",params:{instanceCode:a,processId:e},method:"post",async:false,timeout:3600000,success:function(f,g){var h=Ext.util.JSON.decode(f.responseText);if(h.flag=="0"){XipWf.submitInstance(b,a,d,c)}else{c({flag:1,msg:h.msg})}},failure:function(g,f){c({flag:1,msg:XipLang.xwf_lang_request_error})}})},restartAndSubmitByEntity:function(b,a,d,e,c){XipWf.restartInstanceByEntity(b,a,d,e,function(f){if(f.flag==0){XipWf.submitInstance(b,a,e,c)}else{c(f)}})},startAndSubmitByProcess:function(a,d,c,b){XipWf.createInstanceByProcess(d,function(f){if(f.flag==0){var e=f.instanceCode;XipWf.submitInstance(a,e,c,b)}else{b(f)}})},startAndSubmitByEntity:function(a,c,d,b){XipWf.createInstanceByEntity(a,c,d,function(f){if(f.flag==0){var e=f.instanceCode;XipWf.submitInstance(a,e,d,b)}else{b(f)}})},revokeByInstance:function(a,b){Ext.Ajax.request({url:"workflowUtilAction.do?method=revokeByInsCode",params:{instanceCode:a},method:"post",async:false,timeout:3600000,success:function(c,d){var e=Ext.util.JSON.decode(c.responseText);if(e.flag=="0"){b({flag:0,msg:e.msg})}else{b({flag:1,msg:e.msg})}},failure:function(d,c){b({flag:1,msg:XipLang.xwf_lang_request_error})}})},setInstanceEntityAttrValue:function(a,c,b){Ext.Ajax.request({url:"workflowUtilAction.do?method=setInstanceEntityAttrValue",params:{instanceCode:a,entityAttrs:c},method:"post",async:false,timeout:3600000,success:function(d,e){var f=Ext.util.JSON.decode(d.responseText);if(f.flag=="0"){b({flag:0,msg:f.msg})}else{b({flag:1,msg:f.msg})}},failure:function(e,d){b({flag:1,msg:XipLang.xwf_lang_request_error})}})},showMonitorPage:function(b,a){Wb.run({url:"m?xwl=xip/touch/wf/wfMonitor&insCode="+a,success:function(c){Wb.each(c,function(f,e){if(e&&(e.isViewport||e.initialConfig&&e.initialConfig.isViewport)){var d=Ext.create("Ext.Container",{xtype:"container",layout:"fit",title:XipLang.xwf_lang_audit_history});d.add(e);b.push(d);return false}})}})}};var XipWfPrivate={xip_wf_consultCode:"btnConsult",xip_wf_delegateCode:"btnDelegate",xip_wf_goBackCode:"btnBack",xip_wf_consultCloseCode:"btnCloseConsult",xip_wf_consultRevokeCode:"btnRevokeConsult",xip_wf_submitCode:"btnSubmit",xip_wf_cancelCode:"btnCancel",xip_wf_copyToCode:"btnCopyTo",xip_wf_rejectCode:"btnReject",chooseConsultOrDelegateUser:function(g,f,h,e){Ext.define("ConsultOrDelegateUser",{extend:"Ext.data.Model",config:{fields:[{name:"USERID",type:"string"},{name:"USERNAME",type:"string"},{name:"EMPCODE",type:"string"},{name:"EMPNAME",type:"string"},{name:"ORGNAME",type:"string"}]}});var c="select wp.ORG_ID from xip_wf_processes wp,xip_wf_ins_task it where wp.process_id = it.process_id and it.task_id = '"+f+"'";c=Xip.base64Encode(c);var b="";Ext.Ajax.request({url:"platformAction.do?method=execQuery4Touch",params:{sql:c},method:"POST",async:false,success:function(j,k){var l=Ext.JSON.decode(j.responseText);if(l.success=="true"){b=l.dataList[0].ORG_ID}else{Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_audit_company);return}},failure:function(j,k){Ext.Msg.alert(XipLang.xwf_lang_error,XipLang.xwf_lang_server_no_response);return}});var i="";if(b==""){i="select pu.user_id USERID,        pu.user_name USERNAME,        pe.emp_code EMPCODE,        pe.emp_name EMPNAME,        po.org_name ORGNAME   from xip_pub_users pu, xip_pub_emps pe   left join xip_pub_emp_asg pea     on pea.emp_id = pe.emp_id    and pea.enabled = 'Y'   left join xip_pub_orgs po     on po.org_id = pea.org_id    and po.enable_flag = 'Y'  where pu.emp_id = pe.emp_id and pe.emp_name like '%${empName}%' group by pu.user_id,           pu.user_name,           pe.emp_code,           pe.emp_name,           po.org_name "}else{i="select pu.user_id USERID,        pu.user_name USERNAME,        pe.emp_code EMPCODE,        pe.emp_name EMPNAME,        po.org_name ORGNAME   from xip_pub_users pu, xip_pub_emps pe,        xip_pub_emp_asg pea,       xip_pub_orgs po  where pu.emp_id = pe.emp_id and pe.emp_name like '%${empName}%'   and pea.emp_id = pe.emp_id    and po.org_id = pea.org_id    and po.enable_flag = 'Y'    and pea.enabled = 'Y' and pea.org_id='"+b+"'  group by pu.user_id,           pu.user_name,           pe.emp_code,           pe.emp_name,           po.org_name "}i=Xip.base64Encode(i);var a=Ext.create("Ext.data.Store",{model:"ConsultOrDelegateUser",pageSize:4,clearOnPageLoad:false,proxy:{type:"ajax",url:"platformAction.do?method=execQuery4Touch",startParam:"start",limitParam:"limit",reader:{type:"json",rootProperty:"dataList",totalProperty:"total"}},autoLoad:false});var d=Ext.create("Ext.Container",{id:"chooseEmpContainer",title:XipLang.xwf_lang_person_choose,layout:"fit",xtype:"container",items:[{id:"empList",xtype:"list",store:a,itemTpl:"<div><div style='float:left;width:100px'>{EMPNAME}</div><div style='float:left;width:80px'>{USERNAME}</div><div style='float:left;width:80px'>{EMPCODE}</div></div><div style='width:260px'><font size=1>{ORGNAME}</font></div>",fullscreen:true,limit:4,plugins:[{xclass:"Ext.plugin.ListPaging",loadMoreText:XipLang.xwf_lang_more,noMoreRecordsText:XipLang.xwf_lang_no_records,autoPaging:true}],items:[{xtype:"toolbar",docked:"top",items:[{xtype:"searchfield",id:"tt_name",placeHolder:XipLang.xwf_lang_employee_choose,width:300,listeners:{action:function(j,k){if(j.getValue()==""){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_employee_choose,function(){j.focus()});return}a.getProxy().setExtraParam("sql",i);a.getProxy().setExtraParam("queryParams","{empName:'"+j.getValue()+"'}");a.currentPage=1;a.load()}}}]},{id:"tc_btns",docked:"bottom",xtype:"container",items:[{id:"tb_ok",text:XipLang.xwf_lang_btn_confirm,xtype:"button",listeners:{tap:function(k,l){var p=d.down("#empList");var j=p.getSelection();var n=j.length;if(n==0){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_must_emp_choose);return}var o=j[0];var m=o.data.USERID;if(h==XipWfPrivate.xip_wf_consultCode){Ext.Ajax.request({url:"workItemAction.do?method=doConsult",params:{taskId:f,userId:m,comment:e},method:"post",async:false,timeout:3600000,success:function(q,r){var s=Ext.JSON.decode(q.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,s.msg,function(){g.pop(2)},this)},failure:function(r,q){var s=Ext.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,response.msg)}})}if(h==XipWfPrivate.xip_wf_delegateCode){Ext.Ajax.request({url:"workItemAction.do?method=doDelegate",params:{taskId:f,userId:m,comment:e},method:"post",async:false,timeout:3600000,success:function(q,r){var s=Ext.JSON.decode(q.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,s.msg,function(){g.pop(2)},this)},failure:function(r,q){var s=Ext.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,s.msg)}})}}}}]}]}]});g.push(d)},completeTask:function(c,b,e,a){if(e==null||e==""||e=="undefined"){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_auditor_comment);return false}var d="";Ext.Ajax.request({url:"workItemAction.do?method=completeWorkItem",params:{taskId:b,comment:e,userIds:d,lineCode:a},method:"post",async:false,timeout:3600000,success:function(f,g){var h=Ext.util.JSON.decode(f.responseText);if(h.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,h.msg,function(){c.pop()},this)}else{if(h.flag=="1"){Ext.Msg.alert(XipLang.xwf_lang_notice,h.msg);return false}else{XipWfPrivate.chooseApprover(c,h.multiselect,h.actName,h.data,function(i){if(i.flag==0){var j=i.userIds;Ext.Ajax.request({url:"workItemAction.do?method=completeWorkItem",params:{taskId:b,comment:e,userIds:j,lineCode:a},method:"post",async:false,timeout:3600000,success:function(k,l){var m=Ext.util.JSON.decode(k.responseText);if(m.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,m.msg,function(){c.pop()},this)}else{if(m.flag=="1"){Ext.Msg.alert(XipLang.xwf_lang_notice,m.msg);return false}}},failure:function(m,l){var k=Ext.util.JSON.decode(k.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,k.msg)}})}else{Ext.Msg.alert(XipLang.xwf_lang_notice,i.msg);return false}})}}},failure:function(h,g){var f=Ext.util.JSON.decode(f.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}})},doCancle:function(a){Ext.Ajax.request({url:"workItemAction.do?method=revokeProcess",params:{taskId:a},method:"post",async:false,timeout:3600000,success:function(b,c){var d=Ext.util.JSON.decode(b.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,d.msg)},failure:function(c,b){var d=Ext.util.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,d.msg)}})},doConsult:function(b,a,c){XipWfPrivate.chooseConsultOrDelegateUser(b,a,XipWfPrivate.xip_wf_consultCode,c)},doDelegate:function(b,a,c){XipWfPrivate.chooseConsultOrDelegateUser(b,a,XipWfPrivate.xip_wf_delegateCode,c)},closeConsult:function(b,a,c){if(c==null||c==""||c=="undefined"){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_consultation);return}Ext.Ajax.request({url:"workItemAction.do?method=closeConsultTask",params:{taskId:a,comment:c},method:"post",async:false,timeout:3600000,success:function(d,e){var f=Ext.util.JSON.decode(d.responseText);if(f.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg,function(){b.pop()},this)}else{Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}},failure:function(e,d){var f=Ext.util.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}})},doSubmit:function(b,a){var c="";Ext.Ajax.request({url:"workItemAction.do?method=submitProcess",params:{taskId:a,userIds:c},method:"POST",async:false,success:function(d,e){var f=Ext.JSON.decode(d.responseText);if(f.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg,function(){b.pop()},this)}else{if(f.flag=="1"){Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}else{XipWfPrivate.chooseApprover(b,f.multiselect,f.actName,f.data,function(g){if(g.flag==0){var h=g.userIds;Ext.Ajax.request({url:"workItemAction.do?method=submitProcess",params:{taskId:a,userIds:h},method:"POST",async:false,success:function(i,j){var k=Ext.JSON.decode(i.responseText);if(k.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,i.msg,function(){b.pop()},this)}else{if(k.flag=="1"){Ext.Msg.alert(XipLang.xwf_lang_notice,i.msg)}}},failure:function(i,j){Ext.Msg.alert(XipLang.xwf_lang_error,XipLang.xwf_lang_server_no_response)}})}else{Ext.Msg.alert(XipLang.xwf_lang_error,g.msg)}})}}},failure:function(d,e){Ext.Msg.alert(XipLang.xwf_lang_error,XipLang.xwf_lang_server_no_response)}})},revokeConsult:function(b,a,c){if(c==null||c==""||c=="undefined"){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.revoke_consulate_comment);return}Ext.Ajax.request({url:"workItemAction.do?method=revokeConsultTask",params:{taskId:a,comment:c},method:"post",async:false,timeout:3600000,success:function(d,e){var f=Ext.util.JSON.decode(d.responseText);if(f.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg,function(){b.pop()},this)}else{Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}},failure:function(e,d){var f=Ext.util.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}})},closeCopyTo:function(b,a){Ext.Ajax.request({url:"workItemAction.do?method=closeCopyToTask",params:{taskId:a},method:"post",async:false,timeout:3600000,success:function(c,d){var e=Ext.util.JSON.decode(c.responseText);if(e.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,e.msg,function(){b.pop()},this)}else{Ext.Msg.alert(XipLang.xwf_lang_notice,e.msg)}},failure:function(d,c){var e=Ext.util.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,e.msg)}})},doBack:function(d,c,g){if(g==null||g==""||g=="undefined"){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.revoke_rollback_comment);return}var a;Ext.Ajax.request({url:"workItemAction.do?method=getBackActivityList",params:{taskId:c},method:"post",async:false,timeout:3600000,success:function(h,i){var j=Ext.util.JSON.decode(h.responseText);if(j.flag=="0"){a=j.data}else{Ext.Msg.alert(XipLang.xwf_lang_notice,j.msg);return}},failure:function(i,h){var j=Ext.util.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,j.msg);return}});Ext.define("BackAct",{extend:"Ext.data.Model",config:{fields:[{name:"activityId",type:"string"},{name:"activityCode",type:"string"},{name:"activityName",type:"string"}]}});var f=Ext.create("Ext.data.Store",{storeId:"actsStore",model:"BackAct",data:a});var e=Ext.create("Ext.List",{id:"actsList",store:f,itemTpl:"<div><div style='float:left;width:80px'>{activityCode}</div><div style='float:left;width:140px'>{activityName}</div></div>",items:[{docked:"bottom",xtype:"container",items:[{id:"tb_ok",text:XipLang.xwf_lang_btn_confirm,xtype:"button",listeners:{tap:function(i,j){var m="";var h=e.getSelection();var k=h.length;if(k==0){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_back_node)}else{var l=h[0].data.activityId;Ext.Ajax.request({url:"workItemAction.do?method=doBack",params:{taskId:c,backToActivityId:l,comment:g},method:"POST",async:false,success:function(n,o){var p=Ext.JSON.decode(n.responseText);if(p.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,p.msg,function(){d.pop(2)},this)}else{if(p.flag=="1"){Ext.Msg.alert(XipLang.xwf_lang_notice,p.msg)}}},failure:function(n,o){Ext.Msg.alert(XipLang.xwf_lang_error,XipLang.xwf_lang_server_no_response)}})}}}}]}]});var b=new Ext.Container({title:XipLang.xwf_lang_back_node,layout:"fit",xtype:"container",items:[{xtype:"container",layout:"fit",items:[e]}]});d.push(b)},doReject:function(b,a,c){if(c==null||c==""||c=="undefined"){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_reject_comment);return}Ext.Ajax.request({url:"workItemAction.do?method=rejectProcess",params:{taskId:a,comment:c},method:"post",async:false,timeout:3600000,success:function(d,e){var f=Ext.util.JSON.decode(d.responseText);if(f.flag=="0"){Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg,function(){b.pop()},this)}else{Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}},failure:function(e,d){var f=Ext.util.JSON.decode(response.responseText);Ext.Msg.alert(XipLang.xwf_lang_notice,f.msg)}})},choosePorcessByEntity:function(a,c,d,b){Ext.Ajax.request({url:"workflowUtilAction.do?method=getProcessIdByEntityCode",params:{entityCode:c,entityAttJson:d},method:"POST",async:false,success:function(e,g){var j=Ext.JSON.decode(e.responseText);if(j.flag=="0"){var i=new Object({});i.flag=0;i.processId=j.processId;b(i)}else{if(j.flag=="1"){b({flag:1,msg:j.msg})}else{Ext.define("ProcessModel",{extend:"Ext.data.Model",config:{fields:[{name:"processId",type:"string"},{name:"processCode",type:"string"},{name:"processName",type:"string"}]}});var h=Ext.create("Ext.data.Store",{storeId:"processStore",model:"ProcessModel",data:j.data});var f=Ext.create("Ext.Container",{title:XipLang.xwf_lang_pro_choose,layout:"fit",xtype:"container",items:[{xtype:"list",id:"processList",store:h,itemTpl:"<div>{processName}</div>",fullscreen:true,items:[{docked:"bottom",xtype:"container",items:[{text:XipLang.xwf_lang_btn_confirm,xtype:"button",listeners:{tap:function(l,m){var p=f.down("#processList");var k=p.getSelection();var n=k.length;if(n==0){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_one_choose);return}var o=k[0];var q=new Object({});q.flag=0;q.processId=o.data.processId;a.pop();b(q)}}}]}]}]});a.push(f)}}},failure:function(e,f){b({flag:1,msg:XipLang.xwf_lang_server_no_response})}})},createInstanceByProcessId:function(b,a){Ext.Ajax.request({url:"workflowUtilAction.do?method=createInstanceByProcessId",params:{processId:b},method:"post",async:false,timeout:3600000,success:function(c,d){var e=Ext.util.JSON.decode(c.responseText);if(e.flag=="0"){a({flag:0,instanceCode:e.instanceCode})}else{a({flag:1,msg:e.msg})}},failure:function(d,c){a({flag:1,msg:XipLang.xwf_lang_send_error})}})},chooseApprover:function(e,h,c,b,g){Ext.define("Approver",{extend:"Ext.data.Model",config:{fields:[{name:"userId",type:"string"},{name:"actName",type:"string"},{name:"userName",type:"string"},{name:"empName",type:"string"},{name:"orgName",type:"string"}]}});var a=Ext.create("Ext.data.Store",{storeId:"approverStore",model:"Approver",data:b});var d=Ext.create("Ext.List",{id:"approverList",store:"approverStore",itemTpl:"<div><div style='float:left;width:100px'>{empName}</div><div style='float:left;width:160px'>{userName}</div></div><div style='width:260px'><font size=1>{orgName}</font></div>",fullscreen:true,items:[{docked:"bottom",xtype:"container",items:[{id:"tb_ok",text:XipLang.xwf_lang_btn_confirm,xtype:"button",listeners:{tap:function(k,l){var p="";var j=d.getSelection();var n=j.length;if(n==0){Ext.Msg.alert(XipLang.xwf_lang_notice,XipLang.xwf_lang_auditor_choose)}else{for(var m=0;m<n;m++){var o=j[m];if(m==0){p=o.data.userId}else{p=p+","+o.data.userId}}e.pop();g({flag:0,userIds:p})}}}}]}]});var f=new Ext.Container({title:c,layout:"fit",xtype:"container",listeners:{activate:function(l,j,i,k){if(h=="Y"){d.setMode("MULTI")}else{d.setMode("SINGLE")}}},items:[{xtype:"container",layout:"fit",items:[d]}]});e.push(f)}};