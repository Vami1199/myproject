Ext.define("com.fb.portal.PortletViewEdit",{extend:"Ext.form.Panel",initData:function(b){var a=this.getForm();a.findField("editViewName").setValue(b.viewName);a.findField("editViewDesc").setValue(b.viewDesc);if(b.isDefault=="1"){a.findField("editIsDefault").setValue(true)}a.findField("editColumnNum").setValue(b.columnNum);a.findField("editColumnWeight").setValue(b.columnWeight);a.findField("editColumnIds").setValue(b.columnIds)},initComponent:function(){var a=this;Ext.apply(a,{bodyPadding:10,width:350,frame:false,buttonAlign:"center",border:false,baseCls:"my-panel-no-border",layout:"form",defaultType:"textfield",items:[{fieldLabel:'<font color="red">*</font>'+XipLang.portal_homepage_name,name:"editViewName",allowBlank:false,labelAlign:"right",labelWidth:90},{fieldLabel:'<font color="red">*</font>'+XipLang.portal_homepage_desc,name:"editViewDesc",allowBlank:false,labelAlign:"right",labelWidth:90},{fieldLabel:XipLang.portal_homepage_default,xtype:"checkbox",name:"editIsDefault",labelAlign:"right",labelWidth:90},{fieldLabel:XipLang.portal_homepage_column,name:"editColumnNum",readOnly:true,labelAlign:"right",labelWidth:90},{fieldLabel:'<font color="red">*</font>'+XipLang.portal_homepage_colwidth,emptyText:XipLang.portal_homepage_coldesc,name:"editColumnWeight",allowBlank:false,labelAlign:"right",labelWidth:90,listeners:{render:function(c,b){Ext.QuickTips.init();Ext.QuickTips.register({target:c.el,text:XipLang.portal_column_note})}}},{hidden:true,name:"editColumnIds"}],buttons:[{text:XipLang.config_save_btn,iconCls:"ok_icon",handler:function(){var d=this.up("form").getForm();var f="m?xwl=xip/pub/navigator/portalNavigator/data/updatePortalInfo";if(d.isValid()==false){Wb.warn(XipLang.system_must_fill_up);return false}var b=d.findField("editIsDefault").getValue();if(b){b=1;f="m?xwl=xip/pub/navigator/portalNavigator/data/updatePortalWithDefault"}else{b=0}var d=this.up("form").getForm();var e=d.findField("editColumnNum").getValue();var i=d.findField("editColumnWeight").getValue();var h=i.split(",");var l=d.findField("editColumnIds").getValue().split(",");var n=0;var k=true;Ext.Array.each(h,function(c){if(parseInt(parseFloat(c)*100)==0||parseInt(parseFloat(c)*100)<0){k=false}n=n+parseFloat(c)*100});if(e!=h.length){Wb.warn(XipLang.portal_column_not_match);return false}else{if(!k){Wb.warn(XipLang.portal_column_less_width)}else{if(parseInt(n)!=100){Wb.warn(XipLang.portal_column_total_sum);return false}else{var g=[];for(var m=0;m<e;m++){var j={COMPONENT_ID:l[m],COMPONENT_WIDTH:h[m]};g.push(j)}Wb.request({url:f,message:XipLang.portal_homepage_saving,params:{HOME_ID:myHomeId,IS_DEFAULT:b,HOME_NAME:d.findField("editViewName").getValue(),HOME_DESC:d.findField("editViewDesc").getValue(),componentArray:Wb.encode(g)},success:function(){Wb.info(XipLang.portal_modify_success);a.fireEvent("changeView",h,d.findField("editViewName").getValue(),myHomeId)}})}}}}},{text:XipLang.xwf_lang_btn_cancel,iconCls:"delete_icon",handler:function(){a.fireEvent("closeWin")}}]});this.callParent()}});